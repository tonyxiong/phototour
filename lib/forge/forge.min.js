(function() {
  var root = this;
  var e,aa=[];function l(a){this.O="";this.hc=this.hb=this.Ya=null;this.ib=!0;this.vd=this.Wc=!1;this.hf=null;this.Ta=a||"BaseObject"}l.prototype.constructor=l;function ba(a){if("string"!==typeof a.O||""===a.O)a.O=p.eg();p.register(a);null!==a.Ya&&("string"===typeof a.Ya&&(a.Ya=[a.Ya]),!0===Array.isArray(a.Ya)&&ca.register(a))}function da(a){""!==a.O&&!0===p.Va(a.O)&&p.unregister(a)}
function ea(a,b,d){d=d||"log";console[d].apply(console,["%c[ForgeJS]%c FORGE."+a.Ta+" : "+b+" %c(@"+window.performance.now().toFixed(2)+"ms)","background: #e2edff; color: #4286f4; font-weight: 700","font-weight: 400","color: #AAA"]);if("object"===typeof b&&null!==b)console[d](b)}l.prototype.log=function(a){if(!0===window.FORGE[this.Ta].DEBUG||!0===this.Wc)ea(this,a,"log"),null===this.hf&&(this.hf=[]),this.hf.push(a)};
l.prototype.warn=function(a){!0!==window.FORGE[this.Ta].WARNING&&!0!==this.vd||ea(this,a,"warn")};l.prototype.destroy=function(){!1!==this.ib&&(da(this),null!==this.hc&&(this.hc.D(),this.hc.destroy(),this.hc=null),this.hb=null,this.ib=!1)};Object.defineProperty(l.prototype,"className",{get:function(){return this.Ta}});Object.defineProperty(l.prototype,"uid",{get:function(){return this.O}});Object.defineProperty(l.prototype,"tags",{get:function(){return this.Ya}});
Object.defineProperty(l.prototype,"alive",{get:function(){return this.ib}});Object.defineProperty(l.prototype,"data",{get:function(){return this.hb},set:function(a){this.hb=a}});Object.defineProperty(l.prototype,"debug",{get:function(){return this.Wc},set:function(a){this.Wc=!!a;!0===this.Wc&&(console.log("Enabling debug for a FORGE."+this.Ta+" instance :"),console.log(this))}});
Object.defineProperty(l.prototype,"warning",{get:function(){return this.vd},set:function(a){this.vd=!!a;!0===this.vd&&(console.log("Enabling warning for a FORGE."+this.Ta+" instance :"),console.log(this))}});Object.defineProperty(l.prototype,"onDestroy",{get:function(){null===this.hc&&(this.hc=new q(this));return this.hc}});
function r(a,b,d){l.call(this,"Viewer");this.j=a;this.ya=b||{viewer:fa};this.C=this.P=this.ba=this.G=this.J=this.B=this.va=this.S=this.wa=this.na=this.W=this.xa=this.R=this.V=this.fa=this.M=this.H=this.U=this.F=this.N=this.I=this.K=this.A=this.c=this.oa=null;this.ea=this.$=!1;this.u=this.m=this.o=null;this.f=d||null;window.setTimeout(this.Bl.bind(this),0)}r.prototype=Object.create(l.prototype);r.prototype.constructor=r;var fa={background:"#000"};e=r.prototype;
e.Bl=function(a){this.O="FORGE-instance-"+String(aa.length);aa.push(this.O);ba(this);this.log("$_Viewer.boot();");this.oa=new ga(this);"string"===typeof this.j&&""!==this.j&&(this.j=document.getElementById(this.j));if("undefined"===typeof this.j||null===this.j||!1===ha.ng(this.j))throw"$_Viewer.boot : Viewer parent is invalid";this.c=new t(this,null,null,this.j);this.c.id="FORGE-main-container-"+this.O;this.A=new t(this);this.A.id="FORGE-canvas-container-"+this.O;this.c.index=0;this.A.Ab(!0);this.c.Xb(this.A);
this.K=new t(this);this.K.id="FORGE-dom-hotspot-container-"+this.O;this.c.index=0;this.K.Ab(!0);this.c.Xb(this.K);this.I=new t(this);this.I.id="FORGE-plugin-container-"+this.O;this.c.index=0;this.I.Ab(!0);this.c.Xb(this.I);this.N=new ia(this);this.N.Ab(!0);this.A.Xb(this.N);this.fa=new ja(this);this.G=new ka(this);this.F=new u(this);this.J=new la(this);this.P=new ma(this);this.W=new w(this);this.na=new na(this);this.C=new y(this);this.R=new oa(this);this.U=new z(this);this.B=new pa(this);this.H=new qa(this);
this.M=new ra(this);this.V=new sa(this);this.xa=new ta(this);this.va=new ua(this);this.S=new va(this);this.wa=new wa(this);this.ba=new xa(this);this.F.boot();this.J.boot();this.W.boot();this.U.boot();this.B.boot();this.H.boot();this.log("ForgeJS 0.9.0");"function"===typeof a&&a.call();null!==this.f&&"function"===typeof this.f.boot&&this.f.boot.call();this.J.start();this.ea=!0;null!==this.o&&this.o.D();a=this.ya;"string"===typeof a?this.wa.json(this.O+"-configuration",a,this.Cl,this):null!==a&&"object"===
typeof a&&ya(this,a)};e.Cl=function(a){this.log("$_Viewer._configLoadComplete();");a=this.S.get(A.JSON,a.key).data;ya(this,a)};
function ya(a,b){a.ya=b;if("undefined"!==typeof b.viewer){var d=b.viewer;a.c.background="string"===typeof d.background?d.background:fa.background}"undefined"!==typeof b.i18n&&a.P.ha(b.i18n);"undefined"!==typeof b.history&&a.na.ha(b.history);"undefined"!==typeof b.audio&&a.F.ha(b.audio);"undefined"!==typeof b.playlists&&a.U.ha(b.playlists);"undefined"!==typeof b.actions&&a.M.ha(b.actions);"undefined"!==typeof b.director&&a.V.load(b.director);"undefined"!==typeof b.hotspots&&a.H.fj(b.hotspots);"undefined"!==
typeof b.postProcessing&&a.xa.ha(b.postProcessing);"undefined"!==typeof b.plugins&&a.B.ha(b.plugins);a.R.ha(b.controllers);"undefined"!==typeof b.story&&a.W.load(b.story)}
e.update=function(a){!0!==this.$&&(this.G.update(a),this.oa.update(),this.va.update(),this.F.update(),this.B.update(),this.ba.update(),this.H.update(),this.R.update(),null!==this.f&&"function"===typeof this.f.update&&this.f.update.call(),null!==this.f&&"function"===typeof this.f.qn&&this.f.qn.call(),null!==this.C&&this.C.render(),null!==this.f&&"function"===typeof this.f.pn&&this.f.pn.call())};e.pause=function(){this.$=!0;null!==this.m&&this.m.D()};e.resume=function(){this.$=!1;null!==this.u&&this.u.D()};
e.destroy=function(){this.J.stop();this.j=this.ya=null;this.B.destroy();this.B=null;this.J.destroy();this.J=null;this.wa.destroy();this.wa=null;this.na.destroy();this.na=null;this.G.destroy();this.G=null;this.va.destroy();this.va=null;this.H.destroy();this.H=null;this.V.destroy();this.V=null;this.C.destroy();this.C=null;this.N.destroy();this.N=null;this.A.destroy();this.A=null;this.K.destroy();this.K=null;this.xa.destroy();this.xa=null;this.I.destroy();this.I=null;this.M.destroy();this.M=null;this.c.destroy();
this.c=null;this.oa.destroy();this.oa=null;this.U.destroy();this.U=null;this.F.destroy();this.F=null;this.W.destroy();this.W=null;this.S.destroy();this.S=null;this.ba.destroy();this.ba=null;this.P.destroy();this.P=null;this.R.destroy();this.f=this.R=null;null!==this.o&&(this.o.destroy(),this.o=null);null!==this.m&&(this.m.destroy(),this.m=null);null!==this.u&&(this.u.destroy(),this.u=null);aa.splice(this.O,1);l.prototype.destroy.call(this)};Object.defineProperty(r.prototype,"ready",{get:function(){return this.ea}});
Object.defineProperty(r.prototype,"config",{get:function(){return this.ya}});Object.defineProperty(r.prototype,"parent",{get:function(){return this.j}});Object.defineProperty(r.prototype,"display",{get:function(){return this.oa}});Object.defineProperty(r.prototype,"fullscreen",{get:function(){return this.c.jd()},set:function(a){"boolean"===typeof a&&this.c.jd()!==a&&(this.c.fullscreen=a)}});Object.defineProperty(r.prototype,"container",{get:function(){return this.c}});
Object.defineProperty(r.prototype,"canvasContainer",{get:function(){return this.A}});Object.defineProperty(r.prototype,"canvas",{get:function(){return this.N}});Object.defineProperty(r.prototype,"domHotspotContainer",{get:function(){return this.K}});Object.defineProperty(r.prototype,"pluginContainer",{get:function(){return this.I}});Object.defineProperty(r.prototype,"raf",{get:function(){return this.J}});Object.defineProperty(r.prototype,"audio",{get:function(){return this.F}});
Object.defineProperty(r.prototype,"playlists",{get:function(){return this.U}});Object.defineProperty(r.prototype,"hotspots",{get:function(){return this.H}});Object.defineProperty(r.prototype,"actions",{get:function(){return this.M}});Object.defineProperty(r.prototype,"dependencies",{get:function(){return this.fa}});Object.defineProperty(r.prototype,"director",{get:function(){return this.V}});Object.defineProperty(r.prototype,"story",{get:function(){return this.W}});
Object.defineProperty(r.prototype,"history",{get:function(){return this.na}});Object.defineProperty(r.prototype,"load",{get:function(){return this.wa}});Object.defineProperty(r.prototype,"cache",{get:function(){return this.S}});Object.defineProperty(r.prototype,"plugins",{get:function(){return this.B}});Object.defineProperty(r.prototype,"clock",{get:function(){return this.G}});Object.defineProperty(r.prototype,"tween",{get:function(){return this.ba}});Object.defineProperty(r.prototype,"i18n",{get:function(){return this.P}});
Object.defineProperty(r.prototype,"renderer",{get:function(){return this.C}});Object.defineProperty(r.prototype,"view",{get:function(){return this.C.view}});Object.defineProperty(r.prototype,"camera",{get:function(){return this.C.camera}});Object.defineProperty(r.prototype,"controllers",{get:function(){return this.R}});Object.defineProperty(r.prototype,"postProcessing",{get:function(){return this.xa}});Object.defineProperty(r.prototype,"keyboard",{get:function(){return this.va}});
Object.defineProperty(r.prototype,"width",{get:function(){return this.c.width},set:function(a){this.c.width=a}});Object.defineProperty(r.prototype,"height",{get:function(){return this.c.height},set:function(a){this.c.height=a}});Object.defineProperty(r.prototype,"onReady",{get:function(){null===this.o&&(this.o=new q(this));return this.o}});Object.defineProperty(r.prototype,"onPause",{get:function(){null===this.m&&(this.m=new q(this));return this.m}});
Object.defineProperty(r.prototype,"onResume",{get:function(){null===this.u&&(this.u=new q(this));return this.u}});
var ca=function(a){a=a();a.prototype=Object.create(l.prototype);a.prototype.constructor=a;a.prototype.register=function(a){if("object"===typeof a&&"string"===typeof a.uid&&Array.isArray(a.tags)){var b=a.uid,g=a.tags;if(!0===p.Va(b))for(var h=0,k=g.length;h<k;h++)a=g[h],"string"!==typeof a?this.warn("Tags: An object has a tag that isn't a string!"):("undefined"===typeof this.jb[a]&&(this.jb[a]=[],null!==this.bd&&this.bd.D({tag:a})),-1===this.jb[a].indexOf(b)&&this.jb[a].push(b));else this.warn("Tags: The object you want to register in tags is not known by UID!"),
this.warn(a)}else this.warn("Tags: No uid or no tags on the object you try to register!"),this.warn(a)};a.prototype.gg=function(a,d){var b=[];if("string"===typeof a)b=this.jb[a];else if(Array.isArray(a)){var h=0;for(a=a.length;h<a;h++);}"string"===typeof d&&(b=p.ce(b,d));return b};a.prototype.get=function(a,d){if("string"===typeof a)return p.get(this.jb[a],d);if(Array.isArray(a)){var b=0;for(a=a.length;b<a;b++);return p.get([],d)}};a.prototype.Jn=function(a,d){if(!0===this.Va(a)){a=this.jb[a];for(var b=
0,h=this.jb.length;b<h;b++)if(!0===p.T(a[b],d))return!0}return!1};a.prototype.Va=function(a){return"undefined"!==typeof this.jb[a]&&null!==this.jb[a]};Object.defineProperty(a.prototype,"list",{get:function(){return Object.keys(this.jb)}});Object.defineProperty(a.prototype,"onRegister",{get:function(){null===this.bd&&(this.bd=new q(this));return this.bd}});return new a}(function(){return function(){this.jb={};this.bd=null;l.call(this,"Tags")}}),p=function(a){a=a();a.prototype=Object.create(l.prototype);
a.prototype.constructor=a;a.prototype.eg=function(){var a="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)});return!1===p.Va(a)?a:p.eg()};a.prototype.Ek=function(a){function b(a){var d,h;for(h in a)if("uid"===h)if(d=a[h],"string"===typeof d){if(p.Va(d))throw"UID configuration not valid, uid "+d+" already have an object binded to!";if(-1!==g.indexOf(d))throw"UID configuration not valid, uid "+d+" is in double in config file!";
g.push(a[h])}else throw"Found a uid in configuration that is not a string!";else"object"===typeof a[h]&&b(a[h]);return!0}var g=[];return b(a)};a.prototype.register=function(a){if("object"===typeof a&&"string"===typeof a.uid){var b=a.uid;if(!1===p.Va(b))return this.Z[b]=a,!0;this.warn("The uid you want to register already exists!");this.warn(a)}else this.warn("No uid on the object you try to register!"),this.warn(a);return!1};a.prototype.unregister=function(a){"object"===typeof a&&"string"===typeof a.uid?
(a=a.uid,this.Z[a]=null,delete this.Z[a]):this.warn("No uid on the object you try to unregister!")};a.prototype.gg=function(a){return"undefined"===typeof a||null===a?Object.keys(this.Z):p.ce(Object.keys(this.Z),a)};a.prototype.ce=function(a,d){return a.filter(function(a){return p.T(a,d)?!0:!1})};a.prototype.get=function(a,d){if("undefined"===typeof a||null===a){if("string"!==typeof d)return this.Z;a=Object.keys(this.Z)}if("string"===typeof a)return this.Z[a];if(Array.isArray(a)){"string"===typeof d&&
(a=p.ce(a,d));d=[];for(var b,h=0,k=a.length;h<k;h++)b=a[h],!0===p.Va(b)&&d.push(this.Z[b]);return d}};a.prototype.T=function(a,d){a=p.get(a);return B.T(a,d)};a.prototype.Va=function(a){return"undefined"!==typeof this.Z[a]&&null!==this.Z[a]};return new a}(function(){return function(){this.Z={};l.call(this,"UID")}});
function w(a){this.i=a;this.I=this.N=this.J=this.f=null;this.K="";this.c=null;this.m="";this.o=null;this.u="";this.j=this.F=this.H=this.G=this.B=this.C=this.A=null;l.call(this,"Story")}w.prototype=Object.create(l.prototype);e=w.prototype;e.constructor=w;e.boot=function(){this.log("$_Story.boot();");this.c=[];this.o=[];this.J=new za(this.i);this.N=new za(this.i);this.I=new za(this.i)};
e.load=function(a){this.log("$_Story.load();");"string"===typeof a?this.i.load.json("forge.story.config",a,this.ol,this):"object"===typeof a&&Aa(this,a)};e.pl=function(){return!!this.c.length};e.mc=function(){return!!this.o.length};e.ql=function(){var a=this.c.indexOf(this.m);this.ld(a+1<this.c.length?this.c[a+1]:this.c[0])};e.rl=function(){var a=this.c.indexOf(this.m);this.ld(0<=a-1?this.c[a-1]:this.c[this.c.length-1])};
e.ol=function(a){this.log("$_Story.loadComplete();");a=this.i.cache.get(A.JSON,a.key).data;Aa(this,a)};
function Aa(a,b){if(!0!==p.Ek(b))throw"Story configuration is not valid!";a.f=b;a.O=a.f.uid;ba(a);a.K=a.f["default"];a.J.key=a.f.name;a.N.key=a.f.slug;a.I.key=a.f.description;if("undefined"!==typeof a.f.scenes&&0<a.f.scenes.length){b=a.f.scenes;for(var d,g=0,h=b.length;g<h;g++)d=new C(a.i),d.ha(b[g]),!0===d.booted&&Ba(a,d)}if("undefined"!==typeof a.f.groups&&0<a.f.groups.length)for(b=a.f.groups,g=0,h=b.length;g<h;g++)d=new D(a.i,b[g]),a.o.push(d.uid);Ca(a)}
function Ca(a){if("undefined"===typeof a.f.scenes||a.c.length===a.f.scenes.length){null!==a.A&&a.A.D();var b=Da().hashParameters;null!==b&&"string"===typeof b.uid?Ea(b.uid):""!==a.K&&null!==a.K&&p.Va(a.K)?Ea(a.K):a.ld(0)}}function Ea(a){!0!==p.T(a,"Scene")&&!0!==p.T(a,"Group")||p.get(a).load()}e.kk=function(a){Ba(this,a);Ca(this)};function Ba(a,b){b.onLoadStart.add(a.dn,a);b.onLoadComplete.add(a.cn,a);a.c.push(b.uid)}
e.ld=function(a){var b;"number"===typeof a?0<=a&&a<this.c.length?b=this.c[a]:this.warn("Load scene, index "+a+" is out of bounds"):"string"===typeof a&&p.T(a,"Scene")?b=a:"object"===typeof a&&B.T(a,"Scene")&&(b=a.uid);"undefined"!==typeof b&&b!==this.m&&Ea(b)};e.dn=function(a){""!==this.m&&null!==this.m&&this.scene.Ee();a=a.emitter;this.m=a.uid;!1===a.mc()?(this.u=null,null!==this.j&&this.j.D()):!0===a.mc()&&!1===a.fd(this.u)&&Fa(this,a.groups[0].uid);null!==this.C&&this.C.D({uid:a.uid})};
e.cn=function(){null!==this.G&&this.G.D()};function Fa(a,b){!0===p.T(b,"Group")&&b!==a.u&&(a.u=b,null!==a.j&&a.j.D())}e.ek=function(a){var b;"number"===typeof a?0<=a&&a<this.o.length?b=this.o[a]:this.warn("Load group, index "+a+" is out of bounds"):"string"===typeof a&&p.T(a,"Group")?b=a:"object"===typeof a&&B.T(a,"Group")&&(b=a.uid);"undefined"!==typeof b&&b!==this.u&&(Fa(this,b),Ea(b))};
e.destroy=function(){this.f=this.i=null;this.J.destroy();this.J=null;this.N.destroy();this.N=null;this.I.destroy();this.I=null;for(var a=0,b=this.c.length;a<b;a++)p.get(this.c[a]).destroy();this.c=null;a=0;for(b=this.o.length;a<b;a++)p.get(this.o[a]).destroy();this.o=null;null!==this.A&&(this.A.destroy(),this.A=null);null!==this.C&&(this.C.destroy(),this.C=null);null!==this.B&&(this.B.destroy(),this.B=null);null!==this.G&&(this.G.destroy(),this.G=null);null!==this.H&&(this.H.destroy(),this.H=null);
null!==this.F&&(this.F.destroy(),this.F=null);null!==this.j&&(this.j.destroy(),this.j=null);l.prototype.destroy.call(this)};Object.defineProperty(w.prototype,"config",{get:function(){return this.f}});Object.defineProperty(w.prototype,"name",{get:function(){return this.J.value}});Object.defineProperty(w.prototype,"slug",{get:function(){return this.N.value}});Object.defineProperty(w.prototype,"description",{get:function(){return this.I.value}});Object.defineProperty(w.prototype,"scenes",{get:function(){return p.get(this.c)}});
Object.defineProperty(w.prototype,"scene",{get:function(){return null===this.m||""===this.m?null:p.get(this.m)},set:function(a){this.ld(a)}});Object.defineProperty(w.prototype,"sceneUid",{get:function(){return this.m}});Object.defineProperty(w.prototype,"groups",{get:function(){return p.get(this.o)}});Object.defineProperty(w.prototype,"group",{get:function(){return null===this.u||""===this.u?null:p.get(this.u)},set:function(a){this.ek(a)}});Object.defineProperty(w.prototype,"groupUid",{get:function(){return this.u}});
Object.defineProperty(w.prototype,"onReady",{get:function(){null===this.A&&(this.A=new q(this));return this.A}});Object.defineProperty(w.prototype,"onSceneLoadStart",{get:function(){null===this.C&&(this.C=new q(this));return this.C}});Object.defineProperty(w.prototype,"onSceneLoadProgress",{get:function(){null===this.B&&(this.B=new q(this));return this.B}});Object.defineProperty(w.prototype,"onSceneLoadComplete",{get:function(){null===this.G&&(this.G=new q(this));return this.G}});
Object.defineProperty(w.prototype,"onSceneLoadError",{get:function(){null===this.H&&(this.H=new q(this));return this.H}});Object.defineProperty(w.prototype,"onScenePreview",{get:function(){null===this.F&&(this.F=new q(this));return this.F}});Object.defineProperty(w.prototype,"onGroupChange",{get:function(){null===this.j&&(this.j=new q(this));return this.j}});
function D(a,b){this.i=a;this.f=b;this.o=null;this.C="#ffffff";this.A=1;this.c=this.m=this.u=null;this.j="";l.call(this,"Group");this.log("$_Group._boot();");this.O=this.f.uid;this.Ya=this.f.tags;ba(this);this.c=[];this.o=new za(this.i,this.f.name);this.u=new za(this.i,this.f.slug);this.m=new za(this.i,this.f.description);"string"===typeof this.f.color&&(this.C=this.f.color);"number"===typeof this.f.alpha&&(this.A=this.f.alpha);a=this.f;"undefined"!==typeof a.children&&!0===B.Ga(a.children,"string")?
this.c=a.children:this.warn("A group has no children in its configuration, or configuration is not valid!");"string"===typeof a["default"]&&(-1!==this.c.indexOf(a["default"])?this.j=a["default"]:this.warn("A group has a default child that is not in its children array!"))}D.prototype=Object.create(l.prototype);e=D.prototype;e.constructor=D;
e.load=function(a){this.log("$_Group.load();");if(null===this.c||!this.c.length)throw"Group.load() : can't load a group that have no children";var b="";"undefined"===typeof a||null===a?b="string"===typeof this.j&&""!==this.j?this.j:this.c[0]:"number"===typeof a&&0<=a&&a<this.c.length?b=this.c[a]:"string"===typeof a?b=a:"object"===typeof a&&!0===this.Ke(a)&&(b=a.uid);if(-1===this.c.indexOf(b))throw'Group.load() : uid "'+b+'" is not in children of the group!';if(!0===p.T(b,"Scene")||!0===p.T(b,"Group"))p.get(b).load();
else throw"Impossible to load group child with uid "+b+", it seems to be neither a scene or a group!";};e.Ke=function(a){return"string"===typeof a?-1!==this.c.indexOf(a):!0===B.T(a,"Scene")||!0===B.T(a,"Group")?this.Ke(a.uid):!1};e.Ec=function(a){return"string"===typeof a&&p.T(a,"Scene")?-1!==this.c.indexOf(a):!0===B.T(a,"Scene")?this.Ec(a.uid):!1};e.fd=function(a){return"string"===typeof a&&p.T(a,"Group")?-1!==this.c.indexOf(a):!0===B.T(a,"Group")?this.fd(a.uid):!1};e.Gn=function(){return!!this.c.length};
e.jg=function(a){for(var b,d=0,g=this.c.length;d<g;d++)if(b=this.c[d],p.T(b,a))return!0;return!1};e.Le=function(){return this.jg("Scene")};e.mc=function(){return this.jg("Group")};e.dd=function(a){if("string"!==typeof a)return this.c;for(var b=[],d=0,g=this.c.length;d<g;d++)p.T(this.c[d],a)&&b.push(this.c[d]);return b};e.ee=function(a){a=this.dd(a);return p.get(a)};
e.Nk=function(){if(!1===this.Le())this.warn("Can't do Group.nextScene() on this group that have no scenes!");else{var a=this.scenesUids,b=a.indexOf(this.i.story.sceneUid),d;-1===b&&(p.T(this.j,"Scene")?d=this.j:d=a[0]);b+1<a.length?d=a[b+1]:-1!==b&&(d=a[0]);this.load(d)}};
e.Ok=function(){if(!1===this.Le())this.warn("Can't do Group.previousScene() on this group that have no scenes!");else{var a=this.scenesUids,b=a.indexOf(this.i.story.sceneUid),d;-1===b&&(p.T(this.j,"Scene")?d=this.j:d=a[0]);0<=b-1?d=a[b-1]:-1!==b&&(d=a[a.length-1]);this.load(d)}};e.destroy=function(){this.c=this.i=null;this.o.destroy();this.o=null;this.u.destroy();this.u=null;this.m.destroy();this.m=null;l.prototype.destroy.call(this)};Object.defineProperty(D.prototype,"config",{get:function(){return this.f}});
Object.defineProperty(D.prototype,"name",{get:function(){return this.o.value}});Object.defineProperty(D.prototype,"color",{get:function(){return this.C}});Object.defineProperty(D.prototype,"alpha",{get:function(){return this.A}});Object.defineProperty(D.prototype,"slug",{get:function(){return this.u.value}});Object.defineProperty(D.prototype,"description",{get:function(){return this.m.value}});Object.defineProperty(D.prototype,"childrenUids",{get:function(){return this.dd()}});
Object.defineProperty(D.prototype,"children",{get:function(){return this.ee()}});Object.defineProperty(D.prototype,"scenesUids",{get:function(){return this.dd("Scene")}});Object.defineProperty(D.prototype,"scenes",{get:function(){return this.ee("Scene")}});Object.defineProperty(D.prototype,"groupsUids",{get:function(){return this.dd("Group")}});Object.defineProperty(D.prototype,"groups",{get:function(){return this.ee("Group")}});
function C(a){this.i=a;this.c=null;this.C=0;this.A=!1;this.u=this.m=this.o=this.f=this.j=null;l.call(this,"Scene")}C.prototype=Object.create(l.prototype);e=C.prototype;e.constructor=C;e.nl=function(a){this.A=!0;"string"===typeof a.data&&(a.data=JSON.parse(a.data));this.c.wj(a.data);this.i.story.kk(this);null!==this.u&&this.u.D()};
e.ha=function(a){this.c=new F(this.i,a);this.O=this.c.uid;this.Ya=this.c.tags;ba(this);!1===this.A&&"string"===typeof a.url&&""!==a.url?this.i.load.json(this.O,a.url,this.nl,this):this.A=!0};e.load=function(){this.log("$_Scene.load();");this.i.story.scene!==this&&(null!==this.j&&this.j.D(),this.C++,null!==this.f&&this.f.D())};e.Ee=function(){null!==this.o&&this.o.D();null!==this.m&&this.m.D()};
e.fd=function(a){return"string"===typeof a&&!0===p.T(a,"Group")?p.get(a).Ec(this):!0===B.T(a,"Group")?a.Ec(this):!1};e.mc=function(){for(var a=this.i.story.groups,b,d=0,g=a.length;d<g;d++)if(b=a[d],!0===b.Ec(this))return!0;return!1};e.destroy=function(){this.i=null;null!==this.c&&(this.c.destroy(),this.c=null);null!==this.j&&(this.j.destroy(),this.j=null);null!==this.f&&(this.f.destroy(),this.f=null);null!==this.o&&(this.o.destroy(),this.o=null);null!==this.m&&(this.m.destroy(),this.m=null);l.prototype.destroy.call(this)};
Object.defineProperty(C.prototype,"booted",{get:function(){return this.A}});Object.defineProperty(C.prototype,"config",{get:function(){return this.c}});Object.defineProperty(C.prototype,"viewCount",{get:function(){return this.C}});Object.defineProperty(C.prototype,"viewed",{get:function(){return!!this.C}});Object.defineProperty(C.prototype,"name",{get:function(){return this.c.name}});Object.defineProperty(C.prototype,"slug",{get:function(){return this.c.slug}});
Object.defineProperty(C.prototype,"description",{get:function(){return this.c.description}});Object.defineProperty(C.prototype,"groupsUid",{get:function(){for(var a=this.i.story.groups,b,d=[],g=0,h=a.length;g<h;g++)b=a[g],!0===b.Ec(this)&&d.push(b.uid);return d}});Object.defineProperty(C.prototype,"groups",{get:function(){return p.get(this.groupsUid)}});Object.defineProperty(C.prototype,"thumbnails",{get:function(){return this.c.thumbnails}});
Object.defineProperty(C.prototype,"onLoadStart",{get:function(){null===this.j&&(this.j=new q(this));return this.j}});Object.defineProperty(C.prototype,"onLoadComplete",{get:function(){null===this.f&&(this.f=new q(this));return this.f}});Object.defineProperty(C.prototype,"onUnloadStart",{get:function(){null===this.o&&(this.o=new q(this));return this.o}});Object.defineProperty(C.prototype,"onUnloadComplete",{get:function(){null===this.m&&(this.m=new q(this));return this.m}});
Object.defineProperty(C.prototype,"onConfigLoadComplete",{get:function(){null===this.u&&(this.u=new q(this));return this.u}});function F(a,b){this.i=a;this.c=b;this.f=this.m=this.j=null;l.call(this,"SceneParser");this.O=this.c.uid;this.Ya=this.c.tags;this.j=new za(this.i,this.c.name);this.m=new za(this.i,this.c.slug);this.f=new za(this.i,this.c.description)}F.prototype=Object.create(l.prototype);e=F.prototype;e.constructor=F;e.wj=function(a){this.c=B.kc(this.c,a)};
e.Uj=function(){return"undefined"!==typeof this.c.sound&&"undefined"!==typeof this.c.sound.source&&("undefined"!==typeof this.c.sound.source.url&&""!==this.c.sound.source.url||"undefined"!==typeof this.c.sound.source.target&&""!==this.c.sound.source.target)?!0:!1};e.Vj=function(a){return"undefined"!==typeof this.c.sound&&"undefined"!==typeof this.c.sound.source&&"undefined"!==typeof this.c.sound.source.target&&""!==this.c.sound.source.target&&this.c.sound.source.target===a?!0:!1};
e.ak=function(){return!0===this.Uj()&&this.c.sound.type===Ga.af?!0:!1};e.destroy=function(){this.i=null;this.j.destroy();this.j=null;this.m.destroy();this.m=null;this.f.destroy();this.f=null;l.prototype.destroy.call(this)};Object.defineProperty(F.prototype,"uid",{get:function(){return this.O}});Object.defineProperty(F.prototype,"name",{get:function(){return this.j.value}});Object.defineProperty(F.prototype,"slug",{get:function(){return this.m.value}});
Object.defineProperty(F.prototype,"description",{get:function(){return this.f.value}});Object.defineProperty(F.prototype,"tags",{get:function(){return this.Ya}});Object.defineProperty(F.prototype,"thumbnails",{get:function(){return this.c.thumbnails}});Object.defineProperty(F.prototype,"media",{get:function(){return this.c.media}});Object.defineProperty(F.prototype,"sound",{get:function(){return this.c.sound}});Object.defineProperty(F.prototype,"fx",{get:function(){return this.c.fx}});
Object.defineProperty(F.prototype,"playlists",{get:function(){return this.c.playlists}});Object.defineProperty(F.prototype,"view",{get:function(){return this.c.view}});Object.defineProperty(F.prototype,"camera",{get:function(){return this.c.camera}});Object.defineProperty(F.prototype,"hotspots",{get:function(){return this.c.hotspots}});Object.defineProperty(F.prototype,"director",{get:function(){return this.c.director}});Object.defineProperty(F.prototype,"plugins",{get:function(){return this.c.plugins}});
Object.defineProperty(F.prototype,"audio",{get:function(){return this.c.audio}});var G={Na:"degrees",nb:"radians"};G.bi=Math.PI/180;G.mi=180/Math.PI;G.si=2*Math.PI;G.ca=function(a){return a*G.bi};G.$b=function(a){return a*G.mi};G.od=function(a){return Math.round(10*a)/10};G.X=function(a,b,d){b="number"===typeof b&&!1===isNaN(b)?b:-Infinity;d="number"===typeof d&&!1===isNaN(d)?d:Infinity;return Math.min(Math.max(a,b),d)};G.Wa=function(a,b,d){d-=b;return((a-b)%d+d)%d+b};
G.Un=function(a,b,d){return a*d+b*(1-d)};G.ao=function(a,b,d){a=G.X((a-b)/(d-b),0,1);return a*a*(3-2*a)};G.Cg=function(a){return{yaw:Math.atan2(-a.elements[2],a.elements[10]),pitch:Math.asin(-a.elements[6]),roll:Math.atan2(-a.elements[4],a.elements[5])}};
G.be=function(a,b,d,g){var h=Math.cos(a);a=Math.sin(a);var k=Math.cos(-b);b=Math.sin(-b);var n=Math.cos(d);d=Math.sin(d);"undefined"===typeof g&&(g=!1);return g?(new THREE.Matrix4).set(h*n+a*b*d,-h*d+a*b*n,a*k,0,k*d,k*n,-b,0,-a*n+h*b*d,a*d+h*b*n,h*k,0,0,0,0,1):(new THREE.Matrix4).set(n*h-d*b*a,-d*k,n*a+d*b*h,0,d*h+n*b*a,n*k,d*a-n*b*h,0,-a*k,b,k*h,0,0,0,0,1)};
var H={Ce:function(a){a=(new THREE.Euler).setFromQuaternion(a,"XYZ");return{yaw:a.x,pitch:-a.y,roll:a.z}},lc:function(a,b,d){"object"===typeof a&&(b=a.pitch,d=a.roll,a=a.yaw);return(new THREE.Quaternion).setFromEuler(new THREE.Euler(a,-b,d,"ZXY"))},yk:function(a){a=H.Ce(a);return G.be(a.yaw,a.pitch,a.roll)},zn:function(a){return H.lc(G.Cg(a))},cancelRoll:function(a){a=H.Ce(a);return H.lc(a.yaw,a.pitch,0)},un:function(a,b){return(new THREE.Quaternion).copy(a).inverse().multiply(b)},ij:function(a,b){a=
Math.abs(a.dot(b));return 1<=a?0:2*Math.acos(a)},multiplyScalar:function(a,b){return new THREE.Quaternion(a*b.x,a*b.y,a*b.z,a*b.w)},add:function(a,b){return new THREE.Quaternion(a.x+b.x,a.y+b.y,a.z+b.z,a.w+b.w)},log:function(a){var b=new THREE.Quaternion(0,0,0,0);if(1>Math.abs(a.w)){var d=Math.acos(a.w),g=Math.sin(d);0<g&&(b.x=d*a.x/g,b.y=d*a.y/g,b.z=d*a.z/g);return b}b.x=a.x;b.y=a.y;b.z=a.z;return b},exp:function(a){var b=Math.sqrt(a.x*a.x+a.y*a.y+a.z*a.z),d=Math.sin(b),g=(new THREE.Quaternion).copy(a);
g.w=Math.cos(b);Math.abs(d)>Number.EPSILON&&(g.x=d*a.x/b,g.y=d*a.y/b,g.z=d*a.z/b);return g},slerp:function(a,b,d){var g=new THREE.Quaternion;THREE.Quaternion.slerp(a,b,g,d);return g},co:function(a,b,d,g,h,k){a=H.slerp(a,g,k);b=H.slerp(b,d,k);return H.slerp(a,b,2*k*(1-k))},jk:function(a,b,d){return H.add(H.multiplyScalar(1-d,a),H.multiplyScalar(d,b)).normalize()},Ae:function(a,b,d){var g=a.dot(b);if(.95<=Math.abs(g))return H.jk(a,b,d);g=Math.acos(g);return H.multiplyScalar(1/Math.sin(g),H.add(H.multiplyScalar(Math.sin(g*
(1-d)),a),H.multiplyScalar(Math.sin(g*d),b)))},wk:function(a,b,d,g,h){a=H.Ae(a,g,h);b=H.Ae(b,d,h);return H.Ae(a,b,2*h*(1-h))},Jg:function(a,b,d){var g=(new THREE.Quaternion).copy(b).conjugate();a=(new THREE.Quaternion).copy(g).multiply(a);d=(new THREE.Quaternion).copy(g).multiply(d);g=H.log(a);d=H.log(d);d=H.add(g,d);d=H.multiplyScalar(-.25,d);d=H.exp(d);return(new THREE.Quaternion).copy(b).multiply(d).normalize()}};
function Ha(a,b,d,g){this.O="number"===typeof a?a:0;this.j="number"===typeof b?b:0;this.f="number"===typeof d?d:0;this.c="number"===typeof g?g:0}Ha.prototype.constructor=Ha;Object.defineProperty(Ha.prototype,"x",{get:function(){return this.O},set:function(a){"number"===typeof a&&(this.O=a)}});Object.defineProperty(Ha.prototype,"y",{get:function(){return this.j},set:function(a){"number"===typeof a&&(this.j=a)}});
Object.defineProperty(Ha.prototype,"width",{get:function(){return this.f},set:function(a){"number"===typeof a&&(this.f=a)}});Object.defineProperty(Ha.prototype,"height",{get:function(){return this.c},set:function(a){"number"===typeof a&&(this.c=a)}});Object.defineProperty(Ha.prototype,"center",{get:function(){return new THREE.Vector2(this.O+.5*this.f,this.j+.5*this.c)}});Object.defineProperty(Ha.prototype,"origin",{get:function(){return new THREE.Vector2(this.O,this.j)}});
Object.defineProperty(Ha.prototype,"size",{get:function(){return new Ia(this.f,this.c)}});function Ia(a,b){this.f=a||0;this.c=b||0}Ia.prototype.constructor=Ia;Object.defineProperty(Ia.prototype,"width",{get:function(){return this.f}});Object.defineProperty(Ia.prototype,"height",{get:function(){return this.c}});Object.defineProperty(Ia.prototype,"ratio",{get:function(){return this.f/this.c}});var Ja={IMAGE:"image",VIDEO:"video"},Ka={Pc:"equi",wd:"cube",di:"flat",Fl:"hotspot"};
function La(a,b){this.i=a;this.j=b;this.c=this.L=this.f=null;l.call(this,"Media");a=this.j;this.warn("$_Media config validator not implemented");a=a.media;this.O=a.uid;b=a.source;if(!b)throw"No source specified !";if(a.type===Ja.IMAGE){if(!b.url)throw"Multi resolution not implemented yet !";if(b.format===Ka.Pc)b={key:this.O,url:b.url},this.L=new I(this.i,b);else if(b.format===Ka.wd)b={key:this.O,url:b.url},this.L=new I(this.i,b);else if(b.format===Ka.di)throw"Flat media not supported yet !";this.L.onLoadComplete.da(this.o,
this)}else if(a.type===Ja.VIDEO){if(Array.isArray(b.levels)){b.url=[];for(var d=0,g=b.levels.length;d<g;d++)b.url.push(b.levels[d].url)}"undefined"!==typeof b.streaming&&b.streaming.toLowerCase()===Ma.bf?this.L=new J(this.i,this.O):this.L=new K(this.i,this.O,null,null,!0===this.j.Vj(this.O)&&!0===this.j.ak()?!0:!1);this.L.load(b.url);this.L.onLoadedMetaData.da(this.m,this)}this.f="undefined"!==typeof a.options?a.options:null}La.prototype=Object.create(l.prototype);La.prototype.constructor=La;
La.prototype.o=function(){null!==this.c&&this.c.D()};La.prototype.m=function(){null!==this.f&&(this.L.volume="number"===typeof this.f.volume?this.f.volume:1,this.L.loop="boolean"===typeof this.f.loop?this.f.loop:!0,!0===this.f.autoPlay&&this.L.play());null!==this.c&&this.c.D()};La.prototype.destroy=function(){null!==this.L&&(this.L.destroy(),this.L=null);null!==this.c&&(this.c.destroy(),this.c=null);this.j=this.i=null};Object.defineProperty(La.prototype,"displayObject",{get:function(){return this.L}});
Object.defineProperty(La.prototype,"onLoadComplete",{get:function(){null===this.c&&(this.c=new q(this));return this.c}});function y(a){this.i=a;this.C=this.f=this.o=this.H=null;this.V=Na.Sc;this.c=this.A=this.u=this.m=null;this.P=Oa.Sc;this.j=this.F=this.I=this.ba=this.B=null;this.S=this.M=this.N=!1;this.W=this.U=this.J=this.K=null;l.call(this,"RenderManager");this.G=new THREE.Clock;this.i.onReady.add(this.Kh,this,1E3)}y.prototype=Object.create(l.prototype);e=y.prototype;e.constructor=y;
e.Kh=function(){var a={antialias:!0,alpha:!0,premultipliedAlpha:!1,stencil:!0,canvas:this.i.canvas.dom};try{this.H=new THREE.WebGLRenderer(a)}catch(b){this.destroy();return}this.H.autoClear=!1;this.H.autoClearDepth=!0;this.H.autoClearColor=!0;this.A=new Pa(this.i);this.f=new Qa(this.i);this.F=new Ra(this.i);this.o=new Sa(this.i);this.f.onDisplayChange.add(this.Oi,this);Ta(this,this.f.rendererSize);this.B=new L(this.i);this.i.canvas.onResize.add(this.ti,this);this.i.story.onSceneLoadStart.add(this.Jh,
this)};
e.Jh=function(){this.i.story.scene.onUnloadStart.da(this.Rm,this);this.j=this.i.story.scene.config;"undefined"!==typeof this.j.background&&(this.i.container.background=this.j.background);this.F.nj();this.o.ej(this.F.renderScenes);var a=B.ab(this.i.config.view,this.j.view);switch("string"===typeof a.type?a.type.toLowerCase():Na.ob){case Na.gc:this.oc(Na.gc);break;default:this.oc(Na.ob)}a=B.ab(this.i.config.camera,this.j.camera);this.B.load(a);a=this.j;"undefined"!==typeof a.media&&"undefined"!==typeof a.media.source?
(this.P=a.media.source.format===Ka.wd||!0===this.f.presentingVR?Oa.Cd:Oa.Gd,this.m=new La(this.i,a),this.m.onLoadComplete.da(this.tm,this),B.T(this.m.displayObject,["VideoHTML5","VideoDash"])&&this.m.displayObject.onQualityChange.add(this.We,this),null!==this.U&&this.U.D()):Ua(this);a=this.j;if("undefined"!==typeof a.sound&&"undefined"!==typeof a.sound.source){var b,d,g,h;"undefined"!==typeof a.sound.options&&(b="number"===typeof a.sound.options.volume?G.X(a.sound.options.volume,0,1):1,d="boolean"===
typeof a.sound.options.loop?a.sound.options.loop:!1,g="number"===typeof a.sound.options.startTime?a.sound.options.startTime:0,h="boolean"===typeof a.sound.options.autoPlay?a.sound.options.autoPlay:!1);"undefined"!==typeof a.sound.source.url&&""!==a.sound.source.url&&(this.u=new M(this.i,a.sound.uid,a.sound.source.url,a.sound.type===Ga.af?!0:!1),"undefined"!==typeof a.sound.options&&(this.u.volume=b,this.u.loop=d,this.u.startTime=g,!0===h&&this.u.play(this.u.startTime,this.u.loop,!0)))}};
e.Rm=function(){this.S=this.N=this.M=!1;null!==this.F&&this.F.Ue();null!==this.A&&this.A.rh();null!==this.o&&this.o.Xe();null!==this.u&&(this.u.destroy(),this.u=null);null!==this.m&&(!0===B.T(this.m.displayObject,["VideoHTML5","VideoDash"])&&void 0!==this.m.displayObject.onQualityChange&&this.m.displayObject.onQualityChange.has(this.We,this)&&this.m.displayObject.onQualityChange.remove(this.We,this),null!==this.W&&this.W.D(),this.m.destroy(),this.m=null)};
e.tm=function(a){this.log("Media load is complete");Va(this,this.P);this.c.displayObject=a.emitter.displayObject;a=null;"undefined"!==typeof this.j.media.fx&&null!==this.j.media.fx&&(a=this.i.postProcessing.fe(this.j.media.fx));this.o.cj(this.c.renderTarget.texture,a);"undefined"!==typeof this.j.fx&&this.o.dj(this.i.postProcessing.fe(this.j.fx))};e.We=function(a){this.log("Media quality has changed");this.c.displayObject=a.emitter};
function Ta(a,b){a.log("Renderer size: "+b.width+"x"+b.height);var d=a.f.presentingVR,g=!0;!0===d&&(g=!1);!1===d&&a.f.setSize(b);a.H.setSize(b.width,b.height,g);a.ba=b;a.I=new Ia(b.width*(d?.5:1),b.height);null!==a.c&&a.c.setSize(a.I);a.A.setSize(a.I);a.o.setSize(a.I);a.log("Render size change in "+(d?"VR":"screen")+" mode, resolution: "+a.I.width+"x"+a.I.height)}e.ti=function(){this.log("_canvasResizeHandler");var a=this.i.canvas.dom;Ta(this,new Ia(a.width,a.height))};
e.Oi=function(){Ta(this,this.f.rendererSize);this.A.mode=!0===this.f.presentingVR?Wa.vc:Wa.Za};
function Va(a,b){var d=null,g=null;null!==a.c&&(null!==a.c.displayObject&&(d=a.c.displayObject),null!==a.c.renderTarget&&(g=a.c.renderTarget));Ua(a);b===Oa.Gd?(a.c=new Xa(a.i,g),g=a.H.getSize(),Ta(a,new Ia(g.width,g.height))):b===Oa.Cd&&(b={order:a.j.media.source.order||"RLUDFB",tile:a.j.media.source.tile},b.Sn=a.j.media.source.format,a.c=new Ya(a.i,g,b));null!==d&&(a.c.displayObject=d);a.N=!0;null!==a.K&&a.K.D()}function Ua(a){null!==a.c&&(a.c.destroy(),a.c=null);a.N=!1}
e.render=function(){if(!1!==this.N&&!1!==this.M&&null!==this.o&&(this.c.update(),this.B.update(),!0===this.N)){for(var a=this.f.presentingVR,b=this.f.Kj(),d=0,g=b.length;d<g;d++){var h=b[d],k=h.rectangle,h=h.camera;this.H.setViewport(k.origin.x,k.origin.y,k.size.width,k.size.height);null!==this.c&&this.c.render((a?h:null)||null);this.o.render(h);this.H.clearDepth();!0===a&&(k=new THREE.Scene,k.add(h),this.H.render(k,h))}!0===this.f.presentingVR&&this.f.Ih()}};e.screenToWorld=function(a){return this.C.screenToWorld(a)};
e.worldToScreen=function(a,b){return this.C.worldToScreen(a,b||0)};e.Lh=function(a){this.f.presentingVR!==a&&!0===N.Fe&&(this.f.Hh(a),a?(this.V=this.C.type,this.oc(Na.ob)):this.oc(this.V),this.j.media.source.format===Ka.Pc&&(this.P=!0===a?Oa.Cd:Oa.Gd,Va(this,this.P)))};e.ho=function(){this.Lh(!this.f.presentingVR)};
e.oc=function(a){this.log("setView");this.M=!1;null!==this.C&&(this.log("Destroy previous view"),this.C.destroy(),this.C=null);if(a===Na.ob)this.C=new Za(this.i,this.B);else if(a===Na.gc)this.C=new $a(this.i,this.B);else throw"View type not supported "+a;null!==this.c&&this.c.fc();this.M=!0;this.A.Dk(a);a===Na.ob?this.o.cg(!1):this.o.cg(!0,this.A.material,this.A.renderTarget);this.onViewReady.D()};
e.destroy=function(){this.i.canvas.onResize.remove(this.ti,this);this.i.story.onSceneLoadStart.remove(this.Jh,this);this.i.onReady.remove(this.Kh,this);null!==this.A&&(this.A.destroy(),this.A=null);null!==this.K&&(this.K.destroy(),this.K=null);null!==this.J&&(this.J.destroy(),this.J=null);null!==this.R&&(this.R.destroy(),this.R=null);null!==this.u&&(this.u.destroy(),this.u=null);null!==this.m&&(this.m.destroy(),this.m=null);null!==this.F&&(this.F.destroy(),this.F=null);null!==this.C&&(this.C.destroy(),
this.C=null);null!==this.c&&(this.c.destroy(),this.c=null);null!==this.B&&(this.B.destroy(),this.B=null);null!==this.f&&(this.f.onDisplayChange.remove(this.Oi,this),this.f.destroy(),this.f=null);null!==this.o&&(this.o.destroy(),this.o=null);this.H=this.j=this.G=null;l.prototype.destroy.call(this)};Object.defineProperty(y.prototype,"viewer",{get:function(){return this.i}});Object.defineProperty(y.prototype,"media",{get:function(){return this.m}});Object.defineProperty(y.prototype,"mediaSound",{get:function(){return this.u}});
Object.defineProperty(y.prototype,"webGLRenderer",{get:function(){return this.H}});Object.defineProperty(y.prototype,"renderPipeline",{get:function(){return this.o}});Object.defineProperty(y.prototype,"backgroundRenderer",{get:function(){return this.c}});Object.defineProperty(y.prototype,"pickingManager",{get:function(){return this.A}});
Object.defineProperty(y.prototype,"view",{get:function(){return this.C},set:function(a){if("string"===typeof a&&""!==a)switch(a){case Na.gc:this.oc(Na.gc);break;case Na.ob:this.oc(Na.ob);break;default:throw"View type not supported: "+a;}}});Object.defineProperty(y.prototype,"camera",{get:function(){return this.B}});Object.defineProperty(y.prototype,"canvasResolution",{get:function(){return this.ba}});Object.defineProperty(y.prototype,"displayResolution",{get:function(){return this.I}});
Object.defineProperty(y.prototype,"presentingVR",{get:function(){return this.f.presentingVR}});Object.defineProperty(y.prototype,"display",{get:function(){return this.f}});Object.defineProperty(y.prototype,"backgroundReady",{get:function(){return this.N}});Object.defineProperty(y.prototype,"onBackgroundReady",{get:function(){null===this.K&&(this.K=new q(this,!0));return this.K}});Object.defineProperty(y.prototype,"viewReady",{get:function(){return this.M}});
Object.defineProperty(y.prototype,"onViewReady",{get:function(){null===this.J&&(this.J=new q(this,!0));return this.J}});Object.defineProperty(y.prototype,"objects",{get:function(){return this.F}});Object.defineProperty(y.prototype,"hotspotsReady",{get:function(){return this.S}});Object.defineProperty(y.prototype,"onHotspotsReady",{get:function(){null===this.R&&(this.R=new q(this,!0));return this.R}});
Object.defineProperty(y.prototype,"onMediaReady",{get:function(){null===this.U&&(this.U=new q(this));return this.U}});Object.defineProperty(y.prototype,"onMediaRelease",{get:function(){null===this.W&&(this.W=new q(this));return this.W}});
function ab(a,b,d,g){this.i=a;this.j=b;this.m=d;this.o=g;this.f=this.c=null;l.call(this,"RenderScene");this.c=new bb(cb.Sb,this.i.renderer.webGLRenderer);a=new db(this.j,this.m);a.position=eb.Sb;this.c.addPass(a);a=this.i.postProcessing.we(this.o);b=0;for(d=a.length;b<d;b++)g=a[b],g.renderToScreen=!1,g.position=eb.Sb,this.c.addPass(g);this.f=new bb(cb.tf,this.i.renderer.webGLRenderer);a=new db(this.j,this.m);a.position=eb.Sb;this.f.addPass(a)}ab.prototype=Object.create(l.prototype);
ab.prototype.constructor=ab;ab.prototype.setSize=function(a,b){this.c.setSize(a,b);this.f.setSize(a,b)};ab.prototype.destroy=function(){this.c.readBuffer.dispose();for(this.c.writeBuffer.dispose();0<this.c.passes.length;){var a=this.c.passes.pop();a instanceof fb&&a.hasOwnProperty("tDiffuse")&&(a.uniforms.tDiffuse.value.texture.dispose(),a.uniforms.tDiffuse.value=null)}this.c=null;this.f.passes.length=0;this.o=this.m=this.j=this.i=this.f=null;l.prototype.destroy.call(this)};
Object.defineProperty(ab.prototype,"scene",{get:function(){return this.j}});Object.defineProperty(ab.prototype,"camera",{get:function(){return this.m}});Object.defineProperty(ab.prototype,"sceneComposer",{get:function(){return this.c}});Object.defineProperty(ab.prototype,"pickingComposer",{get:function(){return this.f}});function Sa(a){this.i=a;this.G=this.f=this.c=null;this.j=!0;l.call(this,"RenderPipeline");this.G=new THREE.Clock;this.f=[];this.c=new bb(cb.gi,this.i.renderer.webGLRenderer)}
Sa.prototype=Object.create(l.prototype);e=Sa.prototype;e.constructor=Sa;
function gb(a,b){a.log("COMPOSER: "+b.name);if(b.passes.length){for(var d=[],g=0,h=b.passes.length;g<h;g++){var k;k=b.passes[g];k=k instanceof fb?k.hasOwnProperty("map")?"Texture("+k.map.uuid.split("-")[0].slice(0,4)+")":"Texture":k instanceof db?"Render":k instanceof THREE.ClearMaskPass?"ClearMask":k instanceof THREE.MaskPass?"Mask":k instanceof hb?"Shader("+k.type.replace("Shader","")+")":"Pass";d.push(k)}g="";h=0;for(k=d.length;h<k;h++){for(var n=d[h],g=g+"| ",v=0;v<n.length;v++)g+="-";g+=" |";
if(h<k-1)for(n=0;5>n;n++)g+=" "}a.log(g);h="";k=0;for(n=d.length;k<n;k++)h+="| "+d[k]+" |",k<n-1&&(h+=" --- ");!1===b.passes[b.passes.length-1].renderToScreen&&(h+=" --- tex",null!==b.readBuffer&&"undefined"!==typeof b.readBuffer.name&&(h+="("+b.readBuffer.name+")"));a.log(h);a.log(g)}}function ib(a){for(var b=0,d=a.f.length;b<d;b++)gb(a,a.f[b]);gb(a,a.c)}function jb(a,b,d){a.f.push(b);!1===d&&(b=new kb(b),a.c.addPass(b));lb(a)}
function mb(a,b,d){d="undefined"!==typeof d?d:a.passes.length;if(Array.isArray(b))for(var g=b.length-1;0<=g;g--)a.insertPass(b[g],d);else b instanceof THREE.Pass&&a.insertPass(b,d)}
function lb(a){var b=a.c.passes,d=[];b.filter(function(a,b){a.position===eb.td&&d.push(b)});if(0<d.length&&0<d[0]){for(var g=[],h=d.length-1;0<=h;h--){var k=b.splice(d[h],1)[0];g.push(k)}h=0;for(k=g.length;h<k;h++)a.c.insertPass(g[h],0)}var n=[];b.filter(function(a,b){a.position===eb.ef&&n.push(b)});if(0<n.length&&n[n.length-1]<b.length-1){g=[];h=0;for(k=n.length;h<k;h++){var v=b.splice(n[h],1)[0];g.push(v)}h=0;for(k=g.length;h<k;h++)a.c.addPass(g[h])}g=0;for(h=a.f.length;g<h;g++){var k=a.f[g],v=
!1,x,E=a.f.length;for(x=0;x<E;x++)if(x!==g&&k.readBuffer===a.f[x].readBuffer){v=!0;break}v=v&&g>x;x=0;for(E=k.passes.length;x<E;x++)k.passes[x].clear=!0===v?!1:!x}g=!1;for(h=b.length-1;0<=h;h--)k=b[h],!0===g?k.renderToScreen=!1:!0===k.enabled&&(g=k.renderToScreen=!0);ib(a)}e.cg=function(a,b,d){for(var g=0,h=this.f.length;g<h;g++){var k=this.f[g];k.type===cb.tf&&(k.enabled=a,"undefined"!==typeof b&&(k.passes[0].overrideMaterial=b),"undefined"!==typeof d&&(k.renderTarget=d))}};
e.cj=function(a,b){if("undefined"!==typeof b&&null!==b&&0<b.length){b=this.i.postProcessing.we(b);for(var d=0,g=b.length;d<g;d++)b[d].position=eb.td;mb(this.c,b,0)}a=new fb(a);a.position=eb.td;this.c.insertPass(a,0);lb(this)};e.ej=function(a){for(var b=0,d=a.length;b<d;b++)jb(this,a[b].sceneComposer,!1),jb(this,a[b].pickingComposer,!0);lb(this)};e.dj=function(a){a=this.i.postProcessing.we(a);for(var b=0,d=a.length;b<d;b++)a[b].position=eb.ef;mb(this.c,a);lb(this)};
e.En=function(a){if(null!==this.c)for(var b=0,d=this.c.passes.length;b<d;b++){var g=this.c.passes[b];if(g.uid===a)return g}if(null!==this.f)for(b=0,d=this.f.length;b<d;b++)for(var g=this.f[b],h=0,k=g.passes.length;h<k;h++){var n=g.passes[h];if(n.uid===a)return n}return null};
e.setSize=function(a){for(var b=0,d=this.f.length;b<d;b++){var g=this.f[b];g.setSize(a.width,a.height);for(var h=0,k=g.passes.length;h<k;h++){var n=g.passes[h];n instanceof THREE.ShaderPass&&"undefined"!==typeof n.uniforms.resolution&&(n.uniforms.resolution.value=new THREE.Vector2(1/a.width,1/a.height))}}this.c.setSize(a.width,a.height);h=0;for(k=this.c.passes.length;h<k;h++)n=this.c.passes[h],n instanceof THREE.ShaderPass&&"undefined"!==typeof n.uniforms.resolution&&(n.uniforms.resolution.value=
new THREE.Vector2(1/a.width,1/a.height))};
e.render=function(a){if(null!==this.c){for(var b=0,d=this.c.passes.length;b<d;b++){var g=this.c.passes[b];if(g instanceof kb){var h=g.composer,k=h.readBuffer.texture;!0===h.passes[h.passes.length-1].needsSwap&&(k=h.writeBuffer.texture);g.uniforms.tAdd.value=k}}b=this.G.getDelta();d=this.f.concat(this.c);g=0;for(h=d.length;g<h;g++)for(var k=d[g],n=0,v=k.passes.length;n<v;n++){var x=k.passes[n];x instanceof db&&(x.camera=a)}a=0;for(d=this.f.length;a<d;a++)this.f[a].enabled&&this.f[a].render(b);this.c.render(b)}};
e.Xe=function(){if(null!==this.c){this.c.readBuffer.dispose();this.c.writeBuffer.dispose();for(var a=0,b=this.c.passes.length;a<b;a++){var d=this.c.passes[a];d instanceof hb&&d.uniforms.hasOwnProperty("tAdd")&&(d.uniforms.tAdd.value=null)}this.c.passes=[]}this.f=[]};
e.destroy=function(){this.Xe();this.G=null;for(var a=this.f.length-1;0<a;a--){for(var b=this.f[a],d=0,g=b.passes.length;d<g;d++){var h=b.passes[d];"function"===typeof h.destroy&&h.destroy()}b.passes.length=0}this.f=null;d=0;for(g=this.c.passes.length;d<g;d++)h=this.c.passes[d],"function"===typeof h.destroy&&h.destroy();this.c.passes.length=0;this.i=this.c=null};
Object.defineProperty(Sa.prototype,"enabled",{get:function(){return this.j},set:function(a){for(var b=this.f.concat(this.c),d=0,g=b.length;d<g;d++){var h=b[d],k=a;!1===k&&(this.j=!1);for(var n=h.passes.length-1;0<=n;n--){var v=h.passes[n];v instanceof THREE.ShaderPass&&!(v instanceof kb)&&(v.enabled=k)}h.hasOwnProperty("enabled")&&(h.enabled=k);lb(this)}this.j=a}});
function Qa(a){this.i=a;this.u=this.G=!1;this.A=this.f=this.m=this.j=this.c=null;this.H=1;this.C=this.o=null;l.call(this,"RenderDisplay");nb(this)}Qa.prototype=Object.create(l.prototype);e=Qa.prototype;e.constructor=Qa;
function nb(a){var b=a.i.renderer.webGLRenderer;a.H=b.getPixelRatio();b=b.getSize();a.A=new Ia(b.width,b.height);a.f=a.A;a.j=[0,0,.5,1];a.m=[.5,0,.5,1];"VRFrameData"in window&&(a.o=new VRFrameData);!0===N.Fe?(navigator.getVRDisplays().then(function(b){a.G=0<b.length;for(var d=0,h=b.length;d<h;d++)if("VRDisplay"in window&&b[d]instanceof VRDisplay){a.c=b[d];a.c.depthNear=.01;a.c.depthFar=2E4;break}}),ob(a)):a.warn("missing api navigator.getVRDisplays")}
function ob(a){a.i.container.onFullscreenEnter.add(a.Cc,a);a.i.container.onFullscreenExit.add(a.Cc,a);window.addEventListener("vrdisplaypresentchange",a.Cc.bind(a),!1)}
e.Cc=function(){var a=this.u,b=this.i.renderer.webGLRenderer;this.u="undefined"!==typeof this.c&&(!0===this.c.isPresenting||!1===this.G&&document[N.fullscreenElement]instanceof window.HTMLElement);if(!0===this.u){var d=this.c.getEyeParameters("left");!0===this.G&&(this.F=d.renderWidth,this.B=d.renderHeight,this.log("Window size: "+window.innerWidth+"x"+window.innerHeight),this.log("Render size: "+this.F+"x"+this.B),this.j=[0,0,.5,1],this.m=[.5,0,.5,1],this.c.getLayers&&(d=this.c.getLayers(),0<d.length&&
null!==d[0].leftBounds&&4===d[0].leftBounds.length&&(this.j=d[0].leftBounds,this.m=d[0].rightBounds)),this.log("Bounds L:["+this.j[0]+", "+this.j[1]+", "+this.j[2]+", "+this.j[3]+"], R:["+this.m[0]+", "+this.m[1]+", "+this.m[2]+", "+this.m[3]+"]"));!1===a&&(this.H=b.getPixelRatio(),d=b.getSize(),this.A.width=d.width,this.A.height=d.height,this.f=new Ia(2*this.F,this.B),b.setPixelRatio(1))}else!0===a&&(this.f=this.A,b.setPixelRatio(this.H));this.u!==a&&null!==this.C&&this.C.D()};
function pb(a,b){var d=a.i.renderer.webGLRenderer.domElement;new Promise(function(a,h){"undefined"===typeof this.c?h(Error("No VR hardware found.")):this.u===b?a():!0===this.G&&(b?a(this.c.requestPresent([{source:d}])):a(this.c.exitPresent()))}.bind(a))}e.Hh=function(a){!0===a?(this.i.raf.stop(),this.i.raf.start(this.c),pb(this,!0)):(this.i.raf.stop(),this.i.raf.start(window),pb(this,!1))};
e.Ij=function(){if(null===this.c)return null;var a=null;null!==this.o&&"undefined"!==typeof this.o.c?a=this.o.c:a=this.c.getPose();if(null===a||null===a.orientation)return new THREE.Quaternion;a=a.orientation;return new THREE.Quaternion(-a[1],-a[0],-a[2],a[3])};
e.Kj=function(){var a=this.i.renderer.camera,b=[];if("undefined"!==typeof this.c&&null!==this.c&&!0===this.u){var d=this.f.width*this.j[0],g=this.f.height*this.j[1],h=this.f.width*this.j[2],k=this.f.height*this.j[3],n=new Ha(d,g,h,k),d=this.f.width*this.m[0],g=this.f.height*this.m[1],h=this.f.width*this.m[2],k=this.f.height*this.m[3],d=new Ha(d,g,h,k);b.push(new qb(n,a.left));b.push(new qb(d,a.right))}else b.push(new qb(new Ha(0,0,this.A.width,this.A.height),a.main));return b};
e.setSize=function(a){this.A=a;this.i.renderer.webGLRenderer.setPixelRatio(1)};e.Ih=function(){!0===this.G&&"undefined"!==typeof this.c&&!0===this.u&&!0===this.c.capabilities.hasExternalDisplay&&this.c.submitFrame()};e.destroy=function(){this.i.container.onFullscreenEnter.remove(this.Cc,this);this.i.container.onFullscreenExit.remove(this.Cc,this);window.removeEventListener("vrdisplaypresentchange",this.Cc.bind(this));this.i=this.f=this.m=this.j=this.o=this.c=null};
Object.defineProperty(Qa.prototype,"presentingVR",{get:function(){return this.u}});Object.defineProperty(Qa.prototype,"vrDisplay",{get:function(){return this.c}});Object.defineProperty(Qa.prototype,"vrFrameData",{get:function(){return null!==this.c&&"function"===typeof this.c.getFrameData&&null!==this.o?(this.c.getFrameData(this.o),this.o):null}});Object.defineProperty(Qa.prototype,"rendererSize",{get:function(){return this.f}});
Object.defineProperty(Qa.prototype,"onDisplayChange",{get:function(){null===this.C&&(this.C=new q(this));return this.C}});function qb(a,b){this.f=a||null;this.c=b||null}qb.prototype.constructor=qb;Object.defineProperty(qb.prototype,"rectangle",{get:function(){return this.f}});Object.defineProperty(qb.prototype,"camera",{get:function(){return this.c}});function rb(a,b,d){this.i=a;this.H=this.j=this.f=null;this.A=b||null;l.call(this,d||"BackgroundRenderer");this.Jc()}rb.prototype=Object.create(l.prototype);
e=rb.prototype;e.constructor=rb;e.Jc=function(){this.j=new THREE.Scene;null===this.A&&(this.A=new THREE.WebGLRenderTarget(this.i.renderer.canvasResolution.width,this.i.renderer.canvasResolution.height,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat,ro:!1}))};e.fc=function(){throw Error(this.Ta+"::updateAfterViewChange not implemented");};e.setSize=function(a){null!==this.renderTarget&&this.renderTarget.setSize(a.width,a.height)};
e.render=function(a){if(null!==this.i.renderer&&null!==this.A){if(null!==this.c&&null!==this.u&&null!==this.C&&null!==this.L&&null!==this.L.element){var b=this.L.element;b instanceof HTMLVideoElement&&b.readyState===HTMLMediaElement.HAVE_ENOUGH_DATA&&this.C&&(this.C.drawImage(b,0,0,b.videoWidth,b.videoHeight,0,0,this.u.width,this.u.height),this.c.needsUpdate=!0,this.log("texture update done"))}null!==a?this.i.renderer.webGLRenderer.render(this.j,a,this.A,!0):this.i.renderer.webGLRenderer.render(this.j,
this.H,this.A,!0)}};
e.update=function(){if(this.f.material instanceof THREE.ShaderMaterial){var a=this.i.renderer.displayResolution;this.f.material.uniforms.hasOwnProperty("tViewportResolution")&&(this.f.material.uniforms.tViewportResolution.value=new THREE.Vector2(a.width,a.height));this.f.material.uniforms.hasOwnProperty("tViewportResolutionRatio")&&(this.f.material.uniforms.tViewportResolutionRatio.value=a.ratio);this.f.material.uniforms.hasOwnProperty("tModelViewMatrixInverse")&&(this.f.material.uniforms.tModelViewMatrixInverse.value=this.i.renderer.camera.modelViewInverse);
this.i.renderer.view.pc(this.f.material.uniforms)}};e.destroy=function(){this.H=null;null!==this.A&&(this.A.dispose(),this.A=null);for(;0<this.j.children.length;){var a=this.j.children.pop();null!==a.geometry&&(a.geometry.dispose(),a.geometry=null);this.j.remove(a)}this.i=this.j=null;l.prototype.destroy.call(this)};Object.defineProperty(rb.prototype,"renderTarget",{get:function(){return this.A}});
Object.defineProperty(rb.prototype,"displayObject",{get:function(){return this.L},set:function(a){null===a?this.Od():this.Ui(a)}});var Oa={Sc:"undefined",Gd:"shader",Cd:"mesh"};function Ya(a,b,d){this.C=this.u=this.c=this.L=null;this.I=d.order||"RLUDFB";this.m=new THREE.Vector2(0,0);this.K=d.tile||512;this.F=d.Sn||Ka.wd;this.o=this.G=0;this.B=1;rb.call(this,a,b,"BackgroundMeshRenderer")}Ya.prototype=Object.create(rb.prototype);e=Ya.prototype;e.constructor=Ya;
e.Jc=function(){rb.prototype.Jc.call(this);this.H=this.i.renderer.camera.main;this.i.renderer.camera.fovMin=this.i.renderer.view.fovMin;this.i.renderer.camera.fovMax=this.i.renderer.view.fovMax;this.G=2E4;this.o=32;this.fc()};
e.Ui=function(a){this.L=a;if(B.T(a,"Image"))this.c=new THREE.Texture,this.c.image=a.element;else if(B.T(a,"Canvas"))this.c=new THREE.Texture,this.c.image=a.element;else if(B.T(a,["VideoHTML5","VideoDash"]))"safari"===N.mb.toLowerCase()&&1440<a.originalHeight&&(this.B=2),this.u=document.createElement("canvas"),this.u.width=a.originalWidth/this.B,this.u.height=a.originalHeight/this.B,this.C=this.u.getContext("2d"),this.c=new THREE.Texture(this.u);else throw"Wrong type of display object "+a.type;this.c.format=
THREE.RGBAFormat;this.c.mapping=THREE.Texture.DEFAULT_MAPPING;this.c.magFilter=THREE.LinearFilter;this.c.minFilter=THREE.LinearFilter;this.c.wrapS=THREE.ClampToEdgeWrapping;this.c.wrapT=THREE.ClampToEdgeWrapping;this.c.generateMipmaps=!1;this.c.needsUpdate=!0;null!==this.c.image&&(this.m.x=this.c.image.width/this.K,this.m.y=this.c.image.height/this.K);this.f.onBeforeRender=this.Hk.bind(this);if(this.f.geometry instanceof THREE.BoxBufferGeometry)a=sb(this);else if(this.f.geometry instanceof THREE.SphereBufferGeometry){a=
new Float32Array(this.f.geometry.attributes.uv.array.byteLength/4);var b=a.keys(),d=this.o,g=1/d,h,k;for(k=0;k<=d;k++){var n=k*g;for(h=0;h<=d;h++){var v=h*g;a[b.next().value]=1-v;a[b.next().value]=1-n}}}else a=null;null!==a&&this.f.geometry.attributes.uv.set(a)};
e.Hk=function(){"undefined"!==typeof this.f.material.uniforms&&(this.f.material.uniforms.hasOwnProperty("tTexture")&&(this.f.material.uniforms.tTexture.value=this.c),this.f.material.uniforms.hasOwnProperty("tOpacity")&&(this.f.material.uniforms.tOpacity.value=1))};
function sb(a){function b(a,b,h,Ec,hc){if(-1===a)throw"Unknown face for cube mapping.";var E,Cb=a%b/b;a=1-(1+parseInt(a/b,10))/h;if(hc)for(hc=0,h=Ec;hc<=h;hc++)for(b=0,E=Ec;b<=E;b++)d[g.next().value]=v+k*b+Cb,d[g.next().value]=x+n*hc+a;else for(hc=0,h=Ec;hc<=h;h--)for(b=0,E=Ec;b<=E;E--)d[g.next().value]=v+k*E+Cb,d[g.next().value]=x+n*h+a}var d=new Float32Array((a.o+1)*(a.o+1)*12),g=d.keys(),h=a.I.split(""),k=1/1.01*(1/a.m.x/a.o),n=1/1.01*(1/a.m.y/a.o),v=1/a.m.x*.005,x=1/a.m.y*.005;b(h.indexOf("R"),
a.m.x,a.m.y,a.o);b(h.indexOf("L"),a.m.x,a.m.y,a.o);b(h.indexOf("U"),a.m.x,a.m.y,a.o,!0);b(h.indexOf("D"),a.m.x,a.m.y,a.o,!0);b(h.indexOf("B"),a.m.x,a.m.y,a.o);b(h.indexOf("F"),a.m.x,a.m.y,a.o);return d}e.Od=function(){this.i.renderer.webGLRenderer.clearColor()};
e.fc=function(){var a=B.clone(this.i.renderer.view.cc).mapping,b=tb.eb(a.vertexShader),d=tb.eb(a.fragmentShader),a=new THREE.RawShaderMaterial({fragmentShader:d,vertexShader:b,uniforms:a.uniforms,name:"BackgroundMeshMaterial",side:THREE.BackSide});null!==this.c&&(a.uniforms.tTexture.value=this.c);0===this.j.children.length?(this.F===Ka.Pc?(this.o=64,b=new THREE.SphereBufferGeometry(this.G,this.o,this.o)):b=new THREE.BoxBufferGeometry(this.G,this.G,this.G,this.o,this.o,this.o),this.f=new THREE.Mesh(b,
a),this.F===Ka.Pc&&this.f.rotation.set(0,Math.PI/2,0,"YXZ"),this.j.add(this.f)):(this.f=this.j.children[0],this.f.material.dispose());this.f.material=a;a.needsUpdate=!0};e.render=function(a){null!==this.i.renderer&&rb.prototype.render.call(this,a)};e.destroy=function(){this.Od();this.C=this.u=this.L=null;null!==this.c&&(this.c.dispose(),this.c=null);rb.prototype.destroy.call(this)};Object.defineProperty(Ya.prototype,"texture",{get:function(){return this.c}});
function Xa(a,b){this.C=this.u=this.c=this.L=null;this.m=1;rb.call(this,a,b,"BackgroundShaderRenderer")}Xa.prototype=Object.create(rb.prototype);e=Xa.prototype;e.constructor=Xa;e.Jc=function(){rb.prototype.Jc.call(this);this.fc();this.H=new THREE.OrthographicCamera(-1,1,1,-1,-1,1)};
e.Ui=function(a){this.L=a;if(B.T(a,"Image")||B.T(a,"Canvas"))this.c=new THREE.Texture,this.c.image=a.element;else if(B.T(a,["VideoHTML5","VideoDash"]))"safari"===N.mb.toLowerCase()&&1440<a.originalHeight&&(this.m=2),this.L.onQualityChange.has(this.Kc,this)&&this.L.onQualityChange.remove(this.Kc,this),this.L.onQualityChange.add(this.Kc,this),this.u=document.createElement("canvas"),this.u.width=a.originalWidth/this.m,this.u.height=a.originalHeight/this.m,this.C=this.u.getContext("2d"),this.c=new THREE.Texture(this.u);
else throw"Wrong type of display object "+a.className;this.c.format=THREE.RGBFormat;this.c.mapping=THREE.Texture.DEFAULT_MAPPING;this.c.magFilter=THREE.LinearFilter;this.c.minFilter=THREE.LinearFilter;this.c.wrapS=THREE.ClampToEdgeWrapping;this.c.wrapT=THREE.ClampToEdgeWrapping;this.c.generateMipmaps=!1;this.c.needsUpdate=!0;this.f.material.uniforms.tTexture.value=this.c};
e.Kc=function(a){this.log("Media quality has changed");a=a.emitter;this.u.width=a.originalWidth/this.m;this.u.height=a.originalHeight/this.m};e.Od=function(){this.i.renderer.webGLRenderer.clearColor()};e.render=function(){null!==this.i.renderer&&rb.prototype.render.call(this,null)};
e.fc=function(){var a=this.i.renderer.view.Gc,b=tb.eb(a.vertexShader),d=tb.eb(a.fragmentShader),a=new THREE.ShaderMaterial({uniforms:a.uniforms,vertexShader:b,fragmentShader:d,side:THREE.FrontSide});null!==this.c&&(a.uniforms.tTexture.value=this.c);0===this.j.children.length?(b=new THREE.PlaneBufferGeometry(2,2),this.f=new THREE.Mesh(b,a),this.j.add(this.f)):(this.f=this.j.children[0],this.f.material=null);this.f.material=a;a.needsUpdate=!0};
e.destroy=function(){this.Od();"undefined"!==typeof this.L.onQualityChange&&this.L.onQualityChange.has(this.Kc,this)&&this.L.onQualityChange.remove(this.Kc,this);this.C=this.u=this.L=null;null!==this.c&&(this.c.dispose(),this.c=null);rb.prototype.destroy.call(this)};Object.defineProperty(Xa.prototype,"texture",{get:function(){return this.c}});function ta(a){this.i=a;this.c=this.f=null;l.call(this,"PostProcessing");this.c={}}ta.prototype=Object.create(l.prototype);e=ta.prototype;e.constructor=ta;
e.we=function(a){if("undefined"===typeof a||null===a||!a.length)return[];for(var b=[],d=0,g=a.length;d<g;d++){var h=a[d],k;if(THREE.hasOwnProperty(h.type)){k=new hb(h.uid,h.type,THREE[h.type]);if("undefined"!==typeof k.uniforms)for(var n in h.params){var v=h.params[n],x=v;if("object"===typeof v&&v.hasOwnProperty("type")&&v.hasOwnProperty("args")){var E=v.args;switch(v.type){case "THREE.Color":if(3===E.length)x=new THREE.Color(E[0],E[1],E[2]);else if("string"===typeof E||"number"===typeof E)x=new THREE.Color(E);
else throw Error("Cannot create THREE.Color with "+typeof E+" (length "+E.length+")");break;case "THREE.Vector2":x=new THREE.Vector2(E[0],E[1]);break;case "THREE.Vector3":x=new THREE.Vector3(E[0],E[1],E[2])}}k.uniforms[n].value=x}b.push(k)}else this.warn("Unknown image effect ("+h.type+")")}return b};e.fe=function(a){return this.c[a]};
e.ha=function(a){a=this.f=a;this.O=a.uid;if("undefined"!==typeof a.fxSets&&0<a.fxSets.length)for(var b=0,d=a.fxSets.length;b<d;b++){var g=a.fxSets[b];this.c[g.uid]=g.set}};e.destroy=function(){this.c=this.i=null};var cb={gi:"main",Sb:"render",tf:"picking"};function bb(a,b,d){this.j=a||cb.Sb;this.f="";this.c=!0;THREE.EffectComposer.call(this,b,d);this.f=ub(this.j)}bb.prototype=Object.create(THREE.EffectComposer.prototype);bb.prototype.constructor=bb;
bb.prototype.destroy=function(){this.writeBuffer.dispose();this.writeBuffer=null;this.readBuffer.dispose();this.readBuffer=null};bb.uid=0;function ub(a){return"$_EffectComposer."+a+"."+bb.uid++}Object.defineProperty(bb.prototype,"type",{get:function(){return this.j}});Object.defineProperty(bb.prototype,"renderTarget",{get:function(){return this.readBuffer},set:function(a){null!==this.readBuffer&&this.readBuffer.dispose();this.readBuffer=a}});
Object.defineProperty(bb.prototype,"enabled",{get:function(){return this.c},set:function(a){this.c=a}});Object.defineProperty(bb.prototype,"name",{get:function(){return this.f}});var eb={Kd:"",td:"background",Sb:"render",ef:"global"};function fb(a,b){this.c="";THREE.TexturePass.call(this,a,b)}fb.prototype=Object.create(THREE.TexturePass.prototype);fb.prototype.constructor=fb;Object.defineProperty(fb.prototype,"position",{get:function(){return this.c},set:function(a){this.c=a}});
function hb(a,b,d,g){this.o=a;this.j=b||"shader";this.O=eb.Kd;this.f=0;THREE.ShaderPass.call(this,d,g||"tDiffuse")}hb.prototype=Object.create(THREE.ShaderPass.prototype);hb.prototype.constructor=hb;hb.prototype.render=function(a,b,d,g,h){this.f+=g;this.uniforms.hasOwnProperty("time")&&(this.uniforms.time.value=this.f);THREE.ShaderPass.prototype.render.call(this,a,b,d,g,h)};Object.defineProperty(hb.prototype,"uid",{get:function(){return this.o}});Object.defineProperty(hb.prototype,"type",{get:function(){return this.j}});
Object.defineProperty(hb.prototype,"position",{get:function(){return this.O},set:function(a){this.O=a}});function kb(a){this.m=a;this.c=null;a=tb.eb(vb.wts_vert_rectilinear);var b=tb.eb(vb.wts_frag_addition);this.c=new THREE.RawShaderMaterial({fragmentShader:b,vertexShader:a,uniforms:{tTexture:{type:"t",value:null},tAdd:{type:"t",value:null}},side:THREE.FrontSide,name:"$_AdditionPassMaterial"});hb.call(this,"","Addition",this.c,"tTexture")}kb.prototype=Object.create(hb.prototype);
kb.prototype.constructor=kb;kb.prototype.destroy=function(){null===this.c&&(this.c.dispose(),this.c=null);this.m=null};Object.defineProperty(kb.prototype,"composer",{get:function(){return this.m}});function db(a,b,d,g,h){this.c="";THREE.RenderPass.call(this,a,b,d,g,h)}db.prototype=Object.create(THREE.RenderPass.prototype);db.prototype.constructor=db;Object.defineProperty(db.prototype,"position",{get:function(){return this.c},set:function(a){this.c=a}});
var vb={coordinates:"\nvec3 toCartesian(in vec3 rtp) {\n    float r = rtp.x;\n    float theta = rtp.y;\n    float phi = rtp.z;\n    float x = r * cos(phi) * sin(theta);\n    float y = r * sin(phi);\n    float z = r * cos(phi) * cos(theta);\n    return vec3(x,y,z);\n}\nvec3 toSpherical(in vec3 pt) {\n    float r = length(pt);\n    float theta = -atan(pt.x, pt.z);\n    float phi = asin(pt.y / r);\n    return vec3(r,theta,phi);\n}\n",defines:"precision highp float;\nprecision highp int;\n#define PI  3.141592653589793\n#define PI2 6.28318530717959\n#define RECIPROCAL_PI2 0.1591549430919\n",
helpers:"\nfloat wrap(in float x, in float min, in float max) {\n    return x - ((max - min) * (1.0 - step(x, min) - step(x, max)));\n}\nvec2 getFragment() {\n    return (2.0 * gl_FragCoord.xy / tViewportResolution - 1.0) * vec2(tViewportResolutionRatio, 1.0);\n}\n",texcoords:"\nvec2 toEquirectangularTexCoords(in vec2 thetaphi) {\n    thetaphi.x = wrap(thetaphi.x + PI, -PI, PI);\n    vec2 coords = 0.5 + thetaphi / vec2(PI2, PI);\n    return coords;\n}\n",uniforms:"uniform mat4 modelMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewMatrix;\nuniform mat3 normalMatrix;\nuniform vec3 cameraPosition;\n",
vert_attributes:"attribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\n",stw_frag_proj_gopro:"\n#include <defines>\nuniform sampler2D tTexture;\nuniform vec2 tViewportResolution;\nuniform float tViewportResolutionRatio;\nuniform mat4 tModelViewMatrixInverse;\nuniform float tProjectionDistance;\nuniform float tProjectionScale;\n#include <helpers>\n#include <coordinates>\n#include <texcoords>\nvec2 projection() {\n    vec2 frag = getFragment();\n    vec2 c = tProjectionScale * frag;\n    float zs = tProjectionDistance;\n    float xy2 = dot(c,c);\n    float zs12 = (zs + 1.0) * (zs + 1.0);\n    float delta = 4.0 * (zs * zs * xy2 * xy2 - (xy2 + zs12) * (xy2 * zs * zs - zs12));\n    if (delta < 0.0) { return vec2(-1.); }\n    float z = (2.0 * zs * xy2 - sqrt(delta)) / (2.0 * (zs12 + xy2));\n    float x = c.x * ((zs - z) / (zs + 1.0));\n    float y = c.y * ((zs - z) / (zs + 1.0));\n    vec3 vx = vec3(tModelViewMatrixInverse * vec4(x, y, z, 1.0));\n    return toSpherical(vx).yz;\n}\nvoid main() {\n    vec2 texCoords = toEquirectangularTexCoords(projection());\n    gl_FragColor = vec4(texture2D(tTexture, texCoords).rgb, 1.0);\n}\n",
stw_frag_proj_rectilinear:"\n#include <defines>\nuniform sampler2D tTexture;\nuniform vec2 tViewportResolution;\nuniform float tViewportResolutionRatio;\nuniform mat4 tModelViewMatrixInverse;\nuniform float tProjectionScale;\n#include <helpers>\n#include <coordinates>\n#include <texcoords>\nvec2 projection() {\n    vec2 frag = tProjectionScale * getFragment();\n    vec4 screenPT = vec4(frag, -1.0, 1.0);\n    vec4 worldPT = tModelViewMatrixInverse * screenPT;\n    return toSpherical(worldPT.xyz).yz;\n}\nvoid main() {\n    vec2 texCoords = toEquirectangularTexCoords(projection());\n    gl_FragColor = vec4(texture2D(tTexture, texCoords).rgb, 1.0);\n}\n",
stw_vert_proj:"\n#include <defines>\nvoid main() {\n   gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n",wts_frag:"\n#include <defines>\nuniform sampler2D tTexture;\nuniform float tOpacity;\nvarying vec2 vUv;\nvoid main() {\n    vec4 texel = texture2D( tTexture, vUv );\n    gl_FragColor = vec4(texel.rgb, texel.a * tOpacity);\n}\n",wts_frag_addition:"\n#include <defines>\nuniform sampler2D tTexture;\nuniform sampler2D tAdd;\nvarying vec2 vUv;\nvoid main() {\n    vec4 texel = texture2D( tTexture, vUv );\n    vec4 texelAdd = texture2D( tAdd, vUv );\n    gl_FragColor = vec4(vec3(texelAdd.a * texelAdd.rgb + (1.0 - texelAdd.a) * texel.rgb), 1.0);\n}\n",
wts_frag_color:"\n#include <defines>\nuniform vec3 tColor;\nuniform float tOpacity;\nvarying vec2 vUv;\nvoid main() {\n    vec2 texCoords = vUv;\n    gl_FragColor = vec4(tColor, tOpacity);\n}\n",wts_frag_depth_drawing:"\n#include <defines>\nvarying float vDepth;\nvoid main() {\n    gl_FragColor = vec4(vDepth, vDepth, vDepth, 1.0);\n}\n",wts_frag_equirectangular:"\n#include <defines>\nuniform sampler2D tTexture;\nvarying vec3 vWorldPosition;\nvoid main() {\n    vec3 direction = normalize( vWorldPosition );\n    vec2 sampleUV;\n    sampleUV.y = clamp( direction.y * 0.5 + 0.5, 0.0, 1.0 );\n    sampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 - 0.25;\n    sampleUV.x += (1.0 - step(0.0, sampleUV.x));\n    gl_FragColor = texture2D( tTexture, sampleUV );\n}\n",
wts_vert_gopro:"\n#include <defines>\n#include <vert_attributes>\n#include <uniforms>\nuniform float tProjectionDistance;\nuniform float tProjectionScale;\nuniform float tViewportResolutionRatio;\nvarying vec2 vUv;\nvoid main() {\n    vec4 spherePt = normalize(modelViewMatrix * vec4( position, 1.0 ));\n    float radius = 1.0 - 0.5 * tProjectionDistance;\n    float offset = radius - 1.0;\n    spherePt.xyz *= radius;\n    spherePt.z += offset;\n        \n    gl_Position = projectionMatrix * spherePt;\n    vUv = uv;\n}\n",
wts_vert_gopro_equirectangular:"\n#include <defines>\n#include <vert_attributes>\n#include <uniforms>\nuniform float tProjectionDistance;\nuniform float tProjectionScale;\nuniform float tViewportResolutionRatio;\nvarying vec3 vWorldPosition;\nvoid main() {\n    vec4 camPt = modelViewMatrix * vec4( position, 1.0 );\n    vec4 origin = vec4(vec3(0.0), 1.0);\n    camPt.z -= tProjectionDistance * distance(camPt, origin);\n    camPt.xyz /= max(1.0, tProjectionScale);\n    gl_Position = projectionMatrix * camPt;\n    vWorldPosition = vec3(position);\n}\n",
wts_vert_littleplanet:"\n#include <defines>\n#include <vert_attributes>\n#include <uniforms>\nuniform float tProjectionScale;\nuniform float tViewportResolutionRatio;\nvarying vec2 vUv;\nvoid main() {\n    vec4 camPt = modelViewMatrix * vec4( position, 1.0 );\n    camPt.z -= distance(camPt, vec4(vec3(0.0), 1.0));\n    camPt.xyz /= tProjectionScale;\n    gl_Position = projectionMatrix * camPt;\n    vUv = uv;\n}\n",wts_vert_littleplanet_equirectangular:"\n#include <defines>\n#include <vert_attributes>\n#include <uniforms>\nuniform float tProjectionScale;\nuniform float tViewportResolutionRatio;\nvarying vec3 vWorldPosition;\nvoid main() {\n    vec4 camPt = modelViewMatrix * vec4( position, 1.0 );\n    camPt.z -= distance(camPt, vec4(vec3(0.0), 1.0));\n    camPt.xyz /= tProjectionScale;\n    gl_Position = projectionMatrix * camPt;\n    vWorldPosition = vec3(position);\n}\n",
wts_vert_rectilinear:"\n#include <defines>\n#include <vert_attributes>\n#include <uniforms>\nuniform float tViewportResolutionRatio;\nvarying vec2 vUv;\nvoid main() {\n    vec4 camPt = modelViewMatrix * vec4( position, 1.0 );\n    gl_Position = projectionMatrix * camPt;\n    vUv = uv;\n}\n",wts_vert_rectilinear_equirectangular:"\n#include <defines>\n#include <vert_attributes>\n#include <uniforms>\nuniform float tViewportResolutionRatio;\nvarying vec3 vWorldPosition;\nvoid main() {\n    vec4 camPt = modelViewMatrix * vec4( position, 1.0 );\n    gl_Position = projectionMatrix * camPt;\n    vWorldPosition = vec3( position );\n}\n"},
tb={screenToWorld:{rectilinear:{uniforms:{tOpacity:{type:"f",value:1},tTexture:{type:"t",value:null},tViewportResolution:{type:"v2",value:new THREE.Vector2},tViewportResolutionRatio:{type:"f",value:1},tModelViewMatrixInverse:{type:"m4",value:new THREE.Matrix4},tProjectionScale:{type:"f",value:1}},vertexShader:vb.stw_vert_proj,fragmentShader:vb.stw_frag_proj_rectilinear},gopro:{uniforms:{tOpacity:{type:"f",value:1},tTexture:{type:"t",value:null},tViewportResolution:{type:"v2",value:new THREE.Vector2},
tViewportResolutionRatio:{type:"f",value:1},tModelViewMatrixInverse:{type:"m4",value:new THREE.Matrix4},tProjectionDistance:{type:"f",value:0},tProjectionScale:{type:"f",value:1}},vertexShader:vb.stw_vert_proj,fragmentShader:vb.stw_frag_proj_gopro}},worldToScreen:{rectilinear:{mapping:{uniforms:{tOpacity:{type:"f",value:1},tTexture:{type:"t",value:null},tProjectionScale:{type:"f",value:1},tModelViewMatrixInverse:{type:"m4",value:null}},vertexShader:vb.wts_vert_rectilinear,fragmentShader:vb.wts_frag},
equirectangular:{uniforms:{tOpacity:{type:"f",value:1},tTexture:{type:"t",value:null},tProjectionScale:{type:"f",value:1},tViewportResolutionRatio:{type:"f",value:1},tModelViewMatrixInverse:{type:"m4",value:null}},vertexShader:vb.wts_vert_rectilinear_equirectangular,fragmentShader:vb.wts_frag_equirectangular}},littlePlanet:{equirectangular:{uniforms:{tOpacity:{type:"f",value:1},tTexture:{type:"t",value:null},tProjectionScale:{type:"f",value:1},tViewportResolutionRatio:{type:"f",value:1},tModelViewMatrixInverse:{type:"m4",
value:null}},vertexShader:vb.wts_vert_littleplanet_equirectangular,fragmentShader:vb.wts_frag_equirectangular}},gopro:{mapping:{uniforms:{tOpacity:{type:"f",value:1},tTexture:{type:"t",value:null},tProjectionScale:{type:"f",value:1},tProjectionDistance:{type:"f",value:1},tModelViewMatrixInverse:{type:"m4",value:null}},vertexShader:vb.wts_vert_gopro,fragmentShader:vb.wts_frag},equirectangular:{uniforms:{tOpacity:{type:"f",value:1},tTexture:{type:"t",value:null},tProjectionScale:{type:"f",value:1},
tProjectionDistance:{type:"f",value:1},tViewportResolutionRatio:{type:"f",value:1},tModelViewMatrixInverse:{type:"m4",value:null}},vertexShader:vb.wts_vert_gopro_equirectangular,fragmentShader:vb.wts_frag_equirectangular}}},eb:function(a){return a.replace(/#include +<([\w\d.]+)>/g,function(a,d){a=vb[d];if("undefined"===typeof a&&(a=THREE.ShaderChunk[d],"undefined"===typeof a))throw Error("Can not resolve #include <"+d+">");return tb.eb(a)})}},Na={Sc:"undefined",ob:"rectilinear",gc:"gopro"};
function wb(a,b,d,g){this.i=a;this.c=b;this.f=1;this.j=g;l.call(this,d||"ViewBase")}wb.prototype=Object.create(l.prototype);e=wb.prototype;e.constructor=wb;e.Gc=tb.screenToWorld.rectilinear;e.cc=tb.worldToScreen.rectilinear;e.uc=function(){};e.pc=function(a){this.log(a);throw"Please implement "+this.Ta+"::updateUniforms";};e.worldToScreen=function(a,b){this.log(a);this.log(b);throw"Please implement "+this.Ta+"::worldToScreen";};
e.screenToWorld=function(a){this.log(a);throw"Please implement "+this.Ta+"::screenToWorld";};e.je=function(){return G.ca(this.i.renderer.camera.fov)};e.destroy=function(){this.c=this.i=null;l.prototype.destroy.call(this)};Object.defineProperty(wb.prototype,"type",{get:function(){return this.j}});Object.defineProperty(wb.prototype,"fovMin",{get:function(){return this.c.fovMin}});Object.defineProperty(wb.prototype,"fovMax",{get:function(){return this.c.fovMax}});
function $a(a,b){this.m=0;wb.call(this,a,b,"ViewGoPro",Na.gc);this.uc()}$a.prototype=Object.create(wb.prototype);e=$a.prototype;e.constructor=$a;e.Gc=tb.screenToWorld.gopro;e.cc=tb.worldToScreen.gopro;e.uc=function(){wb.prototype.uc.call(this);this.c.fovMin=30;this.c.fovMax=330};
e.pc=function(a){var b,d=G.X(this.c.fov,this.c.fovMin,this.c.fovMax);this.m=b=90>d?0:180<d?1:.5*(1+Math.sin(Math.PI/2*((d-90)/90*2-1)));a.tProjectionDistance.value=b;d=.5*G.ca(d);this.f=(b+1)*Math.sin(d)/(b+Math.cos(d));a.tProjectionScale.value=this.f};e.je=function(){var a=.5*G.ca(this.c.fov),b=1-this.m/2;return 2*Math.atan2(b*Math.sin(a),Math.abs(b-1)+b*Math.cos(a))};function Za(a,b){wb.call(this,a,b,"ViewRectilinear",Na.ob);this.uc()}Za.prototype=Object.create(wb.prototype);e=Za.prototype;
e.constructor=Za;e.Gc=tb.screenToWorld.rectilinear;e.cc=tb.worldToScreen.rectilinear;e.uc=function(){wb.prototype.uc.call(this);this.c.fovMin=10;this.c.fovMax=170};e.pc=function(a){this.f=Math.tan(G.ca(G.X(this.c.fov,this.c.fovMin,this.c.fovMax)/2));a.tProjectionScale.value=this.f};
e.worldToScreen=function(a,b){b=b||0;a=new THREE.Vector4(a.x,a.y,a.z,1);var d=G.Cg(this.c.modelView),d=G.be(d.yaw,d.pitch,d.roll,!0),d=d.transpose();a.applyMatrix4(d);if(0>a.z)return new THREE.Vector2(Infinity,Infinity);d=Math.max(Number.EPSILON,a.z);a=(new THREE.Vector2(a.x,a.y)).divideScalar(d);a.x/=(1+b)*this.f;a.y/=this.f;b=this.i.renderer.displayResolution;a.x=b.width/2*(a.x/b.ratio+1);a.y=b.height/2*(a.y/b.ratio+1);return new THREE.Vector2(Math.round(a.x),b.height-Math.round(a.y))};
e.screenToWorld=function(a){var b=this.i.renderer.displayResolution;a=new THREE.Vector2(2*(a.x/b.width-1)*b.ratio,2*(a.y/b.height-1)*b.ratio);a.multiplyScalar(this.f);a=(new THREE.Vector4(a.x,a.y,-1,0)).applyMatrix4(this.c.modelViewInverse).normalize();return new THREE.Vector3(a.x,a.y,a.z)};function xb(a){this.c=a||[];l.call(this,"Timeline");B.Ga(this.c,"Keyframe")?this.c=B.pd(this.c,"time"):this.c=[]}xb.prototype=Object.create(l.prototype);e=xb.prototype;e.constructor=xb;
e.Hn=function(){return null!==this.c&&0<this.c.length};e.lb=function(a){B.T(a,"Keyframe")&&(this.c.push(a),this.c=B.pd(this.c,"time"))};e.Cn=function(a){a=this.ge(a);return{previous:this.c[a.previous],next:this.c[a.next]||null}};e.ge=function(a){for(var b=-1,d=-1,g=this.c.length-1;0<=g;g--)if(a>=this.c[g].time){b=g;break}b!==this.c.length-1&&(d=b+1);return{previous:b,next:d}};e.Lj=function(a){a=this.Mj(a);return{previous:this.c[a.previous]||null,next:this.c[a.next]||null}};
e.Mj=function(a){a=this.ge(a);var b=0,d=a.next;0<a.previous&&(b=a.previous-1);a.next<this.c.length-2&&(d=a.next+1);return{previous:b,next:d}};e.wn=function(){for(;0<this.c.length;)this.c.pop().data=null;this.c=[]};e.destroy=function(){for(;0<this.c.length;)this.c.pop().data=null;this.c=null;l.prototype.destroy.call(this)};Object.defineProperty(xb.prototype,"keyframes",{get:function(){return this.c},set:function(a){B.Ga(a,"Keyframe")&&(this.c=B.pd(a,"time"))}});
function yb(a,b){l.call(this,"Keyframe");this.c=a;this.hb=b}yb.prototype=Object.create(l.prototype);yb.prototype.constructor=yb;Object.defineProperty(yb.prototype,"time",{get:function(){return this.c},set:function(a){"number"===typeof a&&(this.c=a)}});Object.defineProperty(yb.prototype,"data",{get:function(){return this.hb},set:function(a){this.hb=a}});
function zb(a,b){this.i=a;this.ja=b||null;this.u=this.B=this.m=this.Ia=null;this.I=this.F=0;this.R=!1;this.f=null;this.N=0;this.U=!1;this.A=this.G=this.H=this.C=this.ba=this.S=null;l.call(this,"Animation");this.He()}zb.prototype=Object.create(l.prototype);e=zb.prototype;e.constructor=zb;e.He=function(){this.f=new Ab(this.i,this);this.f.onStart.add(this.Ym,this);this.f.onStop.add(this.Zm,this);this.f.onProgress.add(this.Gk,this);this.f.onComplete.add(this.Xm,this);this.i.tween.add(this.f);this.m=new xb};
function Bb(a,b){a=a.split(".");for(var d=0,g=a.length;d<g-1;d++)b=b[a[d]];return[b,a[d]]}
function Db(a,b){b=b||a.F;var d=a.m.ge(b||a.F);a.u=a.m.keyframes[d.next];a.B=a.m.keyframes[d.previous];if(null===a.u||-1===d.next)return!1;if(a.U){var g=a.m.Lj(b);if(null!==g.previous&&null!==g.next){b=(new THREE.Quaternion).copy(a.B.data.quaternion).normalize();var d=(new THREE.Quaternion).copy(a.u.data.quaternion).normalize(),h=(new THREE.Quaternion).copy(g.previous.data.quaternion).normalize(),g=(new THREE.Quaternion).copy(g.next.data.quaternion).normalize();a.S=H.Jg(h,b,d);a.ba=H.Jg(b,d,g)}}a.I=
a.u.time-a.B.time;a.f.$e({tweenTime:1},a.I);a.N=0;a.f.start();return!0}e.Ym=function(){!0!==this.R&&(null!==this.C&&this.C.D(),this.R=!0)};e.Zm=function(){this.R=!1;null!==this.H&&this.H.D()};
e.Gk=function(){var a=this.N;if(null!==this.u){this.F=a*this.I+this.B.time;var b=[],d,g,h;Array.isArray(this.Ia.prop)||(this.Ia.prop=[this.Ia.prop]);h=this.Ia.prop.length;for(g=0;g<h;g++)b.push(Bb(this.Ia.prop[g],this.ja));if(!0===this.Ia.smooth&&"quaternion"===this.Ia.prop[0])d=b[0],d[0].quaternion=H.wk(this.B.data.quaternion,this.S,this.ba,this.u.data.quaternion,a);else if("quaternion"===this.Ia.prop[0])d=b[0],d[0].quaternion=H.slerp(this.B.data.quaternion,this.u.data.quaternion,a);else{var k=this.f.easing(a),
n,v,x=0;for(g=0;g<h;g++){n=Bb(this.Ia.prop[g],this.B.data);v=Bb(this.Ia.prop[g],this.u.data);d=b[g];n=n[0][n[1]];v=v[0][v[1]];if(this.Ia.Wa&&this.Ia.Wa[g]){var E=this.Ia.Wa[g][0],Cb=this.Ia.Wa[g][1],x=Math.abs(E-Cb)/2;Math.abs(n-v)>x?(n=G.Wa(n+x,E,Cb),v=G.Wa(v+x,E,Cb)):x=0}d[0][d[1]]=(1-k)*n+k*v-x}}"function"===typeof this.Ia.Dj&&this.Ia.Dj.call(this,a)}null!==this.G&&this.G.D({progress:this.F/this.I})};e.Xm=function(){Db(this)||null!==this.A&&this.A.D()};
e.play=function(){this.F=0;this.B=this.m.keyframes[0];this.u=this.m.keyframes[1];Db(this,0)};e.stop=function(){this.f.stop()};e.resume=function(){Db(this)};e.destroy=function(){null!==this.m&&(this.m.destroy(),this.m=null);null!==this.f&&(this.f.destroy(),this.f=null);null!==this.C&&(this.C.destroy(),this.C=null);null!==this.H&&(this.H.destroy(),this.H=null);null!==this.G&&(this.G.destroy(),this.G=null);null!==this.A&&(this.A.destroy(),this.A=null);l.prototype.destroy.call(this)};
Object.defineProperty(zb.prototype,"timeline",{get:function(){return this.m}});Object.defineProperty(zb.prototype,"instruction",{get:function(){return this.Ia},set:function(a){this.Ia=a}});Object.defineProperty(zb.prototype,"tween",{get:function(){return this.f},set:function(a){this.f=a}});Object.defineProperty(zb.prototype,"tweenTime",{get:function(){return this.N},set:function(a){this.N=a}});Object.defineProperty(zb.prototype,"smooth",{get:function(){return this.U},set:function(a){this.U=a}});
Object.defineProperty(zb.prototype,"onPlay",{get:function(){null===this.C&&(this.C=new q(this));return this.C}});Object.defineProperty(zb.prototype,"onStop",{get:function(){null===this.H&&(this.H=new q(this));return this.H}});Object.defineProperty(zb.prototype,"onProgress",{get:function(){null===this.G&&(this.G=new q(this));return this.G}});Object.defineProperty(zb.prototype,"onComplete",{get:function(){null===this.A&&(this.A=new q(this));return this.A}});
function Eb(a,b,d){this.i=a;this.ja=b||null;this.c=null;this.C=0;this.o=this.j=null;l.call(this,d)}Eb.prototype=Object.create(l.prototype);Eb.prototype.constructor=Eb;Eb.prototype.stop=function(){for(var a=0,b=this.c;a<b;a++)this.c[a].stop()};Eb.prototype.resume=function(){for(var a=0,b=this.c;a<b;a++)this.c[a].resume()};Eb.prototype.Ub=function(){this.C++;this.C===this.c.length&&null!==this.o&&this.o.D()};
function Fb(a,b,d,g,h,k){var n=null,v=null;d=B.pd(d,"time");for(var x=0;x<d.length;x++){var E="string"===typeof k?d[x].data[k][g]:d[x].data[g];if("undefined"!==typeof E&&null!==E&&(d[x].time<b&&(n=d[x]),d[x].time>b)){v=d[x];break}}null===n&&(n={time:0,data:{}},"string"===typeof k?n.data[k]=a.ja[k]:n.data[g]=a.ja[g]);if(null===v)return"string"===typeof k?n.data[k][g]:n.data[g];a=h((b-n.time)/(v.time-n.time));return(1-a)*("string"===typeof k?n.data[k][g]:n.data[g])+a*("string"===typeof k?v.data[k][g]:
v.data[g])}function Gb(a){for(var b;a.c&&0<a.c.length;)b=a.c.pop(),b.onComplete.remove(a.Ub,a),b.destroy();a.c=[];a.C=0}Object.defineProperty(Eb.prototype,"onComplete",{get:function(){null===this.o&&(this.o=new q(this));return this.o}});function Hb(a){this.c=this.A=this.C=null;this.u=0;this.f=null;this.m=0;l.call(this,a)}Hb.prototype=Object.create(l.prototype);Hb.prototype.constructor=Hb;
Hb.prototype.j=function(a){this.O=a.uid;this.C=a.name;this.A=a.description;this.c=a.keyframes;this.f="linear";this.m=0;"object"===typeof a.easing&&null!==a.easing&&(this.f=a.easing["default"]||this.f,this.m=a.easing.offset||this.m);ba(this)};Hb.prototype.destroy=function(){da(this)};Object.defineProperty(Hb.prototype,"name",{get:function(){return this.C}});Object.defineProperty(Hb.prototype,"description",{get:function(){return this.A}});Object.defineProperty(Hb.prototype,"keyframes",{get:function(){return this.c}});
Object.defineProperty(Hb.prototype,"count",{set:function(a){"number"===typeof a&&(this.u=a)},get:function(){return this.u}});Object.defineProperty(Hb.prototype,"easing",{get:function(){return this.f}});Object.defineProperty(Hb.prototype,"offset",{get:function(){return this.m}});Object.defineProperty(Hb.prototype,"duration",{get:function(){for(var a,b=0,d=this.c.length;b<d;b++)this.c[b].time>a&&(a=this.c[b].time);return a}});
function Ib(a,b){this.i=a;this.c=null;this.W="";this.P=this.K=!0;this.o=null;this.R=this.M=!1;this.H=this.C=this.G=this.B=null;l.call(this,b||"Object3D");this.Se()}Ib.prototype=Object.create(l.prototype);e=Ib.prototype;e.constructor=Ib;e.Se=function(){this.o={};this.c=new THREE.Mesh;this.i.renderer.objects.register(this)};e.click=function(){this.log("click "+this.c.id);!0===B.T(this.o.onClick,"ActionEventDispatcher")&&this.o.onClick.D();null!==this.B&&this.B.D()};
e.Te=function(){this.log("over "+this.c.id);!0===B.T(this.o.onOver,"ActionEventDispatcher")&&this.o.onOver.D();null!==this.G&&this.G.D()};e.qd=function(){this.log("out "+this.c.id);!0===B.T(this.o.onOut,"ActionEventDispatcher")&&this.o.onOut.D();null!==this.C&&this.C.D()};
e.destroy=function(){this.i.renderer.objects.unregister(this);null!==this.c&&(this.c.c=null,null!==this.c.geometry&&(this.c.geometry.dispose(),this.c.geometry=null),this.c=this.c.material=null);null!==this.B&&(this.B.destroy(),this.B=null);null!==this.G&&(this.G.destroy(),this.G=null);null!==this.C&&(this.C.destroy(),this.C=null);null!==this.H&&(this.H.destroy(),this.H=null);this.i=null;l.prototype.destroy.call(this)};Object.defineProperty(Ib.prototype,"mesh",{get:function(){return this.c}});
Object.defineProperty(Ib.prototype,"visible",{get:function(){return this.K},set:function(a){this.K=!!a;null!==this.c&&(this.c.visible=this.K)}});Object.defineProperty(Ib.prototype,"hovered",{get:function(){return this.M},set:function(a){this.M=!!a}});Object.defineProperty(Ib.prototype,"interactive",{get:function(){return this.P},set:function(a){this.P=!!a}});Object.defineProperty(Ib.prototype,"fx",{get:function(){return this.W}});Object.defineProperty(Ib.prototype,"events",{get:function(){return this.o}});
Object.defineProperty(Ib.prototype,"ready",{get:function(){return this.R}});Object.defineProperty(Ib.prototype,"onClick",{get:function(){null===this.B&&(this.B=new q(this));return this.B}});Object.defineProperty(Ib.prototype,"onOver",{get:function(){null===this.G&&(this.G=new q(this));return this.G}});Object.defineProperty(Ib.prototype,"onOut",{get:function(){null===this.C&&(this.C=new q(this));return this.C}});
Object.defineProperty(Ib.prototype,"onReady",{get:function(){null===this.H&&(this.H=new q(this));return this.H}});function Ra(a){this.i=a;this.c=this.Z=null;l.call(this,"ObjectRenderer");this.Z=[];this.c=[]}Ra.prototype=Object.create(l.prototype);e=Ra.prototype;e.constructor=Ra;function Jb(a,b){var d=[];return d="undefined"===typeof b||""===b||null===b?a.Z.filter(function(a){return"undefined"===typeof a.fx||""===a.fx||null===a.fx}):a.Z.filter(function(a){return a.fx===b})}
function Kb(a){var b=Jb(a,null);return B.jj(a.Z,b)}function Lb(a){return Kb(a).reduce(function(a,d){0>a.indexOf(d.fx)&&a.push(d.fx);return a},[])}e.register=function(a){this.Z.push(a)};e.unregister=function(a){this.Z.splice(this.Z.indexOf(a),1)};
e.nj=function(){var a=this.i.renderer.camera.main,b=Jb(this,null);if(0<b.length){for(var d=new THREE.Scene,g=0,h=b.length;g<h;g++)d.add(b[g].mesh);h=new ab(this.i,d,a,null);this.c.push(h)}b=Lb(this);d=0;for(g=b.length;d<g;d++){for(var h=b[d],k=Jb(this,h),n=new THREE.Scene,v=0,x=k.length;v<x;v++)n.add(k[v].mesh);h=new ab(this.i,n,a,this.i.postProcessing.fe(h));this.c.push(h)}};e.Jj=function(){return this.Z.filter(function(a){return!0===a.ready&&!0===a.interactive})};
e.Gj=function(a){for(var b=0,d=this.Z.length;b<d;b++)if(this.Z[b].mesh===a)return this.Z[b];return null};e.Ue=function(){for(var a=this.c.length;a--;)this.c.pop().destroy()};e.destroy=function(){this.Ue();this.i=this.c=null;l.prototype.destroy.call(this)};Object.defineProperty(Ra.prototype,"all",{get:function(){return this.Z}});Object.defineProperty(Ra.prototype,"renderScenes",{get:function(){return this.c}});function Mb(a){this.i=a;this.c=this.f=null;l.call(this,"Raycaster")}Mb.prototype=Object.create(l.prototype);
e=Mb.prototype;e.constructor=Mb;
e.start=function(a){this.log("Raycaster start");null===this.f&&(this.f=new THREE.Raycaster);a===Wa.Za?(this.log("Raycating start pointer"),!1===this.i.canvas.pointer.onClick.has(this.Md,this)&&this.i.canvas.pointer.onClick.add(this.Md,this),!1===this.i.canvas.pointer.onMove.has(this.Nd,this)&&this.i.canvas.pointer.onMove.add(this.Nd,this)):a===Wa.vc&&(this.log("Raycating start gaze"),!1===this.i.renderer.camera.onCameraChange.has(this.Ld,this)&&this.i.renderer.camera.onCameraChange.add(this.Ld,this))};
e.stop=function(){this.log("Raycaster stop");this.i.canvas.pointer.onClick.has(this.Md,this)&&this.i.canvas.pointer.onClick.remove(this.Md,this);this.i.canvas.pointer.onMove.has(this.Nd,this)&&this.i.canvas.pointer.onMove.remove(this.Nd,this);this.i.renderer.camera.onCameraChange.has(this.Ld,this)&&this.i.renderer.camera.onCameraChange.remove(this.Ld,this);Nb(this);this.f=null};e.Md=function(a){a.data.center=a.data.center||{x:a.data.clientX,y:a.data.clientY};Ob(this,"click",a.data.center)};
e.Nd=function(a){a.data.center=a.data.center||{x:a.data.clientX,y:a.data.clientY};Ob(this,"move",a.data.center)};e.Ld=function(){Ob(this,"move")};
function Ob(a,b,d){var g=a.i.renderer.canvasResolution;d=d||{x:g.width/2,y:g.height/2};var h=a.i.renderer.camera,k=(new THREE.Vector2(d.x/g.width,1-d.y/g.height)).multiplyScalar(2).addScalar(-1),g=a.i.renderer.objects.Jj();d=0;for(var n=g.length;d<n;d++)g[d].hovered=!1;d=null;a.f.setFromCamera(k,h.main);h=[];k=0;for(n=g.length;k<n;k++)h.push(g[k].mesh);for(g=a.f.intersectObjects(h);null===d&&0<g.length;){var h=g.shift(),k=h.object,v=h.uv,h=a.i.renderer.objects.Gj(k);if(!1===k.material.transparent)d=
h;else{n=h;k=v;v=null;if(null!==n.mesh&&null!==n.mesh.material&&"undefined"!==typeof n.mesh.material.uniforms.tTexture){var x=n.mesh.material.uniforms.tTexture.value,n=null;null!==x&&null!==x.image&&("img"===x.image.nodeName.toLowerCase()?(n=document.createElement("canvas"),n.width=x.image.width,n.height=x.image.height,n.getContext("2d").drawImage(x.image,0,0)):"canvas"===x.image.nodeName.toLowerCase()&&(n=x.image),null!==n&&(v=n.width,x=n.height,k=4*(Math.floor(x-k.y*x)*v+Math.floor(k.x*v)),n=n.getContext("2d").getImageData(0,
0,v,x).data,v=new Pb(0,0,0,n[k+3])))}else"undefined"!==typeof n.mesh.material.color&&(v=n.mesh.material.color);k=v;null!==k&&10<k.alpha&&(d=h)}}null!==d?"click"===b?a.click():"move"===b&&d!==a.c&&(Nb(a),a.c=d,d.Te(),a.i.renderer.pickingManager.mode===Wa.vc&&a.i.renderer.camera.gaze.start()):Nb(a)}function Nb(a){null!==a.c&&(a.c.qd(),a.c=null,a.i.renderer.pickingManager.mode===Wa.vc&&a.i.renderer.camera.gaze.stop())}e.click=function(){null!==this.c&&this.c.click()};e.Gh=function(){this.c=null};
Object.defineProperty(Mb.prototype,"hoveredObject",{get:function(){return this.c}});
function Qb(a){this.i=a;this.c=this.f=this.ja=null;l.call(this,"PickingDrawPass");a=B.clone(this.i.renderer.view.cc.mapping);a.uniforms.tColor={type:"c",value:new THREE.Color(0)};this.f=new THREE.RawShaderMaterial({fragmentShader:tb.eb(vb.wts_frag_color),vertexShader:tb.eb(a.vertexShader),uniforms:a.uniforms,side:THREE.FrontSide,name:"PickingMaterial"});this.ja=new THREE.WebGLRenderTarget(this.i.renderer.canvasResolution.width/3,this.i.renderer.canvasResolution.height/3,{format:THREE.RGBAFormat});
this.ja.name="Picking RenderTarget"}Qb.prototype=Object.create(l.prototype);e=Qb.prototype;e.constructor=Qb;function Rb(a){return new THREE.Color(a.id)}
function Sb(a,b){b.data.center=b.data.center||{x:b.data.x,y:b.data.y};var d=new Uint8Array(4);a.i.renderer.webGLRenderer.readRenderTargetPixels(a.ja,b.data.center.x/b.data.target.width*a.ja.width,(1-b.data.center.y/b.data.target.height)*a.ja.height,1,1,d);b=new THREE.Color(d[0],d[1],d[2]);a:{a=a.i.renderer.objects.all;for(var d=0,g=a.length;d<g;d++)if(a[d].mesh.id===((b.r&255)<<16|((b.g&255)<<8)+(b.b&255))){b=a[d];break a}b=null}return b}e.ad=function(a){a=Sb(this,a);null!==a&&a.click()};
e.Ud=function(a){a=Sb(this,a);null===a?null!==this.c&&(this.c.qd(),this.c=null):a!==this.c&&(null!==this.c&&this.c.qd(),a.Te(),this.c=a)};e.start=function(){this.i.canvas.pointer.enabled=!0;!1===this.i.canvas.pointer.onClick.has(this.ad,this)&&this.i.canvas.pointer.onClick.add(this.ad,this);!1===this.i.canvas.pointer.onMove.has(this.Ud,this)&&this.i.canvas.pointer.onMove.add(this.Ud,this)};
e.stop=function(){this.i.canvas.pointer.onClick.has(this.ad,this)&&this.i.canvas.pointer.onClick.remove(this.ad,this);this.i.canvas.pointer.onMove.has(this.Ud,this)&&this.i.canvas.pointer.onMove.remove(this.Ud,this)};e.click=function(){null!==this.c&&this.i.canvas.pointer.onClick.has(this.ad,this)&&this.c.click()};e.setSize=function(a){null!==this.ja&&this.ja.setSize(a.width,a.height)};e.qh=function(){this.c=null};
e.destroy=function(){null!==this.f&&(this.f.dispose(),this.f=null);null!==this.ja&&(this.ja.dispose(),this.ja=null);this.i=null;l.prototype.destroy.call(this)};Object.defineProperty(Qb.prototype,"material",{get:function(){return this.f}});Object.defineProperty(Qb.prototype,"renderTarget",{get:function(){return this.ja}});function Pa(a){this.i=a;this.f=this.c=null;this.j=Wa.Za;l.call(this,"PickingManager")}Pa.prototype=Object.create(l.prototype);Pa.prototype.constructor=Pa;var Wa={Za:"pointer",vc:"gaze"};
e=Pa.prototype;e.Dk=function(a){a===Na.ob?null===this.f&&(null!==this.c&&(this.c.stop(),this.c.destroy(),this.c=null),this.f=new Mb(this.i),this.f.start(this.j)):null===this.c&&(null!==this.f&&(this.f.stop(),this.f.destroy(),this.f=null),this.c=new Qb(this.i),this.c.start())};e.rh=function(){null!==this.f&&this.f.Gh();null!==this.c&&this.c.qh()};e.setSize=function(a){null!==this.c&&this.c.setSize(a)};e.click=function(){null!==this.f&&this.f.click();null!==this.c&&this.c.click()};
e.start=function(){null!==this.f&&this.f.start(this.j);null!==this.c&&this.c.start()};e.stop=function(){null!==this.f&&this.f.stop();null!==this.c&&this.c.stop()};e.destroy=function(){null!==this.f&&(this.f.stop(),this.f.destroy(),this.f=null);null!==this.c&&(this.c.stop(),this.c.destroy(),this.c=null);l.prototype.destroy.call(this)};Object.defineProperty(Pa.prototype,"renderTarget",{get:function(){return null===this.c?null:this.c.renderTarget}});
Object.defineProperty(Pa.prototype,"material",{get:function(){return null===this.c?null:this.c.material}});Object.defineProperty(Pa.prototype,"mode",{get:function(){return this.j},set:function(a){a!==Wa.Za&&a!==Wa.vc||a===this.j||(this.j=a,this.start())}});function qa(a){this.i=a;this.c=[];l.call(this,"HotspotManager")}qa.prototype=Object.create(l.prototype);e=qa.prototype;e.constructor=qa;
e.Qk=function(){var a=this.i.story.scene;a.onUnloadStart.da(this.en,this);"undefined"!==typeof a.config.hotspots&&this.ha(a.config.hotspots)};e.en=function(){this.Ne()};e.boot=function(){this.i.story.onSceneLoadStart.add(this.Qk,this)};e.Bn=function(a){return this.c.filter(function(b){return b.type===a})};e.ha=function(a){for(var b=0,d=a.length;b<d;b++){var g=a[b],h=null;switch(g.type||Tb.Ff){case Tb.Ff:h=new Ub(this.i,g)}null!==h&&this.c.push(h)}};
e.fj=function(a){if(null!==a.tracks&&"undefined"!==typeof a.tracks){a=a.tracks;for(var b=0,d=a.length;b<d;b++)new Vb(a[b])}};e.update=function(){for(var a=0,b=this.c.length;a<b;a++)this.c[a].update()};e.Ne=function(){for(var a=this.c.length;a--;)this.c.pop().destroy()};e.destroy=function(){this.Ne();this.c=this.i=null;l.prototype.destroy.call(this)};Object.defineProperty(qa.prototype,"all",{get:function(){return this.c}});Object.defineProperty(qa.prototype,"count",{get:function(){return this.c}});
function Ub(a,b){this.A=b;this.N="";this.u=this.F=this.ba=this.m=this.f=null;this.U=!1;this.I=this.J=null;Ib.call(this,a,"Hotspot3D")}Ub.prototype=Object.create(Ib.prototype);e=Ub.prototype;e.constructor=Ub;
e.Se=function(){Ib.prototype.Se.call(this);this.f=new Wb;this.u=new Xb(this.i,this.f);this.m=new Yb(this.i);if("undefined"!==typeof this.A&&null!==this.A){var a=this.A;this.O=a.uid;this.Ya=a.tags;ba(this);this.j=a.type;this.N=a.name;this.K=a.visible;this.U=a.facingCenter||!1;"undefined"!==typeof a.transform&&this.f.load(a.transform);"undefined"!==typeof a.animation&&(this.u.load(a.animation),this.u.onProgress.add(this.Zi,this));this.m.onReady.add(this.Di,this);var b;"undefined"!==typeof a.material?
b=a.material:b=Zb.ri;!0===this.Wc&&(b=B.ab(b,Zb.ai));this.m.load(b);"undefined"!==typeof a.sound&&(this.F=new $b(this.i),this.F.load(a.sound,a.transform));"string"===typeof a.fx&&(this.W=a.fx);if("object"===typeof a.events){var a=a.events,d;for(d in a)b=new ac(this.i),b.c(a[d]),this.o[d]=b}}this.J=this.Pk.bind(this);this.I=this.wm.bind(this)};
e.Pk=function(a,b,d,g,h,k){this.log(k);a=this.i.renderer.webGLRenderer.getContext();this.i.renderer.view.pc(h.uniforms);"HotspotMaterial"===h.name?this.m.type===bc.Bd?h.uniforms.tColor.value=new THREE.Color(this.m.color):h.uniforms.tTexture.value=this.m.c:"PickingMaterial"===h.name&&h.program&&(b=this.ba,a.useProgram(h.program.program),h.program.getUniforms().map.tColor.setValue(a,b),h.uniforms.tColor.value=b)};e.wm=function(){};
e.Di=function(){this.c.material=this.m.material;if("undefined"!==typeof this.A.geometry&&"string"===typeof this.A.geometry.type){var a=this.A.geometry.options;switch(this.A.geometry.type){case cc.Zh:var b=this.c,a=a||{},a=new THREE.BoxBufferGeometry(a.width||100,a.height||100,a.depth||100,a.widthSegments||8,a.heightSegments||8,a.depthSegments||8);b.geometry=a;break;case cc.ni:b=this.c;a=a||{};a=new THREE.SphereBufferGeometry(a.radius||10,a.widthSegments||64,a.heightSegments||64,a.phiStart||0,a.phiLength||
2*Math.PI,a.thetaStart||0,a.thetaLength||2*Math.PI);b.geometry=a;break;case cc.$h:b=this.c;a=a||{};a=new THREE.CylinderBufferGeometry(a.radiusTop||10,a.radiusBottom||10,a.height||20,a.radiusSegments||32,a.heightSegments||1,a.openEnded||!1,a.thetaStart||0,a.thetaLength||2*Math.PI);b.geometry=a;break;case cc.ki:this.c.geometry=dc(a);break;default:this.c.geometry=dc()}}else this.c.geometry=dc();this.c.geometry.scale(this.f.scale.x,this.f.scale.y,this.f.scale.z);this.c.material=this.m.material;this.c.c=
this.A;this.c.f=this.i.renderer.view instanceof Za;this.Zi();this.R=!0;null!==this.H&&this.H.D();this.ba=Rb(this.c);this.c.onBeforeRender=this.J;this.c.onAfterRender=this.I;!0===this.u.autoPlay&&this.u.play()};
e.Zi=function(){this.c.position.x=this.f.position.x;this.c.position.y=this.f.position.y;this.c.position.z=this.f.position.z;if(!0===this.U){var a=(new THREE.Spherical).setFromVector3(new THREE.Vector3(this.f.position.x,this.f.position.y,this.f.position.z));this.c.rotation.set(-a.phi+Math.PI/2,a.theta+Math.PI,0,"YXZ");this.c.rotation.x+=-G.ca(this.f.rotation.x);this.c.rotation.y+=G.ca(this.f.rotation.y);this.c.rotation.z+=G.ca(this.f.rotation.z)}else this.c.rotation.set(-G.ca(this.f.rotation.x),G.ca(this.f.rotation.y),
G.ca(this.f.rotation.z),"YXZ");this.c.scale.x=G.X(this.f.scale.x,1E-6,1E5);this.c.scale.y=G.X(this.f.scale.y,1E-6,1E5);this.c.scale.z=G.X(this.f.scale.z,1E-6,1E5)};e.update=function(){null!==this.m&&this.m.update();null!==this.F&&this.F.update()};
e.destroy=function(){this.m.onReady.remove(this.Di,this);this.I=this.J=null;null!==this.f&&(this.f.destroy(),this.f=null);null!==this.u&&(this.u.destroy(),this.u=null);null!==this.m&&(this.m.destroy(),this.m=null);null!==this.F&&(this.F.destroy(),this.F=null);Ib.prototype.destroy.call(this)};Object.defineProperty(Ub.prototype,"type",{get:function(){return this.j}});Object.defineProperty(Ub.prototype,"name",{get:function(){return this.N}});Object.defineProperty(Ub.prototype,"animation",{get:function(){return this.u}});
function $b(a){this.i=a;this.c=this.u=this.f=null;this.C=0;this.A=1;this.G=!1;this.H=0;this.B=!1;this.m={x:0,y:0,z:200};this.o=360;l.call(this,"HotspotSound")}$b.prototype=Object.create(l.prototype);e=$b.prototype;e.constructor=$b;e.Rk=function(){this.log("Sound load complete");null!==this.f&&this.f.D()};
e.load=function(a,b){if("undefined"!==typeof a.source&&"object"===typeof a.source)if(this.O=a.uid,"undefined"!==typeof a.source.url&&"string"===typeof a.source.url&&""!==a.source.url){this.j=a.source.url;if("undefined"!==typeof a.options&&"object"===typeof a.options){if("number"===typeof a.options.volume)this.A=a.options.volume;else if("object"===typeof a.options.volume){var d=a.options.volume;this.C="number"===typeof d.min?G.X(d.min,0,1):0;this.A="number"===typeof d.max?G.X(d.max,0,1):1}this.G="boolean"===
typeof a.options.loop?a.options.loop:!1;this.H="number"===typeof a.options.startTime?a.options.startTime:0;this.B="boolean"===typeof a.options.autoPlay?a.options.autoPlay:!1;this.o="number"===typeof a.options.range?G.X(a.options.range,1,360):360}"undefined"!==typeof b&&"undefined"!==typeof b.position&&(this.m.theta="number"===typeof b.position.theta?G.X(b.position.theta,-180,180):0,this.m.phi="number"===typeof b.position.phi?G.X(b.position.phi,-90,90):0);this.c=new M(this.i,this.O,this.j||"");this.c.onCanPlayThrough.da(this.Rk,
this);!0===360>this.o&&(a=B.De(1,G.ca(-this.m.theta),G.ca(this.m.phi)),this.u=(new THREE.Vector3).setFromSpherical(a),this.c.spatialized=360>this.o,this.c.x=this.u.x,this.c.y=this.u.y,this.c.z=this.u.z);this.c.volume=this.A;this.c.loop=this.G;this.c.startTime=this.H;!0===this.B&&this.c.play(this.H,this.G,!0)}else"undefined"!==typeof a.source.target&&!0===p.Va(a.source.target)&&p.get(a.source.target)};
e.update=function(){if(!1===this.i.audio.enabled)null!==this.c&&this.c.stop();else if(!0===360>this.o&&!0===360>this.o&&"number"===typeof this.o){var a=this.i.renderer.camera,a=H.lc(G.ca(a.yaw),G.ca(a.pitch),0),b=H.lc(G.ca(this.m.theta),G.ca(this.m.phi),0),a=H.ij(b,a),b=G.ca(this.o/2);this.c.volume=a<b?this.C+(this.A-this.C)*(1-a/b):this.C}};e.destroy=function(){null!==this.c&&(this.c.destroy(),this.c=null);this.m=this.u=null;null!==this.f&&this.f.destroy();l.prototype.destroy.call(this)};
Object.defineProperty($b.prototype,"sound",{get:function(){return this.c}});Object.defineProperty($b.prototype,"onReady",{get:function(){null===this.f&&(this.f=new q(this));return this.f}});function Yb(a){this.i=a;this.u=null;this.j="";this.f=this.c=null;this.o=1;this.A=!1;this.C=16777215;this.L=null;this.G=!1;this.m=null;l.call(this,"HotspotMaterial")}Yb.prototype=Object.create(l.prototype);Yb.prototype.constructor=Yb;
var bc={IMAGE:"image",li:"plugin",Bd:"graphics"},Zb={ri:{color:"#ffffff",opacity:0,transparent:!1},ai:{color:"#00ff00",opacity:.8,transparent:!1}};e=Yb.prototype;
e.jm=function(a){a=a.emitter;this.log("Texture load complete (Image) : "+a.element.src);this.L=a;this.c=new THREE.Texture(a.element);this.c.image.crossOrigin="anonymous";this.c.wrapS=THREE.ClampToEdgeWrapping;this.c.wrapT=THREE.ClampToEdgeWrapping;this.c.minFilter=THREE.LinearFilter;this.c.magFilter=THREE.LinearFilter;this.c.needsUpdate=!0;this.log("Map new texture from image");ec(this)};
e.Li=function(a){a=a.data;a.uid===this.u.plugin&&(this.i.plugins.onInstanceCreate.remove(this.Li,this),fc(this,a))};function fc(a,b){!0===b.instanceReady?gc(a,b):b.onInstanceReady.da(a.an,a)}e.an=function(a){a=a.emitter;if(null===a.instance||!1===a.instanceReady)throw Error("Plugin instance not available");gc(this,a)};
function gc(a,b){a.L=b.instance.texture;a.c=new THREE.Texture(a.L.dom);a.c.format=THREE.RGBAFormat;a.c.wrapS=THREE.ClampToEdgeWrapping;a.c.wrapT=THREE.ClampToEdgeWrapping;a.c.magFilter=THREE.LinearFilter;a.c.minFilter=THREE.LinearFilter;a.c.generateMipmaps=!1;a.c.needsUpdate=!0;a.log("Map new texture from plugin");ec(a)}
e.Oe=function(){null!==this.f&&(this.f.dispose(),this.f=null);var a=B.clone(this.i.renderer.view.cc.mapping);this.j===bc.Bd&&(a.fragmentShader=vb.wts_frag_color,a.uniforms.tColor={type:"c",value:new THREE.Color(2105376)});a.uniforms.tOpacity={type:"f",value:this.o};var b=tb.eb(a.vertexShader),d=tb.eb(a.fragmentShader);this.f=new THREE.RawShaderMaterial({fragmentShader:d,vertexShader:b,uniforms:a.uniforms,side:THREE.DoubleSide,name:"HotspotMaterial"});null!==this.c&&(this.f.transparent=this.A,this.f.needsUpdate=
!0);null!==this.m&&this.m.D()};function ec(a){!0===a.i.renderer.viewReady&&a.Oe();a.i.renderer.onViewReady.add(a.Oe,a)}
e.load=function(a){a=this.u=a;this.o="number"===typeof a.opacity?G.X(a.opacity,0,1):1;this.A="boolean"===typeof a.transparent?a.transparent:!1;this.C="string"===typeof a.color?a.color:16777215;this.G="boolean"===typeof a.update?a.update:!1;"undefined"!==typeof a.image&&null!==a.image?(a=a.image,this.j=bc.IMAGE,this.L=new ic(this.i,a),this.L.onLoadComplete.da(this.jm,this)):"undefined"!==typeof a.plugin&&null!==a.plugin?(a=a.plugin,this.j=bc.li,a=this.i.plugins.get(a),"undefined"===typeof a||null===
a?this.i.plugins.onInstanceCreate.add(this.Li,this):fc(this,a)):(this.j=bc.Bd,ec(this))};e.update=function(){this.f&&this.f.uniforms&&(this.f.uniforms.tTexture.value=this.c,this.f.uniforms.tOpacity.value=this.o);null!==this.c&&!0===this.G&&(this.c.needsUpdate=!0)};
e.destroy=function(){this.i.renderer.onViewReady.remove(this.Oe,this);null!==this.c&&(this.c.dispose(),this.c=null);null!==this.f&&(this.f.dispose(),this.f=null);this.j===bc.IMAGE&&null!==this.L&&this.L.destroy();this.L=null;null!==this.m&&(this.m.destroy(),this.m=null);this.i=null;l.prototype.destroy.call(this)};Object.defineProperty(Yb.prototype,"type",{get:function(){return this.j}});Object.defineProperty(Yb.prototype,"texture",{get:function(){return this.c}});
Object.defineProperty(Yb.prototype,"material",{get:function(){return this.f}});Object.defineProperty(Yb.prototype,"opacity",{get:function(){return this.o}});Object.defineProperty(Yb.prototype,"transparent",{get:function(){return this.A}});Object.defineProperty(Yb.prototype,"color",{get:function(){return this.C}});Object.defineProperty(Yb.prototype,"displayObject",{get:function(){return this.L}});Object.defineProperty(Yb.prototype,"onReady",{get:function(){null===this.m&&(this.m=new q(this));return this.m}});
function dc(a){a=a||{};return new THREE.PlaneBufferGeometry(a.width||100,a.height||100,a.widthSegments||8,a.heightSegments||8)}var cc={ki:"plane",Zh:"box",ni:"sphere",$h:"cylinder"};function Wb(a,b,d){this.c=a||{x:0,y:0,z:-200};this.f=b||{x:0,y:0,z:0};this.j=d||{x:1,y:1,z:1};l.call(this,"HotspotTransform")}Wb.prototype=Object.create(l.prototype);Wb.prototype.constructor=Wb;
Wb.prototype.load=function(a){if("undefined"!==typeof a.position)if("number"===typeof a.position.x||"number"===typeof a.position.y||"number"===typeof a.position.z)this.c.x="number"===typeof a.position.x?a.position.x:0,this.c.y="number"===typeof a.position.y?a.position.y:0,this.c.z="number"===typeof a.position.z?a.position.z:-200;else{var b="number"===typeof a.position.radius?a.position.radius:200,d="number"===typeof a.position.theta?G.ca(a.position.theta):0,g="number"===typeof a.position.phi?G.ca(a.position.phi):
0,d=G.Wa(Math.PI-d,-Math.PI,Math.PI),b=(new THREE.Vector3).setFromSpherical(B.De(b,d,g));this.c.x=b.x;this.c.y=b.y;this.c.z=b.z}"undefined"!==typeof a.rotation?(this.f.x="number"===typeof a.rotation.x?a.rotation.x:0,this.f.y="number"===typeof a.rotation.y?a.rotation.y:0,this.f.z="number"===typeof a.rotation.z?a.rotation.z:0):(b={x:0,y:0,z:0},"undefined"!==typeof this.c&&(d=(new THREE.Spherical).setFromVector3(new THREE.Vector3(this.c.x,this.c.y,this.c.z)),b.y=-d.phi+Math.PI/2,b.x=d.theta+Math.PI),
this.f=b);"undefined"!==typeof a.scale&&(this.j.x="number"===typeof a.scale.x?G.X(a.scale.x,1E-6,1E5):1,this.j.y="number"===typeof a.scale.y?G.X(a.scale.y,1E-6,1E5):1,this.j.z="number"===typeof a.scale.z?G.X(a.scale.z,1E-6,1E5):1)};Object.defineProperty(Wb.prototype,"position",{get:function(){return this.c}});Object.defineProperty(Wb.prototype,"rotation",{get:function(){return this.f}});Object.defineProperty(Wb.prototype,"scale",{get:function(){return this.j}});
function Xb(a,b){this.f=this.A=null;this.G=this.u=this.H=!1;this.m=null;Eb.call(this,a,b,"HotspotAnimation");this.j=[{prop:["rotation.x","rotation.y","rotation.z"],Wa:[[-180,180],[-180,180],[-180,180]],smooth:!1},{prop:["position.x","position.y","position.z"],smooth:!1},{prop:["scale.x","scale.y","scale.z"],smooth:!1}]}Xb.prototype=Object.create(Eb.prototype);e=Xb.prototype;e.constructor=Xb;
e.load=function(a){!0===a.enabled&&(this.H="boolean"===typeof a.loop?a.loop:!1,this.u="boolean"===typeof a.random?a.random:!1,this.G="boolean"===typeof a.autoPlay?a.autoPlay:!1,null!==a.tracks&&B.Ga(a.tracks,"string")&&(this.f=!0===this.u?B.nd(a.tracks):a.tracks))};e.Ub=function(){if(1<this.f.length){var a=this.f.indexOf(this.A)+1;if(a<this.f.length){this.play(a);return}}!0===this.H?(!0===this.u&&(this.f=B.nd(this.f)),this.play(0)):Eb.prototype.Ub.call(this)};e.Me=function(){null!==this.m&&this.m.D()};
e.play=function(a){this.A="number"===typeof a?this.f[a]:"string"===typeof a?a:this.f[0];a=p.get(this.A);Gb(this);var b,d=a.offset,g=new zb(this.i,this.ja);g.tween.easing=a.easing;g.instruction=this.j[0];g.instruction.smooth=a.smooth;g.onComplete.add(this.Ub,this);g.onProgress.add(this.Me,this);for(var h,k,n,v=0,x=a.keyframes.length;v<x;v++)b=a.keyframes[v].time+d,h=a.keyframes[v].data.rotation,"undefined"!==typeof h&&null!==h&&(k="undefined"!==typeof h.x&&null!==h.x?h.x:Fb(this,b,a.keyframes,"x",
g.tween.easing,"rotation"),n="undefined"!==typeof h.y&&null!==h.y?h.y:Fb(this,b,a.keyframes,"y",g.tween.easing,"rotation"),h="undefined"!==typeof h.z&&null!==h.z?h.z:Fb(this,b,a.keyframes,"z",g.tween.easing,"rotation"),b=new yb(b+d,{rotation:{x:k,y:n,z:h}}),g.timeline.lb(b));if(0<g.timeline.keyframes.length&&0<g.timeline.keyframes[0].time||0<d)v={rotation:B.clone(this.ja.rotation)},b=new yb(0,v),g.timeline.lb(b);this.c.push(g);g=new zb(this.i,this.ja);g.tween.easing=a.easing;g.instruction=this.j[1];
g.instruction.smooth=a.smooth;g.onComplete.add(this.Ub,this);g.onProgress.add(this.Me,this);v=0;for(x=a.keyframes.length;v<x;v++)b=a.keyframes[v].time+d,h=a.keyframes[v].data.position,"undefined"!==typeof h&&null!==h&&("number"===typeof h.x||"number"===typeof h.y||"number"===typeof h.z||"number"!==typeof h.radius&&"number"!==typeof h.theta&&"number"!==typeof h.phi?(k="undefined"!==typeof h.x&&null!==h.x?h.x:Fb(this,b,a.keyframes,"x",g.tween.easing,"position"),n="undefined"!==typeof h.y&&null!==h.y?
h.y:Fb(this,b,a.keyframes,"y",g.tween.easing,"position"),h="undefined"!==typeof h.z&&null!==h.z?h.z:Fb(this,b,a.keyframes,"z",g.tween.easing,"position")):(k="number"===typeof h.radius?h.radius:Fb(this,b,a.keyframes,"radius",g.tween.easing,"position"),n="number"===typeof h.theta?G.ca(h.theta):G.ca(Fb(this,b,a.keyframes,"theta",g.tween.easing,"position")),h="number"===typeof h.phi?G.ca(h.phi):G.ca(Fb(this,b,a.keyframes,"phi",g.tween.easing,"position")),n=G.Wa(Math.PI-n,-Math.PI,Math.PI),h=(new THREE.Vector3).setFromSpherical(B.De(k,
n,h)),k=h.x,n=h.y,h=h.z),b=new yb(b+d,{position:{x:k,y:n,z:h}}),g.timeline.lb(b));if(0<g.timeline.keyframes.length&&0<g.timeline.keyframes[0].time||0<d)v={position:B.clone(this.ja.position)},b=new yb(0,v),g.timeline.lb(b);this.c.push(g);g=new zb(this.i,this.ja);g.tween.easing=a.easing;g.instruction=this.j[2];g.instruction.smooth=a.smooth;g.onComplete.add(this.Ub,this);g.onProgress.add(this.Me,this);v=0;for(x=a.keyframes.length;v<x;v++)b=a.keyframes[v].time+d,h=a.keyframes[v].data.scale,"undefined"!==
typeof h&&null!==h&&(k="undefined"!==typeof h.x&&null!==h.x?h.x:Fb(this,b,a.keyframes,"x",g.tween.easing,"scale"),n="undefined"!==typeof h.y&&null!==h.y?h.y:Fb(this,b,a.keyframes,"y",g.tween.easing,"scale"),h="undefined"!==typeof h.z&&null!==h.z?h.z:Fb(this,b,a.keyframes,"z",g.tween.easing,"scale"),b=new yb(b+d,{scale:{x:k,y:n,z:h}}),g.timeline.lb(b));if(0<g.timeline.keyframes.length&&0<g.timeline.keyframes[0].time||0<d)v={scale:B.clone(this.ja.scale)},b=new yb(0,v),g.timeline.lb(b);this.c.push(g);
this.c[0].play();this.c[1].play();this.c[2].play()};Object.defineProperty(Xb.prototype,"autoPlay",{get:function(){return this.G}});Object.defineProperty(Xb.prototype,"onProgress",{get:function(){null===this.m&&(this.m=new q(this));return this.m}});function Vb(a){Hb.call(this,"HotspotAnimationTrack");this.j(a)}Vb.prototype=Object.create(Hb.prototype);Vb.prototype.constructor=Vb;var Tb={Ff:"3d"};
function L(a){this.i=a;this.R=null;this.P=this.ba=this.F=this.W=this.M=this.B=this.S=this.V=this.K=0;this.I=Math.PI/2;this.H=this.J=this.N=0;this.f=this.j=this.c=this.o=this.G=this.A=null;this.U=0;this.m=this.u=this.C=null;l.call(this,"Camera");this.A=new THREE.Matrix4;this.G=new THREE.Matrix4;this.o=new THREE.Quaternion;this.u=new jc(this.i,kc.gaze);lc(this);this.j=this.c.clone();this.j.name="CameraLeft";this.j.layers.enable(1);this.j.add(this.u.object);this.f=this.c.clone();this.f.name="CameraRight";
this.f.layers.enable(2)}L.prototype=Object.create(l.prototype);L.prototype.constructor=L;var kc={parallax:0,yaw:{default:0},pitch:{default:0,min:-90,max:90},roll:{default:0},fov:{default:90},gaze:{delay:2E3,cursor:{innerRadius:.02,outerRadius:.04,color:16777215,opacity:.5},progress:{innerRadius:.02,outerRadius:.04,color:16711680,opacity:.5}}};
function lc(a){"undefined"!==typeof a.i.renderer&&(a.c=new THREE.PerspectiveCamera(a.I,a.i.renderer.displayResolution.ratio,.01,2E4),a.c.name="CameraMain",a.c.matrixAutoUpdate=!1)}
function mc(a,b){var d=Math.tan(G.ca(a.upDegrees)),g=Math.tan(G.ca(a.downDegrees)),h=Math.tan(G.ca(a.leftDegrees)),k=Math.tan(G.ca(a.rightDegrees));a=2/(h+k);var h=(h-k)*a*.5,k=2/(d+g),d=(d-g)*k*.5,g=new THREE.Matrix4,n=g.elements;n[0]=a;n[1]=0;n[2]=-h;n[3]=0;n[4]=0;n[5]=k;n[6]=d;n[7]=0;n[8]=0;n[9]=0;n[10]=b.far/(b.near-b.far);n[11]=b.far*b.near/(b.near-b.far);n[12]=0;n[13]=0;n[14]=-1;n[15]=0;g.transpose();return g}
function nc(a){a.A=G.be(a.K,a.B,a.F,!1);a.G=a.A.clone().transpose();a.o=H.lc(a.K,a.B,a.F)}function oc(a){a.A=H.yk(a.o);a.G=a.A.clone().transpose();var b=H.Ce(a.o),d=b.pitch,g=b.roll,h=G.nb;pc(a,b.yaw,h);qc(a,d,h);rc(a,g,h);sc(a,null,h)}function tc(a){null!==a.m&&a.m.D(null,!0)}function pc(a,b,d){if("number"!==typeof b||!0===isNaN(b))return!1;d=d===G.Na||d===G.nb?d:G.nb;b=d===G.Na?G.ca(b):b;b=G.Wa(b,-Math.PI,Math.PI);b=G.X(b,a.V,a.S);d=a.K!==b;a.K=b;return d}
function qc(a,b,d){if("number"!==typeof b||!0===isNaN(b))return!1;d=d===G.Na||d===G.nb?d:G.nb;b=d===G.Na?G.ca(b):b;b=G.Wa(b,-Math.PI,Math.PI);b=G.X(b,a.M,a.W);d=a.B!==b;a.B=b;return d}function rc(a,b,d){if("number"!==typeof b||!0===isNaN(b))return!1;d=d===G.Na||d===G.nb?d:G.nb;b=d===G.Na?G.ca(b):b;b=G.Wa(b,-Math.PI,Math.PI);b=G.X(b,a.ba,a.P);d=a.F!==b;a.F=b;return d}
function sc(a,b,d){if("number"!==typeof b||!0===isNaN(b))return!1;d=d===G.Na||d===G.nb?d:G.nb;b=d===G.Na?G.ca(b):b;b=G.X(b,a.N,a.J);d=a.I!==b;a.I=b;return d}
L.prototype.load=function(a){a=this.R=B.ab(kc,a);this.H=a.parallax;this.U=50*this.H;this.V=G.ca(a.yaw.min);this.S=G.ca(a.yaw.max);pc(this,a.yaw["default"],G.Na);this.M=G.ca(a.pitch.min);this.W=G.ca(a.pitch.max);qc(this,a.pitch["default"],G.Na);this.ba=G.ca(a.roll.min);this.P=G.ca(a.roll.max);rc(this,a.roll["default"],G.Na);"undefined"!==typeof a.fov.min&&(this.N=G.ca(a.fov.min));"undefined"!==typeof a.fov.max&&(this.J=G.ca(a.fov.max));sc(this,a.fov["default"],G.Na);nc(this);tc(this);this.u.load(a.gaze)};
L.prototype.gk=function(a,b,d,g,h,k,n){"number"===typeof h&&h?(a=new uc({easing:{default:n||"LINEAR",start:0},keyframes:[{time:h,data:{yaw:a,pitch:b,roll:d,fov:g}}]}),this.animation.play(a.uid)):(h=G.Na,pc(this,a,h),qc(this,b,h),rc(this,d,h),sc(this,g,h),nc(this),tc(this))};
L.prototype.update=function(){if(null!==this.c){var a=(new THREE.Matrix4).copy(this.G);this.H&&a.multiply((new THREE.Matrix4).makeTranslation(0,0,-this.U));this.c.quaternion.setFromRotationMatrix(a);this.c.matrixWorld=a;this.c.matrixWorldInverse.getInverse(a);this.c.fov=G.$b(this.i.view.je());this.c.aspect=this.i.renderer.displayResolution.ratio;this.c.updateProjectionMatrix()}if(!0===this.i.renderer.display.presentingVR){this.u.update();var b=this.i.renderer.display,a=b.vrFrameData,d=b.Ij();null!==
d&&(this.o=d,oc(this));d=b.vrDisplay.getEyeParameters("left");b=b.vrDisplay.getEyeParameters("right");this.c.matrixWorld.decompose(this.j.position,this.j.quaternion,this.j.scale);this.j.matrixWorld=(new THREE.Matrix4).makeRotationFromQuaternion(this.c.quaternion);this.c.matrixWorld.decompose(this.f.position,this.f.quaternion,this.f.scale);this.f.matrixWorld=(new THREE.Matrix4).makeRotationFromQuaternion(this.c.quaternion);this.j.matrixWorld.elements[12]=this.c.matrixWorld.elements[12]+d.offset[0];
this.j.matrixWorld.elements[13]=this.c.matrixWorld.elements[13]+d.offset[1];this.j.matrixWorld.elements[14]=this.c.matrixWorld.elements[14]+d.offset[2];this.f.matrixWorld.elements[12]=this.c.matrixWorld.elements[12]+b.offset[0];this.f.matrixWorld.elements[13]=this.c.matrixWorld.elements[13]+b.offset[1];this.f.matrixWorld.elements[14]=this.c.matrixWorld.elements[14]+b.offset[2];null!==a?(this.j.projectionMatrix.elements=a.leftProjectionMatrix,this.f.projectionMatrix.elements=a.rightProjectionMatrix):
(this.j.projectionMatrix=mc({upDegrees:d.fieldOfView.upDegrees,downDegrees:d.fieldOfView.downDegrees,leftDegrees:d.fieldOfView.leftDegrees,rightDegrees:d.fieldOfView.rightDegrees},this.c),this.f.projectionMatrix=mc({upDegrees:b.fieldOfView.upDegrees,downDegrees:b.fieldOfView.downDegrees,leftDegrees:b.fieldOfView.leftDegrees,rightDegrees:b.fieldOfView.rightDegrees},this.c));tc(this);a=0;for(b=this.f.children.length;a<b;a++)this.f.remove(this.f.children[a]);b=0;for(d=this.j.children.length;b<d;b++)a=
this.j.children[b].clone(),this.f.add(a)}};L.prototype.destroy=function(){this.c=this.o=this.G=this.A=null;this.u.destroy();this.u=null;null!==this.m&&(this.m.destroy(),this.m=null);null!==this.C&&(this.C.destroy(),this.C=null);this.i=null;l.prototype.destroy.call(this)};Object.defineProperty(L.prototype,"config",{get:function(){return this.R},set:function(a){this.load(a)}});
Object.defineProperty(L.prototype,"yaw",{get:function(){return G.$b(this.K)},set:function(a){!0===pc(this,a,G.Na)&&(nc(this),tc(this))}});Object.defineProperty(L.prototype,"pitch",{get:function(){return G.$b(this.B)},set:function(a){qc(this,a,G.Na)&&(nc(this),tc(this))}});Object.defineProperty(L.prototype,"roll",{get:function(){return G.$b(this.F)},set:function(a){!0===rc(this,a,G.Na)&&(nc(this),tc(this))}});
Object.defineProperty(L.prototype,"fov",{get:function(){return G.$b(this.I)},set:function(a){!0===sc(this,a,G.Na)&&tc(this)}});Object.defineProperty(L.prototype,"fovMin",{get:function(){return G.$b(this.N)},set:function(a){this.N=G.ca(a)}});Object.defineProperty(L.prototype,"fovMax",{get:function(){return G.$b(this.J)},set:function(a){this.J=G.ca(a)}});Object.defineProperty(L.prototype,"quaternion",{get:function(){return this.o},set:function(a){this.o=a;oc(this);tc(this)}});
Object.defineProperty(L.prototype,"animation",{get:function(){null===this.C&&(this.C=new vc(this.i,this));return this.C}});Object.defineProperty(L.prototype,"parallax",{get:function(){return this.H},set:function(a){this.H=G.X(a,0,1);tc(this)}});Object.defineProperty(L.prototype,"modelView",{get:function(){return this.A}});Object.defineProperty(L.prototype,"modelViewInverse",{get:function(){return this.G}});Object.defineProperty(L.prototype,"main",{get:function(){null===this.c&&lc(this);return this.c}});
Object.defineProperty(L.prototype,"perspectiveCameraRadius",{get:function(){return this.U}});Object.defineProperty(L.prototype,"left",{get:function(){return this.j}});Object.defineProperty(L.prototype,"right",{get:function(){return this.f}});Object.defineProperty(L.prototype,"gaze",{get:function(){return this.u}});Object.defineProperty(L.prototype,"onCameraChange",{get:function(){null===this.m&&(this.m=new q(this));return this.m}});function vc(a,b){Eb.call(this,a,b,"CameraAnimation");wc(this)}
vc.prototype=Object.create(Eb.prototype);vc.prototype.constructor=vc;function wc(a){a.j=[{prop:"quaternion",smooth:!0,Dj:function(){!0===this.Ia.cancelRoll&&(this.ja.quaternion=H.cancelRoll(this.ja.quaternion))},cancelRoll:!0},{prop:"fov",smooth:!1}]}
vc.prototype.play=function(a){"string"===typeof a&&(a=p.get(a));Gb(this);var b=new zb(this.i,this.ja);b.tween.easing=a.easing;b.instruction=this.j[0];b.instruction.smooth=a.smooth;b.smooth=a.smooth;b.instruction.cancelRoll=a.cancelRoll;b.onComplete.add(this.Ub,this);this.c.push(b);var d=new zb(this.i,this.ja);d.tween.easing=a.easing;d.instruction=this.j[1];d.instruction.smooth=a.smooth;d.onComplete.add(this.Ub,this);this.c.push(d);var g=a.keyframes;a=a.offset;var h=b.tween.easing;a=a||0;for(var k,
n,v,x,E=0,Cb=g.length;E<Cb;E++)n=g[E].data,k="undefined"!==typeof n.yaw&&null!==n.yaw?n.yaw:Fb(this,g[E].time+a,g,"yaw",h),v="undefined"!==typeof n.pitch&&null!==n.pitch?n.pitch:Fb(this,g[E].time+a,g,"pitch",h),x="undefined"!==typeof n.roll&&null!==n.roll?n.roll:Fb(this,g[E].time+a,g,"roll",h),k=G.ca(k),v=G.ca(v),x=G.ca(x),"undefined"!==typeof k&&null!==k&&"undefined"!==typeof v&&null!==v&&"undefined"!==typeof x&&null!==x&&(k=H.lc(k,v,x),k=new yb(g[E].time+a,{quaternion:k}),this.c[0].timeline.lb(k)),
"undefined"!==typeof n.fov&&null!==n.fov&&(n=n.fov,k=new yb(g[E].time+a,{fov:n}),this.c[1].timeline.lb(k));if(0<g[0].time||0<a)k=new yb(0,{quaternion:B.clone(this.ja.quaternion)}),this.c[0].timeline.lb(k),k=new yb(0,{fov:this.ja.fov}),this.c[1].timeline.lb(k);b.play();d.play()};
function jc(a,b){this.i=a;this.f=b;this.c=null;this.A=!1;this.u=this.m=null;this.o=0;l.call(this,"CameraGaze");this.m=this.i.clock.create(!1);this.c=new THREE.Object3D;this.c.name="CameraGaze";this.c.position.z=-2;xc(this)}jc.prototype=Object.create(l.prototype);e=jc.prototype;e.constructor=jc;function yc(a,b,d,g,h,k){k=k||2*Math.PI;return new THREE.RingBufferGeometry(a||.02,b||.04,d||32,g||1,h||0,k)}
function xc(a){var b=new THREE.MeshBasicMaterial({color:a.f.cursor.color,opacity:a.f.cursor.opacity,transparent:!0}),b=new THREE.Mesh(yc(a.f.cursor.innerRadius,a.f.cursor.outerRadius),b);b.name="cursor";a.c.add(b)}
function zc(a){var b=new THREE.MeshBasicMaterial({color:a.f.progress.color,opacity:a.f.progress.opacity,transparent:!0,side:THREE.DoubleSide}),b=new THREE.Mesh(yc(a.f.progress.innerRadius,a.f.progress.outerRadius,32,1,Math.PI/2,a.o/100*G.si),b);b.name="progress";b.rotateY(Math.PI);a.c.add(b)}function Ac(a,b){for(var d=null,g=0,h=a.c.children.length;g<h;g++)a.c.children[g].name===b&&(d=a.c.children[g]);null!==d&&(a.c.remove(d),d.geometry.dispose(),d.material.dispose())}
e.hn=function(){this.stop();this.i.renderer.pickingManager.click()};e.load=function(a){this.f=a;Ac(this,"progress");Ac(this,"cursor");xc(this);!0===this.A&&this.o&&zc(this)};e.start=function(){this.log("startGazeAnimation");this.A=!0;this.o=0;Ac(this,"progress");zc(this);null!==this.m&&(this.m.stop(),this.u=this.m.add(2E3,this.hn,this),this.m.start())};
e.stop=function(){this.log("stopGazeAnimation");this.A=!1;this.m.stop();this.u=null;this.o=0;var a=this.c.children[1];"undefined"!==typeof a&&null!==a&&(this.c.remove(a),a.geometry.dispose(),a.material.dispose())};e.update=function(){if(!0===this.A&&null!==this.u){var a=100*(this.u.delay-this.m.duration)/this.u.delay;this.log("timer update : "+a+"%");this.o=a;Ac(this,"progress");zc(this)}};
e.destroy=function(){this.stop();null!==this.c&&("undefined"!==typeof this.c.geometry&&null!==this.c.geometry&&this.c.geometry.dispose(),"undefined"!==typeof this.c.material&&null!==this.c.material&&this.c.material.dispose(),this.c=null);this.j=null};Object.defineProperty(jc.prototype,"visible",{get:function(){return this.c.visible},set:function(a){this.c.visible=a}});Object.defineProperty(jc.prototype,"object",{get:function(){return this.c}});var Bc={Za:"pointer",kf:"keyboard"};
function oa(a){this.i=a;this.c=[];this.m=!0;this.f=this.j=null;l.call(this,"ControllerManager")}oa.prototype=Object.create(l.prototype);oa.prototype.constructor=oa;var Cc={enabled:!0,instances:[{uid:"controller-pointer-0",type:Bc.Za,enabled:!0},{uid:"controller-keyboard-0",type:Bc.kf,enabled:!0}]};e=oa.prototype;e.te=function(a){null!==this.j&&this.j.D({controller:a})};e.se=function(a){null!==this.f&&this.f.D({controller:a})};
e.update=function(){if(null!==this.c)for(var a=0,b=this.c.length;a<b;a++)"function"===typeof this.c[a].update&&this.c[a].update()};e.ha=function(a){a="undefined"!==typeof a?a:Cc;this.m="boolean"===typeof a.enabled?a.enabled:!0;if("undefined"!==typeof a.instances)for(var b,d=0,g=a.instances.length;d<g;d++){b=a.instances[d];switch(b.type){case Bc.Za:b=new Dc(this.i,b);break;case Bc.kf:b=new Fc(this.i,b);break;default:b=null}null!==b&&this.c.push(b)}};
e.destroy=function(){for(var a=this.c.length-1;a--;)this.c[a].destroy(),this.c[a]=null;this.c=null;null!==this.j&&(this.j.destroy(),this.j=null);null!==this.f&&(this.f.destroy(),this.f=null);l.prototype.destroy.call(this)};Object.defineProperty(oa.prototype,"all",{get:function(){return this.c}});Object.defineProperty(oa.prototype,"enabled",{get:function(){return this.m},set:function(a){this.m=!!a}});
Object.defineProperty(oa.prototype,"active",{get:function(){for(var a=0,b=this.c.length;a<b;a++)if(!0===this.c[a].active)return!0;return!1}});Object.defineProperty(oa.prototype,"onControlStart",{get:function(){null===this.j&&(this.j=new q(this));return this.j}});Object.defineProperty(oa.prototype,"onControlEnd",{get:function(){null===this.f&&(this.f=new q(this));return this.f}});function Gc(a,b){this.i=a;this.c=null;this.C=this.A=!1;this.f=this.j=null;l.call(this,b||"ControllerBase");this.Lc()}
Gc.prototype=Object.create(l.prototype);e=Gc.prototype;e.constructor=Gc;e.Lc=function(){this.i.canvas.pointer.enabled=!0;this.c=this.i.renderer.camera};e.enable=function(){!0!==this.A&&(this.A=!0)};e.Gb=function(){!1!==this.A&&(this.A=!0)};e.destroy=function(){this.i=this.c=null;null!==this.j&&(this.j.destroy(),this.j=null);null!==this.f&&(this.f.destroy(),this.f=null);l.prototype.destroy.call(this)};
Object.defineProperty(Gc.prototype,"enabled",{get:function(){return this.A},set:function(a){!0===!!a?this.enable():this.Gb()}});Object.defineProperty(Gc.prototype,"active",{get:function(){return this.C}});Object.defineProperty(Gc.prototype,"onControlStart",{get:function(){null===this.j&&(this.j=new q(this));return this.j}});Object.defineProperty(Gc.prototype,"onControlEnd",{get:function(){null===this.f&&(this.f=new q(this));return this.f}});
function Dc(a,b){this.F=b;this.H=this.m=this.G=this.o=null;Gc.call(this,a,"ControllerPointer")}Dc.prototype=Object.create(Gc.prototype);Dc.prototype.constructor=Dc;var Hc={hardness:.6,damping:.15,velocityMax:300,invert:!1},Ic={hardness:5,invert:!1};e=Dc.prototype;
e.Lc=function(){Gc.prototype.Lc.call(this);this.H=new THREE.Vector2;this.m=new THREE.Vector2;this.o=new THREE.Vector2;this.G=new THREE.Vector2;var a=this.F;this.O=a.uid;ba(this);var b=a.options||{};this.u=B.ab(Hc,b.orientation);this.B=B.ab(Ic,b.zoom);this.A="boolean"===typeof a.enabled?a.enabled:!0;!0===this.A&&this.enable()};
e.Zg=function(a){!1!==this.i.controllers.enabled&&(this.i.canvas.pointer.onPanMove.add(this.Ie,this),this.log("_panStartHandler ("+a.data.velocityX.toFixed(2)+", "+a.data.velocityY.toFixed(2)+")"),this.C=!0,this.o=new THREE.Vector2(a.data.center.x,a.data.center.y),this.G.copy(this.o),this.m.set(0,0),null!==this.j&&this.j.D(),this.i.controllers.te(this))};e.Ie=function(a){!1!==this.i.controllers.enabled&&this.G.set(a.data.center.x,a.data.center.y)};
e.Yg=function(){this.i.canvas.pointer.onPanMove.remove(this.Ie,this);this.log("_panEndHandler");this.C=!1;this.m.set(0,0);this.o.set(0,0);this.G.copy(this.o);null!==this.f&&this.f.D();this.i.controllers.se(this)};e.ah=function(a){!1!==this.i.controllers.enabled&&(this.i.canvas.pointer.onPinchMove.add(this.$g,this),this.log("_pinchStartHandler "+a))};e.$g=function(a){!1!==this.i.controllers.enabled&&this.log("_pinchMoveHandler "+a.data.pinch)};
e.Je=function(a){this.i.canvas.pointer.onPinchMove.remove(this.$g,this);this.log("_pinchEndHandler "+a)};e.bh=function(a){if(!1!==this.i.controllers.enabled){a.data.preventDefault();var b=(this.B.invert?1:-1)/this.B.hardness,d=1;if(a.data.deltaMode)switch(a.data.deltaMode){case 1:d=33.3;break;case 2:d=self.innerHeight;break;default:d=1}a.data.deltaY&&(b*=a.data.deltaY*d/5);this.c.fov=this.c.fov-b;this.log("_wheelHandler (fov:"+this.c.fov+")")}};
e.enable=function(){Gc.prototype.enable.call(this);this.i.canvas.pointer.onPanStart.add(this.Zg,this);this.i.canvas.pointer.onPanEnd.add(this.Yg,this);this.i.canvas.pointer.onPinchStart.add(this.ah,this);this.i.canvas.pointer.onPinchEnd.add(this.Je,this);this.i.canvas.pointer.onWheel.add(this.bh,this)};
e.Gb=function(){Gc.prototype.Gb.call(this);this.i.canvas.pointer.onPanStart.remove(this.Zg,this);this.i.canvas.pointer.onPanMove.remove(this.Ie,this);this.i.canvas.pointer.onPanEnd.remove(this.Yg,this);this.i.canvas.pointer.onPinchStart.remove(this.ah,this);this.i.canvas.pointer.onPinchMove.remove(this.Je,this);this.i.canvas.pointer.onPinchEnd.remove(this.Je,this);this.i.canvas.pointer.onWheel.remove(this.bh,this)};
e.update=function(){var a=this.i.renderer.displayResolution,a=1/(this.u.hardness*Math.min(a.width,a.height));this.m.subVectors(this.G,this.o);this.m.length()>this.u.velocityMax&&this.m.setLength(this.u.velocityMax);this.m.multiplyScalar(a);var a=this.u.invert?-1:1,b=a*(this.m.x+this.H.x);.05<Math.abs(b)&&(this.c.yaw+=b);a*=this.m.y+this.H.y;.05<Math.abs(a)&&(this.c.pitch-=a);this.H.add(this.m).multiplyScalar(G.X(1-this.u.damping,0,1))};
function Fc(a,b){this.K=b;this.m=this.H=this.u=this.o=this.B=null;Gc.call(this,a,"ControllerKeyboard")}Fc.prototype=Object.create(Gc.prototype);Fc.prototype.constructor=Fc;var Jc={hardness:.6,damping:.15,velocityMax:300,invert:!1},Kc={hardness:5,invert:!1};e=Fc.prototype;
e.Lc=function(){Gc.prototype.Lc.call(this);this.m=[];this.H=new THREE.Vector2;this.u=new THREE.Vector2;this.B=new THREE.Vector2;this.o=new THREE.Vector2;var a=this.K;this.O=a.uid;ba(this);var b=a.options||{};this.G=B.ab(Jc,b.orientation);this.F=B.ab(Kc,b.zoom);this.A="boolean"===typeof a.enabled?a.enabled:!0;!1!==b["default"]&&(a=new P(this.i,[81,37],this.Vd,this.Xd,this.Wd,[68,39],this,"left"),this.m.push(a),a=new P(this.i,[68,39],this.Vd,this.Xd,this.Wd,[81,37],this,"right"),this.m.push(a),a=new P(this.i,
[90,38],this.Vd,this.Xd,this.Wd,[83,40],this,"up"),this.m.push(a),a=new P(this.i,[83,40],this.Vd,this.Xd,this.Wd,[90,38],this,"down"),this.m.push(a),a=new P(this.i,107,this.$i,this.bj,this.aj,109,this,"plus"),this.m.push(a),a=new P(this.i,109,this.$i,this.bj,this.aj,107,this,"minus"),this.m.push(a));if(!0===Array.isArray(b.bindings))for(var a=0,d=b.bindings.length;a<d;a++){var g=b.bindings[a],h=g.in,k=g.out,n=g.name,g=g.events;!1===B.T(h,"number")&&!1===B.Ga(h,"number")?this.warn("Can't add custom keyboard binding, keys in are invalid!"):
"object"!==typeof g&&null===g?this.warn("Can't add custom keyboard binding, events are invalid!"):(h=new P(this.i,h,g.onDown,g.onUp,g.onHold,k,this,n),this.m.push(h))}!0===this.A&&this.enable()};e.Vd=function(a){if(!1!==this.i.controllers.enabled){this.C=!0;switch(a.name){case "left":case "right":this.u.setX(0);break;case "up":case "down":this.u.setY(0)}null!==this.j&&this.j.D();this.i.controllers.te(this)}};
e.Wd=function(a){if(!1!==this.i.controllers.enabled)switch(a.name){case "left":this.o.setX(this.o.x-5);break;case "right":this.o.setX(this.o.x+5);break;case "up":this.o.setY(this.o.y-5);break;case "down":this.o.setY(this.o.y+5)}};e.Xd=function(a){this.C=!1;switch(a.name){case "left":case "right":this.u.setX(0);this.o.setX(0);break;case "up":case "down":this.u.setY(0),this.o.setY(0)}null!==this.f&&this.f.D();this.i.controllers.se(this)};
e.$i=function(a){!1!==this.i.controllers.enabled&&(this.C=!0,Lc(this,a),null!==this.j&&this.j.D(),this.i.controllers.te(this))};e.aj=function(a){Lc(this,a)};e.bj=function(){this.C=!1;null!==this.f&&this.f.D();this.i.controllers.se(this)};function Lc(a,b){var d=(a.F.invert?1:-1)/a.F.hardness;switch(b.name){case "minus":d*=10;break;case "plus":d*=-10}a.c.fov=a.c.fov-d}e.enable=function(){Gc.prototype.enable.call(this);for(var a,b=0,d=this.m.length;b<d;b++)a=this.m[b],this.i.keyboard.Rf(a)};
e.Gb=function(){Gc.prototype.Gb.call(this);for(var a,b=0,d=this.m.length;b<d;b++)a=this.m[b],this.i.keyboard.ze(a)};
e.update=function(){var a=this.i.renderer.displayResolution,a=1/(this.G.hardness*Math.min(a.width,a.height));this.u.subVectors(this.o,this.B);this.u.length()>this.G.velocityMax&&this.u.setLength(this.G.velocityMax);this.u.multiplyScalar(a);a=this.G.invert?-1:1;this.c.yaw+=a*(this.u.x+this.H.x);this.c.pitch-=a*(this.u.y+this.H.y);this.H.add(this.u).multiplyScalar(G.X(1-this.G.damping,0,1))};
function u(a){this.i=a;this.J=null;this.j=1;this.M=!1;this.U=this.F=this.W=1;this.B=!1;this.R=!0;this.c=null;this.I=!1;this.m=!0;this.f=null;this.N="running";this.A=this.u=this.H=this.G=this.C=this.o=this.K=null;l.call(this,"SoundManager")}u.prototype=Object.create(l.prototype);e=u.prototype;e.constructor=u;
e.boot=function(){this.c=[];if(!0===N.Qg)try{"function"===typeof window.AudioContext?this.f=new window.AudioContext:this.f=new window.webkitAudioContext}catch(a){this.f=null,this.m=!1}!0===N.Sf&&null===this.f&&(this.m=!1,this.I=!0);null!==this.f&&(this.o="undefined"===typeof this.f.createGain?this.f.createGainNode():this.f.createGain(),this.K=this.f.createAnalyser(),this.K.connect(this.o),this.o.gain.value=this.j,this.o.connect(this.f.destination),this.f.listener.setOrientation(0,0,-1,0,1,0));this.i.story.onSceneLoadStart.add(this.Mh,
this)};e.Mh=function(){if("undefined"!==typeof this.i.story.scene.config.audio){var a=B.ab(this.J,this.i.story.scene.config.audio);Mc(this,a)}else Mc(this,this.J);!1===this.R?null!==this.u&&this.u.D():null!==this.A&&this.A.D()};
function Mc(a,b){null!==b&&(a.R="undefined"!==typeof b.enabled?!!b.enabled:!0,a.F="undefined"!==typeof b.volume&&"number"===typeof b.volume.max?G.X(b.volume.max,0,1):1,a.W=!1===a.M?"undefined"!==typeof b.volume&&"number"===typeof b.volume["default"]?G.X(b.volume["default"],0,a.F):1:G.X(a.j,0,a.F))}e.ha=function(a){this.J=a;Mc(this,a);"number"===typeof this.W&&!1===this.M&&(this.j=G.X(this.W,0,1));Nc(this)};
e.update=function(){for(var a=0,b=this.c.length;a<b;a++)this.c[a].update();if(!0===this.m&&null!==this.i.renderer.camera.main){a=new THREE.Vector3;b=this.i.renderer.camera.main.quaternion;a.set(0,0,1);a.applyQuaternion(b);var d=a.clone();a.set(0,1,0);a.applyQuaternion(b);this.f.listener.setOrientation(d.x,d.y,d.z,a.x,a.y,a.z)}};e.add=function(a){-1===Oc(this,a)&&this.c.push(a)};e.remove=function(a){a=Oc(this,a);-1<a&&this.c.splice(a,1)};
function Oc(a,b){if(null===a.c)return-1;for(var d,g=0,h=a.c.length;g<h;g++)if(d=a.c[g],d===b)return g;return-1}e.Uf=function(){if(null!==this.f&&"undefined"!==typeof this.f.suspend&&!0===this.m&&"running"===this.N){for(var a=!0,b=0,d=this.c.length;b<d;b++)if(!0===this.c[b].playing||!0===this.c[b].paused){a=!1;break}!0===a&&(this.N="suspended",this.f.suspend())}};
e.Tf=function(){if(null!==this.f&&"undefined"!==typeof this.f.resume&&!0===this.m&&"suspended"===this.N)for(var a=0,b=this.c.length;a<b;a++)if(!0===this.c[a].playing||!0===this.c[a].paused){this.N="running";this.f.resume();break}};e.bb=function(){!0!==this.B&&(this.B=!0,this.U=this.j,this.j=0,!0===this.m&&(this.U=this.o.gain.value),Nc(this),null!==this.C&&this.C.D())};e.Nh=function(){!1!==this.B&&(this.B=!1,this.j=this.U,Nc(this),null!==this.G&&this.G.D())};
function Nc(a){if(!0===a.m)a.o.gain.value=a.j;else if(!0===a.I)for(var b=0;b<a.c.length;b++)a.c[b].c.data.volume=G.X(a.c[b].C,0,1)*a.j;a.M=!0;null!==a.H&&a.H.D()}
e.destroy=function(){this.i.story.onSceneLoadStart.remove(this.Mh,this);this.J=this.i=null;for(var a=this.c.length;a--;)this.c[a].destroy();this.o=this.K=this.f=this.c=null;null!==this.C&&(this.C.destroy(),this.C=null);null!==this.G&&(this.G.destroy(),this.G=null);null!==this.H&&(this.H.destroy(),this.H=null);null!==this.u&&(this.u.destroy(),this.u=null);null!==this.A&&(this.A.destroy(),this.A=null);l.prototype.destroy.call(this)};Object.defineProperty(u.prototype,"context",{get:function(){return this.f}});
Object.defineProperty(u.prototype,"analyser",{get:function(){return this.K}});Object.defineProperty(u.prototype,"inputNode",{get:function(){return this.K}});Object.defineProperty(u.prototype,"masterGain",{get:function(){return this.o}});Object.defineProperty(u.prototype,"useWebAudio",{get:function(){return this.m},set:function(a){"boolean"===typeof a&&(this.m=a,this.I=!a)}});
Object.defineProperty(u.prototype,"useAudioTag",{get:function(){return this.I},set:function(a){"boolean"===typeof a&&(this.I=a,this.m=!a)}});Object.defineProperty(u.prototype,"enabled",{get:function(){return this.R}});Object.defineProperty(u.prototype,"muted",{get:function(){return this.B},set:function(a){"boolean"===typeof a&&(!0===a?this.bb():this.Nh())}});
Object.defineProperty(u.prototype,"volume",{get:function(){return!0===this.m?this.o.gain.value:this.j},set:function(a){"number"===typeof a&&(a=G.X(a,0,1),this.j=this.F<a?this.F:a,0<this.j&&(this.B=!1),Nc(this))}});Object.defineProperty(u.prototype,"onMute",{get:function(){null===this.C&&(this.C=new q(this));return this.C}});Object.defineProperty(u.prototype,"onUnmute",{get:function(){null===this.G&&(this.G=new q(this));return this.G}});
Object.defineProperty(u.prototype,"onVolumeChange",{get:function(){null===this.H&&(this.H=new q(this));return this.H}});Object.defineProperty(u.prototype,"onDisable",{get:function(){null===this.u&&(this.u=new q(this));return this.u}});Object.defineProperty(u.prototype,"onEnable",{get:function(){null===this.A&&(this.A=new q(this));return this.A}});var Ga={Kl:"stereo",Jl:"3d",af:"ambisonic"};
function M(a,b,d,g){this.i=a;this.ga=b;this.j=d;this.pa=this.C=1;this.ea=!1;this.J=!0;this.$=!1;this.A=this.za=this.F=this.K=this.o=0;this.u=this.N=!1;this.Aa=0;this.B=!1;this.H=this.Ca=this.f=this.m=this.ia=this.c=this.I=null;this.Da=this.qa=this.Ba=0;this.ma=null;this.la=g||!1;this.Fa=[0,1,2,3];this.fa=this.ya=!1;this.sa=this.ra=null;this.wa=!1;this.W=this.V=this.S=this.oa=this.G=this.va=this.na=this.ba=this.U=this.R=this.P=this.M=this.xa=null;l.call(this,"Sound");!0===this.la&&!1===Pc(this)&&(this.log("$_Sound: can't manage ambisonic sound without Google Chrome Omnitone library and WebAudio API."),
this.la=!1);this.O=this.ga;ba(this);!0===this.i.audio.useWebAudio&&(this.f=this.i.audio.context,this.Ca=this.i.audio.inputNode,this.H="undefined"===typeof this.f.createGain?this.f.createGainNode():this.f.createGain(),this.H.gain.value=this.C*this.i.audio.volume,this.H.connect(this.Ca));if(!0===this.i.audio.useAudioTag||!0===Pc(this))!0===this.i.cache.has(A.pb,this.ga)&&this.Ph(this.i.cache.get(A.pb,this.ga)),this.i.audio.onVolumeChange.add(this.Qh,this);this.i.audio.onDisable.add(this.Oh,this);""!==
this.j&&(this.i.load.sound(this.ga,this.j,this.Ph,this,Pc(this)),null!==this.M&&this.M.D());this.i.audio.add(this)}M.prototype=Object.create(l.prototype);e=M.prototype;e.constructor=M;
e.Ph=function(a){this.I=a;this.fa=!0;null!==this.P&&this.P.D();!0===this.i.audio.useWebAudio?(a=this.I)&&!1===this.wa&&(this.ra=this.ui.bind(this),this.sa=this.dm.bind(this),!0===Pc(this)?(this.ma=Omnitone.createFOADecoder(this.f,a.data,{channelMap:this.Fa}),this.ma.initialize().then(this.ra,this.sa)):this.f.decodeAudioData(a.data,this.ra,this.sa)):(Qc(this),this.ui(null))};e.dm=function(){null!==this.I&&(this.I.data=null,this.wa=!1)};
function Qc(a){null!==a.xa&&a.xa.D();null!==a.R&&a.R.D();null!==a.U&&a.U.D()}e.ui=function(a){if(null===this.I)this.log("$_Sound._decodeComplete error, sound file is null");else{a&&(this.I.data=a);this.wa=!0;Qc(this);if(!0===this.i.audio.useAudioTag||!0===Pc(this))this.c=this.i.cache.get(A.pb,this.ga),Rc(this),this.o=0,this.c.data.duration&&(this.o=this.c.data.duration,this.K=Math.ceil(1E3*this.o));!0===this.ya&&this.play(this.A,this.N,!0)}};e.Qh=function(){Rc(this)};
function Rc(a){null===a.c||!0!==a.i.audio.useAudioTag&&!0!==Pc(a)||(a.c.data.volume=G.X(a.C,0,1)*a.i.audio.volume)}e.Oh=function(){!0===this.u?this.pause():!1===this.paused&&this.stop()};function Sc(a){a.A=0;a.ya=!1;a.u=!1;a.B=!1}
function Tc(a,b){null===a.m&&(a.m=a.f.createPanner(),a.m.panningModel="HRTF",a.m.distanceModel="inverse",a.m.refDistance=1,a.m.maxDistance=1E4,a.m.rolloffFactor=1,a.m.coneInnerAngle=360,a.m.coneOuterAngle=0,a.m.coneOuterGain=0,a.m.setOrientation(0,0,0),a.m.setPosition(0,0,0));a.m.setPosition(a.Ba,a.qa,a.Da);!0===b&&(a.c.connect(a.m),a.m.connect(a.H))}function Pc(a){return!0===a.la&&!0===a.i.audio.useWebAudio&&"undefined"!==typeof Omnitone}
e.update=function(){if(!0===this.u&&!1===this.B){var a=this.i.clock.time-this.F;if(a>=this.K){if(this.A=this.K,!0===this.i.audio.useWebAudio||!0===this.i.audio.useAudioTag)this.stop(!0),null!==this.W&&this.W.D(),!0===this.N&&(this.A=0,this.resume())}else this.A=a}null!==this.ma&&!0===this.u&&this.ma.setRotationMatrixFromCamera(this.i.renderer.camera.modelViewInverse)};
e.play=function(a,b,d){if(!1===this.i.audio.enabled||!1===this.J)this.B=this.u=!1;else{this.N=b||this.N;if(!0===this.u)if(!0===d)this.stop();else return;if(!1===this.fa)this.ya=!0;else{if(!0===this.i.audio.useWebAudio&&!1===Pc(this))if(!0===this.wa)null===this.ia&&(this.ia=this.I.data),this.c=this.f.createBufferSource(),this.c.buffer=this.ia,!0===this.$?Tc(this,!0):this.c.connect(this.H),this.o=this.c.buffer.duration,this.K=Math.ceil(1E3*this.o),!isNaN(a)&&a<this.K?this.F=this.i.clock.time-a:(a=0,
this.F=this.i.clock.time),b=G.od(a/1E3),"undefined"===typeof this.c.start?this.c.noteGrainOn(0,b%this.o,this.o):this.c.start(0,b%this.o,this.o),this.u=!0,this.A=a,this.Aa++,null!==this.G&&this.G.D();else{this.log("Sound is not decoded yet");this.ya=!0;return}else if(!0===this.i.audio.useAudioTag||!0===Pc(this))this.o?Infinity===this.o&&(this.c.data.loop=!0):(this.o=this.c.data.duration,this.K=Math.ceil(1E3*this.o)),!isNaN(a)&&this.K&&a<this.K?(this.c.data.currentTime=G.od(a/1E3),this.F=this.i.clock.time-
a):(a=0,this.c.data.currentTime=a,this.F=this.i.clock.time),this.c.data.play(),this.u=!0,this.A=a,this.Aa++,null!==this.G&&this.G.D();this.i.audio.Tf()}}};e.stop=function(a){null!==this.c?(Uc(this,!0),this.F=this.za=this.i.clock.time,this.B=this.u=this.ya=!1,null!==this.oa&&!0===a&&this.oa.D(),this.i.audio.Uf()):!1!==this.fa&&!0===this.wa||Sc(this)};
function Uc(a,b){if(!0===a.i.audio.useWebAudio&&!1===Pc(a)){if("undefined"===typeof a.c.stop)a.c.noteOff(0);else try{a.c.stop(0)}catch(d){}a.c.disconnect(0);!0===b&&(a.A=0)}else if(!0===a.i.audio.useAudioTag||!0===Pc(a))a.c.data.pause(),!0===b&&(a.A=0,a.c.data.currentTime=0)}e.pause=function(){!0===this.u&&null!==this.c?(Uc(this,!1),this.B=!0,this.za=this.i.clock.time,this.u=this.ya=!1,null!==this.S&&this.S.D(),this.i.audio.Uf()):!1!==this.fa&&!0===this.wa||Sc(this)};
e.resume=function(){if(!1!==this.i.audio.enabled&&!1!==this.J)if(!0===this.B||!1===this.u)if(null===this.c)this.play(this.A,this.N,!0);else{this.F=this.i.clock.time-(this.za-this.F);this.A=this.i.clock.time-this.F;var a=G.od(this.A/1E3);if(!0===this.i.audio.useWebAudio&&!1===Pc(this)){this.c=this.f.createBufferSource();this.c.buffer=this.ia;!0===this.$?Tc(this,!0):this.c.connect(this.H);var b=Math.ceil((this.K-this.A)/1E3);"undefined"===typeof this.c.start?this.c.noteGrainOn(0,a%this.o,b):this.c.start(0,
a%this.o,b)}else if(!0===this.i.audio.useAudioTag||!0===Pc(this))this.c.data.currentTime=G.od(a/1E3),this.c.data.play();this.u=!0;this.B=!1;null!==this.V&&this.V.D();this.i.audio.Tf()}else if(!1===this.fa||!1===this.wa)Sc(this),this.ya=!0};
e.bb=function(){!0!==this.ea&&!1!==this.i.audio.enabled&&!1!==this.J&&(this.ea=!0,this.pa=this.C,this.C=0,!0===this.i.audio.useWebAudio&&!1===Pc(this)?this.H.gain.value=this.C:!0!==this.i.audio.useAudioTag&&!0!==Pc(this)||null===this.c||(this.c.data.volume=this.C),null!==this.ba&&this.ba.D())};
e.Rh=function(){!1!==this.ea&&!1!==this.i.audio.enabled&&!1!==this.J&&(this.ea=!1,this.C=this.pa,!0===this.i.audio.useWebAudio&&!1===Pc(this)?this.H.gain.value=this.pa:!0!==this.i.audio.useAudioTag&&!0!==Pc(this)||null===this.c||(this.c.data.volume=this.pa),null!==this.na&&this.na.D())};
e.destroy=function(){this.stop();!0!==this.i.audio.useAudioTag&&!0!==Pc(this)||this.i.audio.onVolumeChange.remove(this.Qh,this);this.i.audio.onDisable.remove(this.Oh,this);this.i.audio.remove(this);this.sa=this.ra=this.m=this.H=this.Ca=this.f=this.ia=this.c=this.I=this.i=null;null!==this.xa&&(this.xa.destroy(),this.xa=null);null!==this.M&&(this.M.destroy(),this.M=null);null!==this.P&&(this.P.destroy(),this.P=null);null!==this.R&&(this.R.destroy(),this.R=null);null!==this.U&&(this.U.destroy(),this.U=
null);null!==this.ba&&(this.ba.destroy(),this.ba=null);null!==this.na&&(this.na.destroy(),this.na=null);null!==this.va&&(this.va.destroy(),this.va=null);null!==this.G&&(this.G.destroy(),this.G=null);null!==this.oa&&(this.oa.destroy(),this.oa=null);null!==this.S&&(this.S.destroy(),this.S=null);null!==this.V&&(this.V.destroy(),this.V=null);null!==this.W&&(this.W.destroy(),this.W=null);l.prototype.destroy.call(this)};
Object.defineProperty(M.prototype,"enabled",{get:function(){return this.J},set:function(a){"boolean"===typeof a&&(this.J=a,!1!==this.J||!0!==this.u&&!0!==this.B||this.stop())}});Object.defineProperty(M.prototype,"currentTime",{get:function(){return this.A},set:function(a){"number"===typeof a&&(this.pause(),this.A=a,!0===this.u&&this.resume())}});Object.defineProperty(M.prototype,"spatialized",{get:function(){return this.$},set:function(a){"boolean"===typeof a&&(this.$=a)}});
Object.defineProperty(M.prototype,"ambisonic",{get:function(){return this.la}});Object.defineProperty(M.prototype,"duration",{get:function(){return this.o}});Object.defineProperty(M.prototype,"muted",{get:function(){return this.ea||this.i.audio.bb},set:function(a){"boolean"===typeof a&&(!0===a?this.bb():this.Rh())}});
Object.defineProperty(M.prototype,"volume",{get:function(){return this.C},set:function(a){"number"===typeof a&&!0!==isNaN(a)&&(a=G.X(a,0,1),a!==this.C&&!1!==this.i.audio.enabled&&!1!==this.J&&(this.C=a,0<this.C&&(this.ea=!1),!0===this.i.audio.useWebAudio&&!1===Pc(this)?this.H.gain.value=a:Rc(this),null!==this.va&&this.va.D()))}});Object.defineProperty(M.prototype,"decoded",{get:function(){return null===this.I?!1:this.wa}});Object.defineProperty(M.prototype,"playCount",{get:function(){return this.Aa}});
Object.defineProperty(M.prototype,"playing",{get:function(){return this.u}});Object.defineProperty(M.prototype,"ready",{get:function(){return this.fa}});Object.defineProperty(M.prototype,"paused",{get:function(){return this.B}});Object.defineProperty(M.prototype,"loop",{get:function(){return this.N},set:function(a){"boolean"===typeof a&&(this.N=a,!0!==this.i.audio.useAudioTag&&!0!==Pc(this)||null===this.c||Infinity!==this.o||(this.c.data.loop=this.N))}});
Object.defineProperty(M.prototype,"x",{get:function(){return this.Ba},set:function(a){"number"===typeof a&&(this.Ba=a,!0===this.i.audio.useWebAudio&&!1===Pc(this)&&null!==this.c&&null!==this.m&&!0===this.$&&Tc(this))}});Object.defineProperty(M.prototype,"y",{get:function(){return this.qa},set:function(a){"number"===typeof a&&(this.qa=a,!0===this.i.audio.useWebAudio&&!1===Pc(this)&&null!==this.c&&null!==this.m&&!0===this.$&&Tc(this))}});
Object.defineProperty(M.prototype,"z",{get:function(){return this.qa},set:function(a){"number"===typeof a&&(this.Da=a,!0===this.i.audio.useWebAudio&&!1===Pc(this)&&null!==this.c&&null!==this.m&&!0===this.$&&Tc(this))}});Object.defineProperty(M.prototype,"onSoundDecode",{get:function(){null===this.xa&&(this.xa=new q(this));return this.xa}});Object.defineProperty(M.prototype,"onLoadStart",{get:function(){null===this.M&&(this.M=new q(this));return this.M}});
Object.defineProperty(M.prototype,"onLoadedData",{get:function(){null===this.P&&(this.P=new q(this));return this.P}});Object.defineProperty(M.prototype,"onCanPlay",{get:function(){null===this.R&&(this.R=new q(this));return this.R}});Object.defineProperty(M.prototype,"onCanPlayThrough",{get:function(){null===this.U&&(this.U=new q(this));return this.U}});Object.defineProperty(M.prototype,"onMute",{get:function(){null===this.ba&&(this.ba=new q(this));return this.ba}});
Object.defineProperty(M.prototype,"onUnmute",{get:function(){null===this.na&&(this.na=new q(this));return this.na}});Object.defineProperty(M.prototype,"onVolumeChange",{get:function(){null===this.va&&(this.va=new q(this));return this.va}});Object.defineProperty(M.prototype,"onPlay",{get:function(){null===this.G&&(this.G=new q(this));return this.G}});Object.defineProperty(M.prototype,"onStop",{get:function(){null===this.oa&&(this.oa=new q(this));return this.oa}});
Object.defineProperty(M.prototype,"onPause",{get:function(){null===this.S&&(this.S=new q(this));return this.S}});Object.defineProperty(M.prototype,"onResume",{get:function(){null===this.V&&(this.V=new q(this));return this.V}});Object.defineProperty(M.prototype,"onEnded",{get:function(){null===this.W&&(this.W=new q(this));return this.W}});
function Q(a,b){this.i=a;this.j=b;this.K=this.c=null;this.f=this.N="";this.I=this.m=1;this.F=this.J=this.B=!0;this.o=this.G=this.u=this.H=this.A=this.C=null;l.call(this,"Playlist");this.O=this.j.uid;ba(this);this.K=new za(this.i,this.j.name);this.c=[];a=this.j;this.B="undefined"!==typeof a.autoPlay?!!a.autoPlay:!0;this.F="undefined"!==typeof a.loop?!!a.loop:!0;this.m="undefined"!==typeof a.volume&&"number"===typeof a.volume.max?G.X(a.volume.max,0,1):1;this.I="undefined"!==typeof a.volume&&"number"===
typeof a.volume["default"]?G.X(a.volume["default"],0,this.m):G.X(1,0,this.m);a=this.j;"undefined"!==typeof a.tracks&&!0===B.Ga(a.tracks,"string")?this.c=a.tracks:this.warn("A playlist has no track in its configuration, or configuration is not valid!");"string"===typeof a["default"]&&""!==a["default"]?this.N=a["default"]:"number"===typeof a["default"]&&0<=a["default"]&&a["default"]<this.c.length?this.N=this.c[a["default"]].uid:this.warn("A playlist has a default track that is not in its tracks array!");
this.f=this.N;null!==this.C&&this.C.D()}Q.prototype=Object.create(l.prototype);e=Q.prototype;e.constructor=Q;e.Zd=function(){0<this.c.length&&this.c.indexOf(this.f)+1===this.c.length&&(!1===this.F||!0===this.track.loop)?this.f=this.c[0]:this.md()};e.el=function(){null!==this.A&&this.A.D()};e.gl=function(){null!==this.H&&this.H.D()};e.dl=function(){null!==this.u&&this.u.D()};e.fl=function(){null!==this.G&&this.G.D()};e.cl=function(){null!==this.o&&this.o.D()};e.hl=function(){return!!this.c.length};
e.play=function(a,b){this.J="undefined"!==typeof b?b:!1;var d;if("string"===typeof a&&p.T(a,"PlaylistTrack"))d=a;else if(B.T(a,"PlaylistTrack"))d=a.uid;else if("number"===typeof a&&0<=a&&a<this.c.length)d=this.c[a];else if(""!==this.f)d=this.f;else if("undefined"===typeof a||""===a)d=this.c[0];if("undefined"!==typeof d){this.stop();this.f=d;if(!0===this.J&&!1===this.B)return this.warn("$_Playlist.play(); autoPlay is disabled"),this.track;this.track.play();!1===this.track.onEnded.has(this.Zd,this)&&
this.track.onEnded.add(this.Zd,this);this.log("$_Playlist.play(); [uid: "+this.f+"]");return this.track}return null};e.stop=function(){null!==this.track&&(this.track.stop(),"undefined"!==typeof this.track.onEnded&&!1===this.track.onEnded.has(this.Zd,this)&&this.track.onEnded.remove(this.Zd,this))};e.pause=function(){null!==this.track&&this.track.pause()};e.resume=function(){null!==this.track&&this.track.resume()};
e.md=function(){var a=-1;0<this.c.length&&(a=this.c.indexOf(this.f)+1,a===this.c.length&&(a=0));this.play(a,this.J);!0===this.paused&&this.pause()};e.ye=function(){var a=-1;0<this.c.length&&(a=this.c.indexOf(this.f)-1,-1===a&&(a=this.c.length-1));this.play(a,this.J);!0===this.paused&&this.pause()};e.destroy=function(){this.stop();this.i=null;this.K.destroy();this.K=null;0<this.c.length&&(this.c.length=0,this.c=null);this.j=null;l.prototype.destroy.call(this)};
Object.defineProperty(Q.prototype,"tracks",{get:function(){return this.c}});Object.defineProperty(Q.prototype,"name",{get:function(){return this.K.value}});Object.defineProperty(Q.prototype,"ready",{get:function(){return null!==this.track?this.track.ready:!1}});Object.defineProperty(Q.prototype,"decoded",{get:function(){return null!==this.track?this.track.decoded:!1}});Object.defineProperty(Q.prototype,"playing",{get:function(){return null!==this.track?this.track.playing:!1}});
Object.defineProperty(Q.prototype,"paused",{get:function(){return null!==this.track?this.track.paused:!1}});Object.defineProperty(Q.prototype,"track",{get:function(){return!0===p.T(this.f,"PlaylistTrack")?p.get(this.f,"PlaylistTrack"):null}});Object.defineProperty(Q.prototype,"loop",{get:function(){return this.F},set:function(a){this.F=!!a}});Object.defineProperty(Q.prototype,"autoPlay",{get:function(){return this.B},set:function(a){this.B=!!a}});
Object.defineProperty(Q.prototype,"volume",{get:function(){return this.I},set:function(a){"number"===typeof a&&(a=G.X(a,0,1),this.I=this.m<a?this.m:a,!0===p.T(this.f,"PlaylistTrack")&&(a=p.get(this.f,"PlaylistTrack"),null!==a&&(a.volume=this.I*this.i.playlists.volume)))}});Object.defineProperty(Q.prototype,"onPlay",{get:function(){null===this.A&&(this.A=new q(this));return this.A}});Object.defineProperty(Q.prototype,"onStop",{get:function(){null===this.H&&(this.H=new q(this));return this.H}});
Object.defineProperty(Q.prototype,"onPause",{get:function(){null===this.u&&(this.u=new q(this));return this.u}});Object.defineProperty(Q.prototype,"onResume",{get:function(){null===this.G&&(this.G=new q(this));return this.G}});Object.defineProperty(Q.prototype,"onEnded",{get:function(){null===this.o&&(this.o=new q(this));return this.o}});Object.defineProperty(Q.prototype,"onReady",{get:function(){null===this.C&&(this.C=new q(this));return this.C}});
function z(a){this.i=a;this.u=this.c=this.K=null;this.f=this.j="";this.I=this.A=1;this.m=!0;this.o=this.N=!1;this.C=this.B=this.G=this.F=this.H=this.J=null;l.call(this,"PlaylistManager")}z.prototype=Object.create(l.prototype);e=z.prototype;e.constructor=z;e.boot=function(){this.c=[];this.u=[];this.i.audio.onEnable.add(this.xi,this);this.i.story.onSceneLoadStart.add(this.sh,this)};
e.xi=function(){!0===this.m&&0<this.c.length&&!0===this.ready&&!0===this.decoded&&!1===this.o&&(!0===this.paused?this.resume():!1===this.playing&&this.play())};
e.sh=function(){if("undefined"!==typeof this.i.story.scene.config.playlists){var a=B.ab(this.K,this.i.story.scene.config.playlists);Vc(this,a);!1===this.o&&(!1===this.m?Wc(this):Xc(this,this.f)||!0===this.playing&&Wc(this))}else Vc(this,this.K),!1===this.o&&this.f!==this.j&&(!1!==this.m&&!1!==this.ready&&!1!==this.decoded&&!0!==this.playing||Wc(this),Xc(this,this.f))};
function Vc(a,b){null!==b&&(a.m="undefined"!==typeof b.enabled?!!b.enabled:!0,"undefined"!==typeof b["default"]&&("string"===typeof b["default"]&&""!==b["default"]?a.f=b["default"]:"number"===typeof b["default"]&&0<=b["default"]&&b["default"]<a.c.length&&(a.f=a.c[b["default"]].uid)),a.A="undefined"!==typeof b.volume&&"number"===typeof b.volume.max?G.X(b.volume.max,0,1):1,a.I="undefined"!==typeof b.volume&&"number"===typeof b.volume["default"]?G.X(b.volume["default"],0,a.A):G.X(1,0,a.A))}
e.ha=function(a){var b;this.K=a;if("undefined"!==typeof a.lists)for(var d=0,g=a.lists.length;d<g;d++)b=new Q(this.i,a.lists[d]),this.add(b);if("undefined"!==typeof a.tracks)for(d=0,g=a.tracks.length;d<g;d++)b=new Yc(this.i,a.tracks[d]),this.th(b),!0===this.N&&this.warn("Preload is not supported yet.");Vc(this,a);"undefined"!==typeof a.lists&&0<a.lists.length&&(""===this.f&&this.warn("The playlist manager has a default playlist that is not in its playlists array!"),this.j=this.f);if(!(0>=this.c.length)){var h;
"string"===typeof this.f&&""!==this.f?h=this.f:h=this.c[0].uid;void 0===p.get(h)&&this.warn('PlaylistManager : uid "'+h+'" is not into playlists');!0===p.T(h,"Playlist")?this.play(h,!0):this.warn("Impossible to play the playlist with uid "+h+", it doesn't seem to be a playlist!")}};
function Xc(a,b){return null!==b&&!0===p.T(b,"Playlist")?(null!==a.playlist&&a.playlist.uid===b?null!==a.playlist.track&&"undefined"!==typeof a.playlist.track.uid&&""!==a.playlist.track.uid?!0===a.paused?a.resume():!1===a.playing&&a.play(b,!0):(a.stop(),a.play(b,!0)):(a.stop(),a.play(b,!0)),!0):!1}function Wc(a){!0===a.playing?a.pause():a.stop()}e.Zk=function(){null!==this.H&&this.H.D();null!==this.playlist&&Q.prototype.el.call(this.playlist)};
e.al=function(){null!==this.F&&this.F.D();null!==this.playlist&&Q.prototype.gl.call(this.playlist)};e.Yk=function(){null!==this.G&&this.G.D();null!==this.playlist&&Q.prototype.dl.call(this.playlist)};e.$k=function(){null!==this.B&&this.B.D();null!==this.playlist&&Q.prototype.fl.call(this.playlist)};e.Xk=function(){null!==this.C&&this.C.D();null!==this.playlist&&Q.prototype.cl.call(this.playlist)};e.add=function(a){this.c.push(a)};e.th=function(a){this.u.push(a)};e.In=function(){return!!this.c.length};
e.bl=function(){return!!this.u.length};e.play=function(a,b){var d;if("string"===typeof a&&p.T(a,"Playlist"))d=a;else if(B.T(a,"Playlist"))d=a.uid;else if("number"===typeof a&&0<=a&&a<this.c.length)d=this.c[a].uid;else if(""!==this.j)d=this.j;else if("undefined"===typeof a||""===a)d=this.c[0].uid;"undefined"!==typeof d&&(!0===this.playing&&this.stop(),this.j=d,!0===this.m&&(this.o=!1,this.playlist.play(null,b),this.log("$_PlaylistManager.play(); [uid: "+this.j+"]")))};
e.stop=function(){null!==this.playlist&&this.playlist.stop()};e.pause=function(){null!==this.playlist&&!0===this.playlist.playing&&(this.o=!0,this.playlist.pause())};e.resume=function(){if(null!==this.playlist&&!0===this.m&&!0===this.playlist.paused){var a=this.o;this.o=!1;!0===a&&this.f!==this.j?Xc(this,this.f):this.playlist.resume()}};e.md=function(){null!==this.playlist&&!0===this.m&&this.playlist.md()};e.ye=function(){null!==this.playlist&&!0===this.m&&this.playlist.ye()};
e.destroy=function(){this.stop();this.i.audio.onEnable.remove(this.xi,this);this.i.story.onSceneLoadStart.remove(this.sh,this);this.K=this.i=null;for(var a=this.c.length;a--;)this.c[a].destroy();this.c=null;for(a=this.u.length;a--;)this.u[a].destroy();this.u=null;l.prototype.destroy.call(this)};Object.defineProperty(z.prototype,"playlists",{get:function(){return this.c}});Object.defineProperty(z.prototype,"tracks",{get:function(){return this.u}});
Object.defineProperty(z.prototype,"playlist",{get:function(){return!0===p.T(this.j,"Playlist")?p.get(this.j,"Playlist"):null}});Object.defineProperty(z.prototype,"loop",{get:function(){return null!==this.playlist?this.playlist.loop:!0}});Object.defineProperty(z.prototype,"autoPlay",{get:function(){return null!==this.playlist?this.playlist.autoPlay:!0}});Object.defineProperty(z.prototype,"preload",{get:function(){return this.N},set:function(a){this.N=!!a}});
Object.defineProperty(z.prototype,"enabled",{get:function(){return this.m}});Object.defineProperty(z.prototype,"ready",{get:function(){return null!==this.playlist?this.playlist.ready:!1}});Object.defineProperty(z.prototype,"decoded",{get:function(){return null!==this.playlist?this.playlist.decoded:!1}});Object.defineProperty(z.prototype,"playing",{get:function(){return null!==this.playlist?this.playlist.playing:!1}});
Object.defineProperty(z.prototype,"paused",{get:function(){return null!==this.playlist?this.playlist.paused:!1}});Object.defineProperty(z.prototype,"volume",{get:function(){return this.I},set:function(a){if("number"===typeof a&&(a=G.X(a,0,1),this.I=this.A<a?this.A:a,!0===p.T(this.j,"Playlist")&&(a=p.get(this.j,"Playlist"),null!==a))){var b=a.track;null!==b&&(b.volume=a.volume*this.I)}}});Object.defineProperty(z.prototype,"onReady",{get:function(){null===this.J&&(this.J=new q(this));return this.J}});
Object.defineProperty(z.prototype,"onPlay",{get:function(){null===this.H&&(this.H=new q(this));return this.H}});Object.defineProperty(z.prototype,"onStop",{get:function(){null===this.F&&(this.F=new q(this));return this.F}});Object.defineProperty(z.prototype,"onPause",{get:function(){null===this.G&&(this.G=new q(this));return this.G}});Object.defineProperty(z.prototype,"onResume",{get:function(){null===this.B&&(this.B=new q(this));return this.B}});
Object.defineProperty(z.prototype,"onEnded",{get:function(){null===this.C&&(this.C=new q(this));return this.C}});function Yc(a,b){this.i=a;this.u=b;this.o=this.m=null;this.j="";this.f=!1;this.c=null;l.call(this,"PlaylistTrack");this.O=this.u.uid;ba(this);a=this.u;da(this);this.O=a.uid;ba(this);this.m=new za(this.i,a.name);this.o=new za(this.i,a.author);this.j=a.url;this.f=a.loop||!1}Yc.prototype=Object.create(l.prototype);e=Yc.prototype;e.constructor=Yc;e.wh=function(){z.prototype.Zk.call(this.i.playlists)};
e.Hi=function(){z.prototype.al.call(this.i.playlists)};e.vh=function(){z.prototype.Yk.call(this.i.playlists)};e.Gi=function(){z.prototype.$k.call(this.i.playlists)};e.uh=function(){z.prototype.Xk.call(this.i.playlists)};
e.play=function(){null===this.c&&(this.c=new M(this.i,this.O+"-sound",this.j),this.c.volume=this.i.playlists.volume*this.i.playlists.playlist.volume,!0===this.f&&(this.c.loop=this.f),this.c.onPlay.add(this.wh,this),this.c.onStop.add(this.Hi,this),this.c.onPause.add(this.vh,this),this.c.onResume.add(this.Gi,this),this.c.onEnded.add(this.uh,this));this.c.play()};e.stop=function(){null!==this.c&&this.c.stop(!0)};e.pause=function(){null!==this.c&&this.c.pause()};e.resume=function(){null!==this.c&&this.c.resume()};
e.destroy=function(){this.u=this.i=null;this.m.destroy();this.m=null;this.o.destroy();this.o=null;null!==this.c&&(this.c.onPlay.remove(this.wh,this),this.c.onStop.remove(this.Hi,this),this.c.onPause.remove(this.vh,this),this.c.onResume.remove(this.Gi,this),this.c.onEnded.remove(this.uh,this),this.c.destroy(),this.c=null);l.prototype.destroy.call(this)};Object.defineProperty(Yc.prototype,"name",{get:function(){return this.m.value}});Object.defineProperty(Yc.prototype,"author",{get:function(){return this.o.value}});
Object.defineProperty(Yc.prototype,"currentTime",{get:function(){return null!==this.c?this.c.currentTime:0},set:function(a){null!==this.c&&(this.c.currentTime=a)}});Object.defineProperty(Yc.prototype,"volume",{get:function(){return null!==this.c?this.c.volume:!1},set:function(a){if(null===this.c)return!1;this.c.volume=a}});Object.defineProperty(Yc.prototype,"ready",{get:function(){return null!==this.c?this.c.ready:!1}});
Object.defineProperty(Yc.prototype,"decoded",{get:function(){return null!==this.c?this.c.decoded:!1}});Object.defineProperty(Yc.prototype,"playing",{get:function(){return null!==this.c?this.c.playing:!1}});Object.defineProperty(Yc.prototype,"paused",{get:function(){return null!==this.c?this.c.paused:!1}});Object.defineProperty(Yc.prototype,"loop",{get:function(){return this.f},set:function(a){this.f=!!a}});Object.defineProperty(Yc.prototype,"onPlay",{get:function(){if(null!==this.c)return this.c.onPlay}});
Object.defineProperty(Yc.prototype,"onStop",{get:function(){if(null!==this.c)return this.c.onStop}});Object.defineProperty(Yc.prototype,"onPause",{get:function(){if(null!==this.c)return this.c.onPause}});Object.defineProperty(Yc.prototype,"onResume",{get:function(){if(null!==this.c)return this.c.onResume}});Object.defineProperty(Yc.prototype,"onEnded",{get:function(){if(null!==this.c)return this.c.onEnded}});
function sa(a){this.i=a;this.j=this.c=null;this.M=this.W=this.P=!1;this.J=-1;this.K=this.o=null;l.call(this,"Director");this.He()}sa.prototype=Object.create(l.prototype);e=sa.prototype;e.constructor=sa;e.He=function(){this.o=this.i.clock.create(!1);this.i.story.onSceneLoadComplete.add(this.Ti,this);this.i.onReady.add(this.dh,this)};e.load=function(a){if(null!==a.tracks&&Array.isArray(a.tracks))for(var b=0,d=a.tracks.length;b<d;b++)new uc(a.tracks[b])};
e.dh=function(){this.i.controllers.onControlStart.add(this.Yc,this);this.i.controllers.onControlEnd.add(this.Xc,this)};
e.Ti=function(){var a=this.i.story.scene;this.stop();Zc(this);this.c=null;this.j=[];"undefined"!==typeof a.config.director&&(a=a.config.director.animation,"undefined"!==typeof a&&null!==a&&!1!==a.enabled&&(this.P="boolean"===typeof a.loop?a.loop:!1,this.W="boolean"===typeof a.random?a.random:!1,this.M="boolean"===typeof a.stoppable?a.stoppable:!1,this.J="number"===typeof a.idleTime?a.idleTime:0,null!==a.tracks&&B.Ga(a.tracks,"string")&&(this.j=!0===this.W?B.nd(a.tracks):a.tracks),this.i.renderer.camera.animation.onComplete.add(this.Ii,
this),"undefined"!==typeof this.i.story.scene.config.media&&this.i.story.scene.config.media.type===Ja.VIDEO&&(this.i.renderer.media.displayObject.onPause.add(this.Yd,this),this.i.renderer.media.displayObject.onWaiting.add(this.Wb,this),this.i.renderer.media.displayObject.onStalled.add(this.Wb,this),this.i.renderer.media.displayObject.onEnded.add(this.yi,this),this.i.renderer.media.displayObject.onCurrentTimeChange.add(this.Xi,this),document.addEventListener(N.Mg,null)),"number"===typeof a.delay&&
(this.K=this.o.add(a.delay,this.Lf,this),this.o.start())))};e.Yd=function(){this.stop();this.i.renderer.media.displayObject.onPause.remove(this.Yd,this);this.i.renderer.media.displayObject.onPlay.add(this.Nf,this);this.i.controllers.onControlStart.remove(this.Yc,this);this.i.controllers.onControlEnd.remove(this.Xc,this)};
e.Nf=function(){null!==this.c&&this.play(this.c);this.i.renderer.media.displayObject.onPause.add(this.Yd,this);this.i.renderer.media.displayObject.onPlay.remove(this.Nf,this);this.i.controllers.onControlStart.add(this.Yc,this);this.i.controllers.onControlEnd.add(this.Xc,this)};
e.Wb=function(){this.stop();this.i.renderer.media.displayObject.onWaiting.remove(this.Wb,this);this.i.renderer.media.displayObject.onStalled.remove(this.Wb,this);this.i.renderer.media.displayObject.onPlaying.add(this.Of,this);this.i.controllers.onControlStart.remove(this.Yc,this);this.i.controllers.onControlEnd.remove(this.Xc,this)};
e.Of=function(){null!==this.c&&this.play(this.c);this.i.renderer.media.displayObject.onPlaying.remove(this.Of,this);this.i.renderer.media.displayObject.onWaiting.add(this.Wb,this);this.i.renderer.media.displayObject.onStalled.add(this.Wb,this);this.i.controllers.onControlStart.add(this.Yc,this);this.i.controllers.onControlEnd.add(this.Xc,this)};e.yi=function(){!0===this.i.renderer.media.displayObject.loop&&this.Ti()};e.Yc=function(){null!==this.c&&!0===this.M&&this.stop();this.o.stop(!0)};
e.Xc=function(){null!==this.K&&this.o.remove(this.K);null!==this.c&&!0===this.M&&(null===this.c&&"number"===typeof this.i.story.scene.config.director.animation.delay?(this.K=this.o.add(this.i.story.scene.config.director.animation.delay,this.Lf,this),this.o.start()):"number"===typeof this.J&&-1<this.J&&(this.K=this.o.add(this.J,this.Lf,this),this.o.start()))};
e.Ii=function(){if(1<this.j.length){var a=this.j.indexOf(this.c)+1;if(a<this.j.length){this.play(a);return}}!0===this.P&&(!0===this.W&&(this.j=B.nd(this.j)),this.play(0))};e.Lf=function(){this.play(this.c);this.o.stop(!0)};
e.Xi=function(a){this.stop();this.c=null;"number"===typeof a?a*=1E3:"number"===typeof a.data?a=1E3*a.data:a=this.i.renderer.media.displayObject.currentTimeMS;var b=0,d,g;g=p.get(this.j[0]);if(g.duration>a)this.c=g.uid;else for(var h=1,k=this.j.length-1;h<k;h++){d=g;g=p.get(this.j[h]);if(d.duration+b<a&&g.duration+d.duration+b>a){this.c=g.uid;break}b+=d.duration}null===this.c?(a=g.keyframes[g.keyframes.length-1].data,this.i.renderer.camera.gk(a.yaw,a.pitch,a.roll,a.fov)):this.i.renderer.camera.animation.play(this.c)};
e.play=function(a){this.stop();this.c=null;this.c="number"===typeof a?this.j[a]:"string"===typeof a?a:this.j[0];this.i.renderer.camera.animation.play(this.c)};e.stop=function(){this.i.renderer.camera.animation.stop()};
function Zc(a){a.i.renderer.camera.animation.onComplete.remove(a.Ii,a);"undefined"!==typeof a.i.story.scene.config.media&&a.i.story.scene.config.media.type===Ja.VIDEO&&(a.i.renderer.media.displayObject.onPlay.remove(a.Nf,a),a.i.renderer.media.displayObject.onPause.remove(a.Yd,a),a.i.renderer.media.displayObject.onWaiting.remove(a.Wb,a),a.i.renderer.media.displayObject.onStalled.remove(a.Wb,a),a.i.renderer.media.displayObject.onPlaying.remove(a.Of,a),a.i.renderer.media.displayObject.onEnded.remove(a.yi,
a),a.i.renderer.media.displayObject.onCurrentTimeChange.remove(a.Xi,a))}e.destroy=function(){Zc(this);this.i.onReady.remove(this.dh,this);this.c=this.j=this.i=null;l.prototype.destroy.call(this)};function uc(a){this.G=this.o=!1;Hb.call(this,"DirectorTrack");this.j(a)}uc.prototype=Object.create(Hb.prototype);uc.prototype.constructor=uc;uc.prototype.j=function(a){this.o=a.smooth;this.G=a.cancelRoll;Hb.prototype.j.call(this,a)};Object.defineProperty(uc.prototype,"smooth",{get:function(){return this.o}});
Object.defineProperty(uc.prototype,"cancelRoll",{get:function(){return this.G}});function ac(a){this.i=a;this.f=[];l.call(this,"ActionEventDispatcher")}ac.prototype=Object.create(l.prototype);ac.prototype.constructor=ac;ac.prototype.c=function(a){if(!0===B.Ga(a,"string")||B.T(a,"string"))this.f=this.f.concat(a)};ac.prototype.D=function(){for(var a=0,b=this.f.length;a<b;a++){var d=this.i.actions.get(this.f[a]);"undefined"!==typeof d&&null!==d&&d.yb()}};ac.prototype.destroy=function(){this.i=null;l.prototype.destroy.call(this)};
function $c(a,b){this.i=a;this.j=b;this.ja="";this.c=this.f=null;l.call(this,"Action");a=this.j;this.O=a.uid;this.ja=a.target;this.f="undefined"!==typeof a.method?a.method:null;this.c="undefined"!==typeof a.property?a.property:null;ba(this)}$c.prototype=Object.create(l.prototype);$c.prototype.constructor=$c;var ad={Cf:"set",Yh:"add",oi:"substract",hi:"multiply",ci:"divide",pi:"toggle"};
function bd(a,b){var d=null;if("undefined"===typeof b)d=window;else{var g=b,h=b;"object"===typeof b&&("string"===typeof b.identifier&&(g=b.identifier),"string"===typeof b.accessor&&(h=b.accessor));b=p.get(g);"undefined"!==typeof b&&null!==b&&(B.T(b,"Plugin")?d=b.instance:d=b);h=h.split(".");b=0;"viewer"===h[0].toLowerCase()&&(d=a.i,b=1);for(g=h.length;b<g;b++)"object"===typeof d[h[b]]&&(d=d[h[b]])}null===d&&a.warn("The target of the action "+a.O+" is invalid.");return d}
$c.prototype.yb=function(){var a=bd(this,this.ja);if(null!==a){if(null!==this.c){var b=this.c;if("undefined"!==typeof a[b.name])switch("undefined"===typeof b.operation&&(b.operation=ad.Cf),b.operation){case ad.Cf:a[b.name]=b.value;break;case ad.Yh:a[b.name]+=b.value;break;case ad.oi:a[b.name]-=b.value;break;case ad.hi:a[b.name]*=b.value;break;case ad.ci:a[b.name]/=b.value;break;case ad.pi:a[b.name]=!a[b.name]}}if(null!==this.f&&(b=this.f,"function"===typeof a[b.name])){var d="undefined"!==typeof b.args?
b.args:null;Array.isArray(d)||(d=[d]);a[b.name].apply(a,d)}}};$c.prototype.destroy=function(){this.i=null;l.prototype.destroy.call(this)};Object.defineProperty($c.prototype,"target",{get:function(){return bd(this,this.ja)}});Object.defineProperty($c.prototype,"count",{get:function(){return 0}});function ra(a){this.i=a;this.c=[];l.call(this,"ActionManager")}ra.prototype=Object.create(l.prototype);ra.prototype.constructor=ra;ra.prototype.get=function(a){return p.get(a,"Action")};
ra.prototype.ha=function(a){var b;if(!0===Array.isArray(a))for(var d=0,g=a.length;d<g;d++)b=new $c(this.i,a[d]),this.c.push(b);else b=new $c(this.i,a),this.c.push(b)};ra.prototype.destroy=function(){if(B.Ga(this.c,"Action"))for(;0<this.c.length;)this.c.pop().destroy()};
function R(a,b,d,g){this.i=a;this.G=b;this.H=d;this.A=this.K=null;this.W=g;this.c=this.j=this.I=this.J=null;this.R=!1;this.B=this.F=this.C=this.f=this.m=null;this.N=this.U=!0;this.u=this.o=null;l.call(this,"Plugin");this.O=this.H.uid;this.Ya=this.H.tags;ba(this);this.B={}}R.prototype=Object.create(l.prototype);e=R.prototype;e.constructor=R;
function cd(a){a.A=B.ab(a.G.defaultConfig,a.H,a.K);a.J=a.A.options||{};a.hb=a.A.data||{};a.I=a.A.actions||{};for(var b in a.j)a.j[b].destroy(),a.j[b]=null;b=a.A.events;a.j={};var d,g;for(g in b)d=new ac(a.i),d.c(b[g]),a.j[g]=d}e.$j=function(){!0===this.G.loaded?dd(this):this.G.onLoadComplete.da(this.hm,this)};e.hm=function(){dd(this)};
function dd(a){a.log("Plugin._instantiatePlugin(); "+a.O);var b=a.H;"string"===typeof b.parent&&(a.m=b.parent);a.U="boolean"===typeof b.keep?b.keep:!0;a.N="boolean"===typeof b.reset?b.reset:!0;null===a.F&&!0===B.Ga(b.scenes,"string")&&(a.F=b.scenes);cd(a);a.c=a.G.Hj(a);a.c.boot.call(a.c);null!==a.o&&a.o.D()}e.Vn=function(){this.R=!0;null!==this.u&&this.u.D()};e.update=function(){null!==this.c&&"function"===typeof this.c.update&&this.c.update.call(this.c)};
e.rk=function(){cd(this);null!==this.c&&("function"===typeof this.c.reset?this.c.reset.call(this.c):this.warn("There is no reset function on plugin "+this.G.uid))};
e.destroy=function(){if(!1!==this.ib){null!==this.c&&(this.c.viewer=null,this.c.plugin=null,this.c.destroy(),this.c=null);null!==this.C&&(this.C.destroy(),this.C=null);null!==this.f&&(this.f.destroy(),this.f=null);null!==this.o&&(this.o.destroy(),this.o=null);null!==this.u&&(this.u.destroy(),this.u=null);for(var a=this.j.length;a--;)this.j[a].destroy();this.B=this.i=this.j=null;l.prototype.destroy.call(this)}};Object.defineProperty(R.prototype,"fullUrl",{get:function(){return this.G.fullUrl}});
Object.defineProperty(R.prototype,"options",{get:function(){return this.J}});Object.defineProperty(R.prototype,"actions",{get:function(){return this.I}});Object.defineProperty(R.prototype,"events",{get:function(){return this.j}});Object.defineProperty(R.prototype,"scenes",{get:function(){return this.F}});Object.defineProperty(R.prototype,"persistentData",{get:function(){return this.B},set:function(a){this.B=a}});Object.defineProperty(R.prototype,"instance",{get:function(){return this.c}});
Object.defineProperty(R.prototype,"instanceReady",{get:function(){return this.R}});Object.defineProperty(R.prototype,"container",{get:function(){if(null===this.f){if("string"===typeof this.m&&""!==this.m){this.m=document.getElementById(this.m);if("undefined"===typeof this.m||null===this.m||!1===ha.ng(this.m))throw"$_Plugin.boot : Plugin parent is invalid";this.f=new t(this.i,null,null,this.m)}else this.f=new t(this.i),this.i.pluginContainer.Xb(this.f),this.f.Ab(!0);this.f.id=this.O;this.f.index=this.W}return this.f}});
Object.defineProperty(R.prototype,"create",{get:function(){null===this.C&&(this.C=new ed(this.i,this));return this.C}});Object.defineProperty(R.prototype,"keep",{get:function(){return this.U}});Object.defineProperty(R.prototype,"reset",{get:function(){return this.N}});Object.defineProperty(R.prototype,"contextualConfig",{get:function(){return this.K},set:function(a){this.K=a}});Object.defineProperty(R.prototype,"instanceConfig",{get:function(){return this.H}});
Object.defineProperty(R.prototype,"config",{get:function(){return this.A}});Object.defineProperty(R.prototype,"onInstanceCreate",{get:function(){null===this.o&&(this.o=new q(this,!0));return this.o}});Object.defineProperty(R.prototype,"onInstanceReady",{get:function(){null===this.u&&(this.u=new q(this,!0));return this.u}});
function fd(a){l.call(this,"PluginEngine");this.i=a;this.C=null;this.o=this.N=this.j=this.J="";this.K=null;this.u="";this.A=null;this.F="";this.m=this.G=this.B=this.H=this.f=null;this.R=0;this.I=!1;this.c=null}fd.prototype=Object.create(l.prototype);fd.prototype.constructor=fd;var gd=["boot","destroy"],hd=["viewer","plugin"];e=fd.prototype;
e.load=function(a){if("undefined"!==typeof a){a=this.C=a;if("undefined"===typeof a.uid)throw"Can't load a plugin engine, missing id in config";this.O=a.uid;ba(this);this.J="string"===typeof a.prefix?a.prefix:this.i.plugins.prefix;if("undefined"===typeof a.url)throw"Can't load a plugin engine, missing url in config";this.j=a.url;this.o=this.J+this.j;this.N="string"===typeof a.manifest?a.manifest:"manifest.json";this.i.load.json(this.O,this.o+this.N,this.sm,this);return!0}return!1};
e.Hj=function(a){for(var b=new this.f,d=0,g=hd.length;d<g;d++)if("undefined"!==typeof b[hd[d]])throw"$_PluginEngine instance validation failed, "+hd[d]+" is reserved";if(null!==this.m)for(d=0,g=this.m.length;d<g;d++)if("function"!==typeof b[this.m[d]])throw"$_PluginEngine instance validation failed, action "+this.m[d]+" is undefined on plugin "+this.F;b.i=this.i;b.Vb=a;return b};
e.sm=function(a){a=this.K=this.i.cache.get(A.JSON,a.key).data;if(this.O!==a.uid)throw"Plugin Engine UID doesn't match with manifest UID";var b=a.viewer,d="0.0.0",g="9.9.9";"undefined"!==typeof b&&("undefined"!==typeof b.min&&(d=b.min),"undefined"!==typeof b.max&&(g=b.max));for(var b=["0","9","0"],d=d.split("."),g=g.split("."),h=0,k=0,n=0,v=Math.max(b.length,d.length,g.length)-1;0<=v;v--)"undefined"!==typeof b[v]&&(h=parseInt(b[v],10)),"undefined"!==typeof d[v]&&(k=parseInt(d[v],10)),"undefined"!==
typeof g[v]&&(n=parseInt(g[v],10));if(!1===(h<k||h>n?!1:!0))this.warn("Version compatibility check for plugin "+a.uid+" failed!"),this.warn(a.viewer);else{var x;a:{b=a.device;if("undefined"!==typeof b)for(x in b)if("undefined"===typeof N[x])this.warn("Unable to check plugin device compatibility for: "+x);else if(N[x]!==b[x]){x=!1;break a}x=!0}if(!1===x)this.warn("Device compatibility check for plugin "+a.uid+" failed!"),this.warn(a.device);else{"undefined"!==typeof a.options&&(this.B=a.options);"undefined"!==
typeof a.data&&(this.hb=a.data);"undefined"!==typeof a.actions&&(this.m=a.actions);"undefined"!==typeof a.events&&(this.G=a.events);this.u=a.name;this.A=a.sources;this.F=a.constructor;x=null;if("undefined"!==typeof a.i18n&&(x=a.i18n,"undefined"!==typeof x.locales))for(b=0,d=x.locales.length;b<d;b++)if(a=x.locales[b],"undefined"!==typeof a.files)for(h=0,k=a.files.length;h<k;h++)g=a.files[h],g.key=this.O+"-"+g.key,g.url=this.o+g.url;this.H=x;a=this.A;x=0;for(b=a.length;x<b;x++)d="http://"===String(a[x]).substring(0,
7)||"https://"===String(a[x]).substring(0,8)?a[x]:this.o+a[x],"css"===Da(d).extension?this.i.load.oj(d,this.Ci,this):this.i.load.Gg(d,this.Ci,this)}}this.log("$_Plugin._manifestLoadComplete();")};
e.Ci=function(){this.R++;if(this.R===this.A.length){var a;a:{a=this.F;if("string"===typeof a&&""!==a){a=a.split(".");for(var b=window,d=0,g=a.length;d<g;d++){if(d===a.length-1&&"function"===typeof b[a[d]]){a=b[a[d]];break a}if("object"===typeof b[a[d]])b=b[a[d]];else break}}a=null}this.f=a;!0===id(this)&&(a=this.H,null!==a&&this.i.i18n.ha(a),this.I=!0,null!==this.c&&this.c.D())}};
function id(a){if(null===a.f||"function"!==typeof a.f)throw"Plugin engine "+a.O+" can't find it's constructor";for(var b=0,d=gd.length;b<d;b++)if("function"!==typeof a.f.prototype[gd[b]])throw"$_PluginEngine engine validation failed, missing required method "+gd[b]+" on plugin engine "+a.u;Object.defineProperty(a.f.prototype,"viewer",{get:function(){return this.i}});Object.defineProperty(a.f.prototype,"plugin",{get:function(){return this.Vb}});return!0}
e.destroy=function(){this.H=this.f=this.A=this.u=this.K=this.C=this.i=null;null!==this.c&&(this.c.destroy(),this.c=null);l.prototype.destroy.call(this)};Object.defineProperty(fd.prototype,"name",{get:function(){return this.u}});Object.defineProperty(fd.prototype,"loaded",{get:function(){return this.I}});Object.defineProperty(fd.prototype,"url",{get:function(){return this.j}});Object.defineProperty(fd.prototype,"fullUrl",{get:function(){return this.o}});
Object.defineProperty(fd.prototype,"options",{get:function(){return this.B}});Object.defineProperty(fd.prototype,"actions",{get:function(){return this.m}});Object.defineProperty(fd.prototype,"events",{get:function(){return this.G}});Object.defineProperty(fd.prototype,"defaultConfig",{get:function(){return{data:this.hb,options:this.B,actions:this.m,events:this.G}}});Object.defineProperty(fd.prototype,"onLoadComplete",{get:function(){null===this.c&&(this.c=new q(this));return this.c}});
function pa(a){l.call(this,"PluginManager");this.i=a;this.m=!0;this.u="";this.f=this.c=this.j=null}pa.prototype=Object.create(l.prototype);e=pa.prototype;e.constructor=pa;
e.il=function(a){a=a.data.uid;for(var b,d=this.c.size;d--;)b=this.c.get(d),(!1===b.keep||null!==b.scenes&&-1===b.scenes.indexOf(a))&&this.remove(b.uid);!0===this.m&&"undefined"!==typeof this.o&&(a=this.o,jd(this,a.engines),kd(this,a.instances),ld(this,a.configurations));!0===this.m&&"undefined"!==typeof this.i.story.scene.config.plugins&&(a=this.i.story.scene.config.plugins,jd(this,a.engines),kd(this,a.instances),ld(this,a.configurations));for(b=this.c.size;b--;)a=this.c.get(b),!0===a.reset&&a.rk()};
function jd(a,b){if("undefined"!==typeof b)for(var d=0,g=b.length;d<g;d++){var h=b[d];if("string"===typeof h.uid&&!1===p.Va(h.uid)){var k=new fd(a.i);a.j.add(k);k.load(h)}}}
function kd(a,b){if("undefined"!==typeof b)for(var d=0,g=b.length;d<g;d++){var h=!1!==b[d].enabled?!0:!1,k=a.de(b[d].uid),n=a.i.story.sceneUid,v=B.Ga(b[d].scenes,"string")?b[d].scenes:[],n=0===v.length||""===n&&0===v.length||-1!==v.indexOf(n);if(!0===h&&null===k&&!0===n){h=a;k=b[d];if("undefined"===typeof k.engine)throw"Can't create plugin instance, engineUid is undefined";a:{for(var v=h,x=k.engine,E=0,Cb=v.j.size;E<Cb;E++)if(n=v.j.get(E),n.uid===x)break a;n=null}if(null===n)throw"Plugin Engine "+
k.engine+" doesn't exist";k=new R(h.i,n,k,"number"===typeof k.index?k.index:h.c.size);k.onInstanceCreate.da(h.Bm,h);h.c.add(k);k.$j()}}}function ld(a,b){if("undefined"!==typeof b)for(var d=0,g=b.length;d<g;d++){var h=!1!==b[d].enabled?!0:!1,k=a.de(b[d].instance),n=null;!0===h&&(n=b[d]);null!==k&&(k.contextualConfig=n)}}e.Bm=function(a){a=a.emitter;null!==this.f&&this.f.D(a)};e.boot=function(){this.j=new md;this.c=new md;this.i.story.onSceneLoadStart.add(this.il,this)};
e.ha=function(a){this.o=a;this.m="boolean"===typeof a.enabled?a.enabled:!0;this.u="string"===typeof a.prefix?a.prefix:"./plugins/"};e.de=function(a){for(var b,d=0,g=this.c.size;d<g;d++)if(b=this.c.get(d),b.uid===a)return b;return null};e.Fj=function(a){a=this.c.get(a);return"undefined"!==typeof a?a:null};e.get=function(a){var b=null;"string"===typeof a?b=this.de(a):"number"===typeof a&&(b=this.Fj(a));return b};e.remove=function(a){a=this.get(a);a.destroy();this.c.remove(a)};
e.update=function(){for(var a,b=0,d=this.c.size;b<d;b++)a=this.c.get(b),a.update()};e.render=function(){};e.destroy=function(){this.i=null;null!==this.f&&(this.f.destroy(),this.f=null);for(var a=0,b=this.j.size;a<b;a++)this.j.get(a).destroy();this.j=null;a=0;for(b=this.c.size;a<b;a++)this.c.get(a).destroy();this.c=null;l.prototype.destroy.call(this)};Object.defineProperty(pa.prototype,"all",{get:function(){return this.c}});Object.defineProperty(pa.prototype,"enabled",{get:function(){return this.m}});
Object.defineProperty(pa.prototype,"prefix",{get:function(){return this.u}});Object.defineProperty(pa.prototype,"onInstanceCreate",{get:function(){null===this.f&&(this.f=new q(this,!0));return this.f}});function ed(a,b){this.i=a;this.Vb=b;this.Z=[];l.call(this,"PluginObjectFactory")}ed.prototype=Object.create(l.prototype);e=ed.prototype;e.constructor=ed;e.kb=function(a){a:{for(var b=this.Z.length,d;b--;)if(d=this.Z[b],d===a.emitter){a=b;break a}a=-1}this.Z.splice(a,1)};
e.eo=function(a){a=new za(this.i,a);a.onDestroy.da(this.kb,this);this.Z.push(a);return a};e.fo=function(a){a=new S(this.i,a);a.onDestroy.da(this.kb,this);this.Z.push(a);return a};e.sound=function(a,b){a=new M(this.i,a,b);a.onDestroy.da(this.kb,this);this.Z.push(a);return a};e.vn=function(a){a=new t(this.i,a);a.onDestroy.da(this.kb,this);this.Z.push(a);return a};e.kl=function(a){a=new T(this.i,a);a.onDestroy.da(this.kb,this);this.Z.push(a);return a};
e.image=function(a,b){var d=a;"string"===typeof a&&(d={key:null,url:a});d.key=this.Vb.uid+"-"+d.key;!1!==b&&(d.url=this.Vb.fullUrl+d.url);a=new I(this.i,d);a.onDestroy.da(this.kb,this);this.Z.push(a);return a};e.bo=function(a,b){a.key=this.Vb.uid+"-"+a.key;!1!==b&&(a.url=this.Vb.fullUrl+a.url,a.frames=this.Vb.fullUrl+a.frames);a=new nd(this.i,a);a.onDestroy.da(this.kb,this);this.Z.push(a);return a};e.jl=function(a){a=new od(this.i,a);a.onDestroy.da(this.kb,this);this.Z.push(a);return a};
e.ml=function(a,b,d,g,h){var k;"undefined"!==typeof d&&d.toLowerCase()===Ma.bf?k=new J(this.i,a,b,g):k=new K(this.i,a,b,g,h);k.onDestroy.da(this.kb,this);this.Z.push(k);return k};e.canvas=function(){var a=new ia(this.i);a.onDestroy.da(this.kb,this);this.Z.push(a);return a};e.ll=function(a){a=new Ab(this.i,a);a.onDestroy.da(this.kb,this);this.i.tween.add(a);this.Z.push(a);return a};e.sj=function(){this.log("destroyAllObjects();");for(var a=this.Z.length;a--;)this.Z[a].destroy()};
e.destroy=function(){this.sj();this.Z=this.Vb=this.i=null;l.prototype.destroy.call(this)};
var N=function(a){a=a();a.prototype=Object.create(null);a.prototype.constructor=a;a.prototype.$l=function(){if(/Playstation Vita/.test(this.aa))this.cb="Playstation Vita",this.Ng=!0;else if(/Xbox/.test(this.aa))this.cb="Xbox",this.Wg=!0;else if(/Kindle/.test(this.aa)||/\bKF[A-Z][A-Z]+/.test(this.aa)||/Silk.*Mobile Safari/.test(this.aa))this.cb="Kindle",this.qg=!0;else if(/Windows Phone/i.test(this.aa)||/IEMobile/i.test(this.aa))this.cb="Windows Phone",this.Ge=!0,/Windows Phone (\d+)/.test(this.aa)&&
(this.Zb=parseInt(RegExp.$1,10));else if(/Android/.test(this.aa))this.cb="Android",this.gj=!0,/Android ([\.\_\d]+)/.test(this.aa)&&(this.Zb=parseInt(RegExp.$1,10));else if(/CrOS/.test(this.aa))this.cb="Chrome OS",this.Wf=!0;else if(/iP[ao]d|iPhone/i.test(this.aa))this.cb="iOS",this.Fc=!0,/OS (\d+)/.test(navigator.appVersion)&&(this.Zb=parseInt(RegExp.$1,10));else if(/(Linux|X11)/.test(this.aa))this.cb="Linux",this.rg=!0;else if(/Mac OS X/.test(this.aa))this.cb="Mac OS X",this.ug=!0,/Mac OS X (10[\.\_\d]+)/.test(this.aa)&&
(this.Zb=parseInt(RegExp.$1,10));else if(/Windows/.test(this.aa)||/WPDesktop/i.test(this.aa))/WPDesktop/i.test(this.aa)?(this.cb="Windows Phone",this.Ge=!0):(this.cb="Windows",this.Vg=!0),/(Windows 10.0|Windows NT 10.0)/.test(this.aa)?this.Zb=10:/(Windows 8.1|Windows NT 6.3)/.test(this.aa)||/(Windows 8|Windows NT 6.2)/.test(this.aa)?this.Zb=8:/(Windows 7|Windows NT 6.1)/.test(this.aa)&&(this.Zb=7)};a.prototype.Rl=function(){this.hd="undefined"!==typeof document.documentMode;this.ae=!1===this.hd&&
!0===!!window.StyleMedia;this.dg="undefined"!==typeof window.InstallTrigger;this.opera=!0===!!window.opr||0<=this.aa.indexOf(" OPR/")||0<=this.aa.indexOf("Opera");this.Dg=0<Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor");this.chrome=!1===this.hd&&!1===this.ae&&!1===this.opera&&(!0===!!window.chrome||0<=this.aa.indexOf("CriOS"));if(this.ae)this.mb="Edge",/Edge\/(\d+)/.test(this.aa)&&(this.$a=this.uj=parseInt(RegExp.$1,10));else if(this.chrome)this.mb="Chrome",/CriOS\/(\d+)/.test(this.aa)?
this.$a=this.Xf=parseInt(RegExp.$1,10):/Chrome\/(\d+)/.test(this.aa)&&(this.$a=this.Xf=parseInt(RegExp.$1,10));else if(this.dg)this.mb="Firefox",/Firefox\D+(\d+)/.test(this.aa)&&(this.$a=this.yj=parseInt(RegExp.$1,10));else if(this.qg)/Silk/.test(this.aa)&&(this.mb="Silk",this.Ig=!0);else if(this.hd)this.mb="Internet Explorer",/MSIE (\d+\.\d+);/.test(this.aa)?this.$a=this.mg=parseInt(RegExp.$1,10):/Trident\/(\d+\.\d+)(.*)rv:(\d+\.\d+)/.test(this.aa)&&(this.$a=this.mg=parseInt(RegExp.$3,10));else if(this.opera)this.mb=
"Opera",/OPR\/(\d+)/.test(this.aa)?this.$a=this.ue=parseInt(RegExp.$1,10):0<=this.aa.indexOf("Opera/")?/Version\/(\d+)/.test(this.aa)&&(this.$a=this.ue=parseInt(RegExp.$1,10)):/Opera (\d+)/.test(this.aa)&&(this.$a=this.ue=parseInt(RegExp.$1,10));else if(this.Dg)this.mb="Safari",/version\/(\d+(\.\d+)?)/i.test(this.aa)&&(this.$a=this.tk=parseInt(RegExp.$1,10));else{var a=this.aa.match(/Android.*AppleWebKit\/([\d.]+)/);a&&537>a[1]&&(this.mb="Android Stock",this.bk=!0,this.$a=this.hj=parseFloat(this.aa.slice(this.aa.indexOf("Android")+
8)))}navigator.j&&(this.Fk=!0);this.qk="CSS1Compat"===document.compatMode?!1:!0};a.prototype.Tl=function(){this.nc=window.devicePixelRatio||1;this.Yj=!0===this.Fc&&-1!==this.aa.toLowerCase().indexOf("iphone");this.Zj=!0===this.Fc&&-1!==this.aa.toLowerCase().indexOf("ipod");this.lg=!0===this.Fc&&-1!==this.aa.toLowerCase().indexOf("ipad");this.sk=2<=this.nc&&!0===this.Fc;this.Vg&&!this.Ge||this.ug||this.rg&&!this.Ig||this.Wf?this.Dc=!0:/Mobi/i.test(this.aa)&&!1===this.lg?this.re=!0:this.Kg=!0;if(/TV/i.test(this.aa)||
!0===this.Ng||!0===this.Wg||this.Dc&&/Windows NT/i.test(this.aa)&&/Touch/i.test(this.aa))this.lk=!0,this.Dc=this.Kg=this.re=!1};a.prototype.bm=function(){var a=document.createElement("video");try{"function"===typeof a.canPlayType&&(a.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,"")&&(this.zg=!0),a.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,"")&&(this.xg=this.hg=!0),a.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,"")&&(this.Ug=!0),a.canPlayType('video/webm; codecs="vp9"').replace(/^no$/,
"")&&(this.Og=!0),a.canPlayType('application/x-mpegURL; codecs="avc1.42E01E"').replace(/^no$/,"")&&(this.kg=!0))}catch(d){}};a.prototype.Pl=function(){this.Sf="undefined"!==typeof window.Audio;this.Qg="undefined"!==typeof window.AudioContext||"undefined"!==typeof window.webkitAudioContext;var a=document.createElement("audio");try{if("function"===typeof a.canPlayType){a.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,"")&&(this.yg=!0);a.canPlayType("audio/mpeg;").replace(/^no$/,"")&&(this.vg=
!0);if(a.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,"")||a.canPlayType("audio/opus;").replace(/^no$/,""))this.ve=!0;a.canPlayType('audio/wav; codecs="1"').replace(/^no$/,"")&&(this.Pg=!0);a.canPlayType("audio/aac;").replace(/^no$/,"")&&(this.Qf=!0);if(a.canPlayType("audio/x-m4a;")||a.canPlayType("audio/m4a;")||a.canPlayType("audio/aac;").replace(/^no$/,""))this.tg=!0;if(a.canPlayType("audio/x-mp4;")||a.canPlayType("audio/mp4;")||a.canPlayType("audio/aac;").replace(/^no$/,""))this.wg=!0;
a.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")&&(this.Sg=this.Tg=!0)}}catch(d){}};a.prototype.Ul=function(){this.Lg="undefined"!==typeof navigator.Lg||"undefined"!==typeof navigator.o||"undefined"!==typeof navigator.c||"undefined"!==typeof navigator.f;this.Vf="function"===typeof navigator.getBattery};a.prototype.Wl=function(){this.canvas="undefined"!==typeof window.CanvasRenderingContext2D;if(!0===this.canvas){this.lj="function"===typeof document.createElement("canvas").getContext("2d").fillText;
var a=document.createElement("canvas").getContext("2d");a.rect(0,0,10,10);a.rect(2,2,6,6);this.mj=!1===a.isPointInPath(5,5,"evenodd")}try{this.localStorage="object"===typeof window.localStorage&&"function"===typeof window.localStorage.getItem}catch(g){this.localStorage=!1}this.ik="function"===typeof window.MediaSource;this.vj="function"===typeof window.HTMLMediaElement&&"function"===typeof window.O&&"function"===typeof window.f&&"function"===typeof navigator.O;this.applicationCache="object"===typeof window.applicationCache;
this.addEventListener="function"===typeof window.addEventListener;this.raf="function"===typeof window.requestAnimationFrame||"function"===typeof window.webkitRequestAnimationFrame||"function"===typeof window.mozRequestAnimationFrame;try{var d=document.createElement("canvas");d.f=!1;this.Rg="function"===typeof d.getContext&&"undefined"!==typeof window.WebGLRenderingContext&&!(!d.getContext("webgl")&&!d.getContext("experimental-webgl"))}catch(g){this.Rg=!1}this.Fe="function"===typeof navigator.getVRDisplays?
!0:!1;this.JSON="object"===typeof window.JSON&&"function"===typeof window.JSON.parse&&"function"===typeof window.JSON.stringify;this.geolocation="object"===typeof navigator.geolocation;this.history="object"===typeof window.history&&"function"===typeof window.history.pushState;this.xk="function"===typeof document.createElementNS&&"function"===typeof document.createElementNS("http://www.w3.org/2000/svg","svg").c;this.contextMenu="undefined"!==typeof document.documentElement.contextMenu&&"function"===
typeof window.HTMLMenuItemElement};a.prototype.Vl=function(){this.dk=/^https/i.test(window.location.protocol);try{this.og=window.self!==window.top}catch(b){this.og=!0}};a.prototype.Zl=function(){this.zk="undefined"!==typeof window.ontouchstart||"undefined"!==typeof window.c&&document instanceof window.c||"number"===typeof navigator.maxTouchPoints&&0<navigator.maxTouchPoints||"number"===typeof navigator.msMaxTouchPoints&&0<navigator.msMaxTouchPoints;if("undefined"!==typeof window.j||"undefined"!==
typeof window.m)this.Ak=!(!MouseEvent.f||!MouseEvent.c);this.Ej="function"===typeof navigator.getGamepads||"function"===typeof navigator.webkitGetGamepads};a.prototype.Xl=function(){for(var a="requestFullscreen requestFullScreen webkitRequestFullscreen webkitRequestFullScreen mozRequestFullScreen mozRequestFullscreen msRequestFullscreen msRequestFullScreen".split(" "),d="cancelFullscreen cancelFullScreen exitFullscreen exitFullScreen webkitCancelFullscreen webkitCancelFullScreen webkitExitFullscreen webkitExitFullScreen mozCancelFullscreen mozCancelFullScreen mozExitFullscreen mozExitFullScreen msCancelFullscreen msCancelFullScreen msExitFullscreen msExitFullScreen".split(" "),
g=document.createElement("div"),h=0,k=a.length;h<k;h++)if(g[a[h]]){this.requestFullscreen=a[h];break}a=0;for(g=d.length;a<g;a++)if(document[d[a]]){this.exitFullscreen=d[a];break}"function"===typeof window.Element&&Element.ALLOW_KEYBOARD_INPUT&&(this.Cj=!0);d=["fullscreenElement","mozFullScreenElement","webkitFullscreenElement","msFullscreenElement"];a=0;for(g=d.length;a<g;a++)if("undefined"!==typeof document[d[a]]){this.fullscreenElement=d[a];break}d=["fullscreenEnabled","mozFullScreenEnabled","webkitFullscreenEnabled",
"msFullscreenEnabled"];a=0;for(g=d.length;a<g;a++)if("undefined"!==typeof document[d[a]]){this.fullscreenEnabled=d[a];break}};a.prototype.Ql=function(){for(var a=["visibilitychange","mozvisibilitychange","webkitvisibilitychange","msvisibilitychange"],d=["hidden","mozHidden","webkitHidden","msHidden"],g=0,h=d.length;g<h;g++)if("undefined"!==typeof document[d[g]]){this.visibilityState=d[g];this.Mg=a[g];break}a=["orientation","mozOrientation","msOrientation"];d=0;for(g=a.length;d<g;d++)if("string"===
typeof screen[a[d]]){this.orientation=a[d];break}this.uk="object"===typeof screen.orientation&&"string"===typeof screen.orientation.type&&"function"===typeof screen.orientation.lock;a=["lockOrientation","mozLockOrientation","msLockOrientation"];d=["unlockOrientation","mozUnlockOrientation","msUnlockOrientation"];g=0;for(h=a.length;g<h;g++)if("function"===typeof screen[a[g]]){this.fk=a[g];this.Bk=d[g];break}this.file="undefined"!==typeof window.File&&"undefined"!==typeof window.FileReader&&"undefined"!==
typeof window.FileList&&"undefined"!==typeof window.Blob;this.xj="undefined"!==typeof window.requestFileSystem||"undefined"!==typeof window.webkitRequestFileSystem;this.pk="undefined"!==typeof document.f||"undefined"!==typeof document.c||"undefined"!==typeof document.O};a.prototype.Sl=function(){var a=document.createElement("a").style;a.cssText="pointer-events:auto";this.cd="auto"===a.pointerEvents;a.cssText="background-color:rgba(150,255,150,.5)";this.rj=-1<(""+a.backgroundColor).indexOf("rgba");
this.qj="undefined"!==typeof a.animationName||"undefined"!==typeof a.webkitAnimationName||"undefined"!==typeof a.m||"undefined"!==typeof a.o;var a=document.createElement("p"),d,g={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};document.body.insertBefore(a,null);for(var h in g)"undefined"!==typeof a.style[h]&&(a.style[h]="translate3d(1px,1px,1px)",d=window.getComputedStyle(a).getPropertyValue(g[h]));document.body.removeChild(a);
this.pj="undefined"!==typeof d&&0<d.length&&"none"!==d};a.prototype.fm=function(a){null!==a.rotationRate&&"undefined"!==typeof a.rotationRate.alpha&&"undefined"!==typeof a.rotationRate.beta&&"undefined"!==typeof a.rotationRate.gamma&&(this.$f=!0);"undefined"!==typeof a.acceleration&&"undefined"!==typeof a.acceleration.x&&"undefined"!==typeof a.acceleration.y&&"undefined"!==typeof a.acceleration.z&&(this.Zf=!0);this.Mi();"function"!==typeof this.Bc&&this.Hf()};a.prototype.gm=function(a){"undefined"!==
typeof a.alpha&&"undefined"!==typeof a.beta&&"undefined"!==typeof a.gamma&&(this.bg=!0);this.Ni();"function"!==typeof this.Ac&&this.Hf()};a.prototype.Mi=function(){window.removeEventListener("devicemotion",this.Ac,!1);this.Ac=null};a.prototype.Ni=function(){window.removeEventListener("deviceorientation",this.Bc,!1);this.Bc=null};a.prototype.Yl=function(){this.Yf="undefined"!==typeof window.DeviceMotionEvent;this.ag="undefined"!==typeof window.DeviceOrientationEvent;window.addEventListener("deviceorientation",
this.Bc,!1);window.addEventListener("devicemotion",this.Ac,!1)};a.prototype.am=function(){var a=document.createElement("div");a.style.width="1in";a.style.height="1in";document.body.appendChild(a);this.tj=a.offsetWidth;document.body.removeChild(a);this.re?(this.Fg=Math.floor(Math.min(window.screen.width,window.screen.height)*this.nc),this.Eg=Math.floor(Math.max(window.screen.width,window.screen.height)*this.nc)):(this.Fg=Math.floor(Math.max(window.screen.width,window.screen.height)*this.nc),this.Eg=
Math.floor(Math.min(window.screen.width,window.screen.height)*this.nc))};a.prototype.Ol=function(){this.aa=navigator.userAgent;this.language=navigator.languages&&navigator.languages[0]||navigator.language||navigator.m||"";this.$l();this.Rl();this.Tl();this.Pl();this.bm();this.Ul();this.Wl();this.Vl();this.Ql();this.Xl();this.Zl();this.Sl();this.Ac=this.fm.bind(this);this.Bc=this.gm.bind(this);this.Yl();this.am();!1===this.Yf&&!1===this.ag&&this.Hf()};a.prototype.Hf=function(){"function"===typeof this.Ac&&
this.Mi();"function"===typeof this.Bc&&this.Ni();!0===this.$f&&!0===this.Zf&&!0===this.bg&&(this.Rj=!0);this.ready=!0;Object.freeze(N)};a.prototype.sn=function(a){return"mp3"===a&&!0===this.vg||"ogg"===a&&(!0===this.yg||!0===this.ve)||"m4a"===a&&!0===this.tg||"mp4"===a&&!0===this.wg||"opus"===a&&!0===this.ve||"wav"===a&&!0===this.Pg||"aac"===a&&!0===this.Qf||"webm"===a&&!0===this.Tg||"weba"===a&&!0===this.Sg?!0:!1};a.prototype.tn=function(a){if("webm"!==a||!0!==this.Ug&&!0!==this.Og)if("mp4"!==a||
!0!==this.xg&&!0!==this.hg){if(("ogg"===a||"ogv"===a)&&!0===this.zg||"mpeg"===a&&!0===this.kg)return!0}else return!0;else return!0;return!1};a.prototype.Qn=function(){return navigator.getBattery().then(function(a){return this.Vf&&!a.charging&&.2>=a.level}.bind(this),function(){return!1})};return new a}(function(){return function(){this.ready=!1;this.cb=this.language=this.aa="";this.Zb=0;this.dg=this.Ge=this.Vg=this.ug=this.rg=this.Fc=this.Wf=this.gj=this.qg=this.Wg=this.Ng=!1;this.yj=0;this.chrome=
!1;this.Xf=0;this.hd=!1;this.mg=0;this.opera=!1;this.ue=0;this.ae=!1;this.uj=0;this.Dg=!1;this.tk=0;this.Ig=!1;this.mb="";this.$a=0;this.bk=this.Fk=!1;this.hj=0;this.qk=!1;this.fullscreenElement=this.exitFullscreen=this.requestFullscreen=this.fullscreenEnabled="";this.lg=this.Zj=this.sk=this.Yj=this.Cj=!1;this.nc=1;this.og=this.dk=this.xk=this.history=this.JSON=this.vj=this.ik=this.contextMenu=this.pk=this.geolocation=this.applicationCache=this.localStorage=this.xj=this.file=this.Fe=this.Rg=this.raf=
this.addEventListener=this.lj=this.mj=this.canvas=this.kg=this.Og=this.Ug=this.xg=this.hg=this.zg=this.Sg=this.Tg=this.Qf=this.wg=this.tg=this.Pg=this.ve=this.vg=this.yg=this.Qg=this.Sf=this.Ak=this.Ej=this.zk=this.lk=this.re=this.Kg=this.Dc=this.Vf=this.Lg=!1;this.Mg=this.visibilityState="";this.bg=this.$f=this.Zf=this.ag=this.Yf=this.Rj=this.qj=this.cd=this.rj=this.pj=!1;this.Bc=this.Ac=null;this.Eg=this.Fg=this.tj=0;this.uk=!1;this.Bk=this.fk=this.orientation="";this.Ol()}});
function la(a){this.i=a;this.m=!1;this.c=null;this.j=!1;this.f=null}e=la.prototype;e.constructor=la;e.boot=function(){for(var a=["ms","moz","webkit","o"],b=0;b<a.length&&!window.requestAnimationFrame;b++)window.requestAnimationFrame=window[a[b]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[a[b]+"CancelAnimationFrame"];this.f=window};
e.start=function(a){this.f="undefined"!==typeof a&&(a===window||a instanceof VRDisplay)?a:window;this.j=!0;"undefined"===typeof this.f.requestAnimationFrame||"timeout"===this.i.config.update?(this.m=!0,this.c=function(){!0===this.j&&(this.i.update(0),this.O=window.setTimeout(this.c.bind(this),1E3/30))},this.O=window.setTimeout(this.c.bind(this),0)):(this.m=!1,this.c=function(a){!0===this.j&&(this.i.update(Math.floor(a)),this.O=this.f.requestAnimationFrame(this.c.bind(this)))},this.O=this.f.requestAnimationFrame(this.c.bind(this)))};
e.stop=function(){this.m?clearTimeout(this.O):(this.f.cancelAnimationFrame(this.O),this.O=null);this.j=!1};e.destroy=function(){this.stop();this.f=this.c=this.i=null};Object.defineProperty(la.prototype,"running",{get:function(){return this.j}});function na(a){this.i=a;this.c=!0;l.call(this,"History")}na.prototype=Object.create(l.prototype);e=na.prototype;e.constructor=na;
e.mh=function(){this.log("_addState");var a=this.i.story.scene,b={viewer:{uid:this.i.uid},scene:{uid:a.uid},locale:this.i.i18n.locale},d=window.history.state;null===d?window.history.replaceState(b,a.name,pd(a)):d.scene.uid!==b.scene.uid&&window.history.pushState(b,a.name,pd(a))};
e.lh=function(){this.log("_updateState");var a=window.history.state,b;null===a?b=!1:(b="undefined"!==typeof a.scene&&"string"===typeof a.scene.uid,b=!0===("undefined"!==typeof a.viewer&&"string"===typeof a.viewer.uid)&&!0===b);b&&(b=p.get(a.scene.uid),a.locale=this.i.i18n.locale,window.history.replaceState(a,b.name,pd(b)))};
function pd(a){for(var b=/(?:#|&)(\w+)=(\w+)/g,d=window.location.hash,g=b.exec(d),h="";null!==g;)"uid"!==g[1]&&(h+="&"+g[1]+"="+g[2]),g=b.exec(d);return"#"+a.slug+"&uid="+a.uid+h}e.Fi=function(a){if(null!==a.state){var b=p.get(a.state.viewer.uid);b.history.log("_onPopStateHandler");b.story.scene=a.state.scene.uid}};
e.ha=function(a){this.c="boolean"===typeof a.enabled?a.enabled:!0;!0===this.c&&(this.i.story.onSceneLoadStart.add(this.mh,this),this.i.i18n.onLocaleChangeComplete.add(this.lh,this),window.addEventListener("popstate",this.Fi,!1))};e.destroy=function(){this.i.story.onSceneLoadStart.remove(this.mh,this);this.i.i18n.onLocaleChangeComplete.remove(this.lh,this);window.removeEventListener("popstate",this.Fi,!1);this.i=null;l.prototype.destroy.call(this)};Object.defineProperty(na.prototype,"enabled",{get:function(){return this.c}});
function q(a,b){this.o=a;this.j=b||!1;this.c=this.m=null;this.f=!0;l.call(this,"EventDispatcher")}q.prototype=Object.create(l.prototype);e=q.prototype;e.constructor=q;
function qd(a,b,d,g,h){if("function"!==typeof b)a.warn("You're trying to add an undefined listener");else if(!0===a.has(b,g))a.warn("You're trying to add a duplicate listener for this context");else{b=new rd(a,b,d,g,h);null===a.c&&(a.c=[]);if(a.c.length){d=a.c.length;do d--;while(a.c[d]&&b.Pf<=a.c[d].Pf);a.c.splice(d+1,0,b)}else a.c.push(b);!0===a.j&&!0===a.f&&null!==a.m&&b.yb(a.m)}}
function sd(a,b,d){if(null===a.c)return-1;"undefined"===typeof d&&(d=null);for(var g,h=0,k=a.c.length;h<k;h++)if(g=a.c[h],g.listener===b&&g.context===d)return h;return-1}e.add=function(a,b,d){qd(this,a,!1,b,d)};e.da=function(a,b,d){qd(this,a,!0,b,d)};e.remove=function(a,b){a=sd(this,a,b);-1!==a&&(this.c[a].destroy(),this.c.splice(a,1))};e.has=function(a,b){return-1!==sd(this,a,b)};
e.D=function(a,b){!0===this.j&&(this.m=void 0===a?null:a);if(!1!==this.f&&null!==this.c)for(var d=this.c.length;d--;)this.c[d].yb(a,b)};e.destroy=function(){if(!1!==this.ib){if(null!==this.c){for(var a=this.c.length;a--;)this.c[a].destroy();this.c=null}this.m=this.o=null;l.prototype.destroy.call(this)}};Object.defineProperty(q.prototype,"emitter",{get:function(){return this.o}});Object.defineProperty(q.prototype,"memorize",{get:function(){return this.j},set:function(a){this.j=!!a}});
Object.defineProperty(q.prototype,"active",{get:function(){return this.f},set:function(a){this.f=!!a}});function td(a,b){this.f=a;this.c=b||null}td.prototype.constructor=td;Object.defineProperty(td.prototype,"emitter",{get:function(){return this.f}});Object.defineProperty(td.prototype,"data",{get:function(){return this.c}});function rd(a,b,d,g,h){this.j=a;this.c=b;this.f=g||null;this.o=d||!1;this.Pf=h||0;this.m=0;this.O=!1}e=rd.prototype;e.constructor=rd;
e.Ai=function(a){this.c.call(this.f,new td(this.j.emitter,a));this.m++;!0===this.o&&this.oh();this.O=!1};e.yb=function(a,b){null!==this.c&&(!0===b&&!1===this.O?(this.O=!0,window.setTimeout(this.Ai.bind(this,a),0)):!0!==b&&this.Ai(a))};e.oh=function(){return this.j.remove(this.c,this.f)};e.destroy=function(){this.f=this.c=this.j=null};Object.defineProperty(rd.prototype,"listener",{get:function(){return this.c}});Object.defineProperty(rd.prototype,"context",{get:function(){return this.f}});
Object.defineProperty(rd.prototype,"priority",{get:function(){return this.Pf}});Object.defineProperty(rd.prototype,"callCount",{get:function(){return this.m}});function ma(a){this.i=a;this.c=null;this.f=-1;this.o="";this.u=!0;this.j=this.m=null;l.call(this,"LocaleManager");this.log("$_LocaleManager._boot();");this.c=new md}ma.prototype=Object.create(l.prototype);e=ma.prototype;e.constructor=ma;
e.ha=function(a){this.u="boolean"===typeof a.enabled?a.enabled:!0;"undefined"!==typeof a.auto&&!0===a.auto&&""!==N.language?this.o=N.language:"string"===typeof a["default"]&&(this.o=a["default"]);if(!1===this.u)this.warn("$_LocaleManager: locale management is deactivated");else if("undefined"!==typeof a.locales){for(var b=!1,d=0,g=a.locales.length;d<g;d++){var h;var k=a.locales[d],n=ud(this,k.uid);-1===n?(h=new vd(this.i),h.f.add(this.rm,this),n=this.c.add(h)-1):h=this.c.get(n);h.ha(k);n===this.f||
this.o.toLowerCase()===k.uid.toLowerCase()?(h.sg(),-1===this.f&&wd(this,n),h=!0):h=!1;!0===h&&(b=!0)}!1===b&&(-1===ud(this,this.o)&&(this.o=a.locales[0].uid),wd(this,ud(this,a.locales[0].uid)))}};function ud(a,b){for(var d,g=0,h=a.c.size;g<h;g++)if(d=a.c.get(g),d.uid.toLowerCase()===b.toLowerCase())return g;return-1}
function wd(a,b){if(0>b||b>=a.c.size)throw"The locale you are trying to set doesn't exist";a.f===b?a.warn("$_LocaleManager: You're trying to set a locale that is already the actual locale"):(a.f=b,null!==a.m&&a.m.D(),a.c.get(a.f).sg())}e.rm=function(){this.log("$_LocaleManager._localeAllFilesLoaded();");null!==this.j&&this.j.D()};
e.Yb=function(a,b){if(-1===this.f)return this.warn("$_LocaleManager: You trying to get a value with no locale selected!"),a;var d=this.c.get(this.f).Yb(a,b),g=ud(this,this.o);this.f!==g&&-1!==g&&d===a&&(d=this.c.get(g).Yb(a,b));return d};e.xb=function(a,b){if(-1===this.f)return!1;var d=this.c.get(this.f).xb(a,b),g=ud(this,this.o);this.f!==g&&-1!==g&&!1===d&&(d=this.c.get(g).xb(a,b));return d};
e.destroy=function(){this.i=null;if(null!==this.c){for(var a=0,b=this.c.size;a<b;a++)this.c.get(a).destroy();this.c=null}null!==this.m&&(this.m.destroy(),this.m=null);null!==this.j&&(this.j.destroy(),this.j=null);l.prototype.destroy.call(this)};Object.defineProperty(ma.prototype,"locale",{get:function(){return-1!==this.f?this.c.get(this.f).uid:""},set:function(a){var b;"number"===typeof a&&a<this.c.size?b=a:"string"===typeof a&&(b=ud(this,a));wd(this,b)}});
Object.defineProperty(ma.prototype,"localeIndex",{get:function(){return this.f},set:function(a){"number"===typeof a&&a<this.c.size&&wd(this,a)}});Object.defineProperty(ma.prototype,"localeObject",{get:function(){return-1!==this.f?this.c.get(this.f):null}});Object.defineProperty(ma.prototype,"locales",{get:function(){for(var a=[],b=0,d=this.c.size;b<d;b++)a.push(this.c.get(b).uid);return a}});
Object.defineProperty(ma.prototype,"onLocaleChangeRequest",{get:function(){null===this.m&&(this.m=new q(this));return this.m}});Object.defineProperty(ma.prototype,"onLocaleChangeComplete",{get:function(){null===this.j&&(this.j=new q(this));return this.j}});function za(a,b,d,g){this.i=a;this.c=b;this.m=d;this.j=g;this.f=null;l.call(this,"LocaleString")}za.prototype=Object.create(l.prototype);za.prototype.constructor=za;za.prototype.destroy=function(){this.i=null;l.prototype.destroy.call(this)};
Object.defineProperty(za.prototype,"key",{get:function(){return this.c},set:function(a){this.c=a}});Object.defineProperty(za.prototype,"jsonKey",{get:function(){return this.m},set:function(a){this.m=a}});Object.defineProperty(za.prototype,"value",{get:function(){if(""===this.i.i18n.locale)return"undefined"!==typeof this.j?this.j:this.c;this.f=this.i.i18n.Yb(this.c,this.m);this.f===this.c&&"undefined"!==typeof this.j&&(this.f=this.j);return this.f}});
Object.defineProperty(za.prototype,"loaded",{get:function(){var a=this.i.i18n.Yb(this.c,this.m);return"undefined"!==typeof a&&a!==this.c}});function vd(a){this.i=a;this.m="";this.f=this.j=this.c=null;l.call(this,"Locale");this.c=new md;this.j=new q(this);this.f=new q(this)}vd.prototype=Object.create(l.prototype);e=vd.prototype;e.constructor=vd;
e.ha=function(a){"string"===typeof a.uid&&(this.O=a.uid);""===this.m&&"string"===typeof a.name&&(this.m=a.name);if("undefined"!==typeof a.files)for(var b,d=0,g=a.files.length;d<g;d++)b=a.files[d],null===xd(this,b.key)&&(b.zb=!1,b.loaded=!1,this.c.add(b));this.log("Locale.addConfig(); number of files : "+this.c.size)};
e.sg=function(){if(!0===yd(this))return this.f.D(),!0;for(var a,b=0,d=this.c.size;b<d;b++)a=this.c.get(b),!1===a.zb&&!1===a.loaded&&!1===a.zb&&!1===a.loaded&&(a.zb=!0,this.i.load.json(a.key,a.url,this.pm,this))};function xd(a,b){for(var d,g=0,h=a.c.size;g<h;g++)if(d=a.c.get(g),d.key===b)return d;return null}e.pm=function(a){a=xd(this,a.key);a.zb=!1;a.loaded=!0;this.log("loadFileComplete(); "+a.key);this.j.D();!0===yd(this)&&this.f.D()};
function yd(a){for(var b,d=0,g=a.c.size;d<g;d++)if(b=a.c.get(d),!1===b.loaded)return!1;return!0}e.Yb=function(a,b){for(var d,g=0,h=this.c.size;g<h;g++)if(d=this.c.get(g),!0===this.i.cache.has(A.JSON,d.key)&&("undefined"===typeof b||b===d.key)&&(d=this.i.cache.get(A.JSON,d.key),"undefined"!==typeof d.data[a]))return d.data[a];"undefined"!==typeof b&&(this.warn("$_Locale: value not found into the specified JSON file, try to find it in all files."),this.Yb(a));return a};
e.xb=function(a,b){for(var d,g=0,h=this.c.size;g<h;g++)if(d=this.c.get(g),!0===this.i.cache.has(A.JSON,d.key)&&("undefined"===typeof b||b===d.key)&&(d=this.i.cache.get(A.JSON,d.key),"undefined"!==typeof d.data[a]))return!0;"undefined"!==typeof b&&(this.warn("$_Locale: key not found into the specified JSON file, try to find it in all files."),this.xb(a));return!1};
e.ph=function(a,b){for(var d,g=0,h=this.c.size;g<h;g++)if(d=this.c.get(g),!0===this.i.cache.has(A.JSON,d.key)&&("undefined"===typeof b||b===d.key)){d=this.i.cache.get(A.JSON,d.key);for(var k in d.data)if(d.data[k]===a)return k}"undefined"!==typeof b&&(this.warn("$_Locale: value not found into the specified JSON file, try to find it in all files."),this.ph(a))};e.destroy=function(){this.c=this.i=null;this.j.destroy();this.j=null;this.f.destroy();this.f=null;l.prototype.destroy.call(this)};
Object.defineProperty(vd.prototype,"name",{get:function(){return this.m}});function ua(a){this.i=a;this.j=!0;this.o=this.m=this.f=this.c=null;l.call(this,"Keyboard");this.c=[];this.f=[];this.m=this.mm.bind(this);this.o=this.nm.bind(this);window.addEventListener("keydown",this.m,!1);window.addEventListener("keyup",this.o,!1)}ua.prototype=Object.create(l.prototype);e=ua.prototype;e.constructor=ua;
e.mm=function(a){if(!1!==this.j){var b=a.keyCode;this.log("keyDown "+b);-1===this.f.indexOf(b)?(this.f.push(b),b=!0):b=!1;!0===b&&zd(this,a)}};
e.nm=function(a){if(!1!==this.j){var b=a.keyCode;this.log("keyUp "+b);b=this.f.indexOf(b);-1!==b?(this.f.splice(b,1),b=!0):b=!1;if(!0===b)a:if(b=a.keyCode,!0!==this.pg(b))for(var b=this.fg(b),d,g=0,h=b.length;g<h;g++){d=b[g];for(var k=0,n=this.f.length;k<n;k++)if(d.ke(this.f[k]))break a;d.Ck(a);k=0;for(n=this.f.length;k<n;k++)if(d.ig(this.f[k])){var v=new KeyboardEvent("keydown",{po:this.f[k],ctrlKey:a.ctrlKey,shiftKey:a.shiftKey,altKey:a.altKey});zd(this,v)}}}};
function Ad(a,b){if(null===a.c||!a.c.length)return-1;if("object"===typeof b&&"KeyBinding"===b.type)return a.c.indexOf(b);if("number"===typeof b)for(var d=0,g=a.c.length;d<g;d++)if(!0===a.c[d].ke(b))return d;return-1}function zd(a,b){var d=b.keyCode;if(!0!==a.pg(d)){a=a.fg(d);for(var g=0,h=a.length;g<h;g++)d=a[g],!1===d.pressed&&d.nh(b)}}e.update=function(){for(var a,b=0,d=this.c.length;b<d;b++)if(a=this.c[b],!0===a.pressed){if(!0===a.hasToWaitToHold&&!1===a.downComplete)break;a.Xj()}};
e.Pn=function(a){return-1!==this.f.indexOf(a)};e.pg=function(a){for(var b,d=0,g=this.c.length;d<g;d++)if(b=this.c[d],!0===b.pressed&&!0===b.ig(a))return!0;return!1};e.Rf=function(a){if("object"!==typeof a&&"KeyBinding"!==a.type)return!1;if(-1===Ad(this,a))return this.c.push(a),!0;this.warn("Trying to add a duplicate key binding on keyboard!");return!1};e.ze=function(a){a=Ad(this,a);return-1!==a?(this.c[a].destroy(),this.c.splice(a,1),!0):!1};e.Fn=function(a){return-1!==Ad(this,a)};
e.fg=function(a){for(var b=[],d=0,g=this.c.length;d<g;d++)!0===this.c[d].ke(a)&&b.push(this.c[d]);return b};e.destroy=function(){this.i=null;window.removeEventListener("keydown",this.m,!1);window.removeEventListener("keyup",this.o,!1);for(var a=this.c.length;a--;)this.ze(this.c[a]);this.o=this.m=this.c=null;l.prototype.destroy.call(this)};Object.defineProperty(ua.prototype,"enabled",{get:function(){return this.j},set:function(a){this.j=!!a}});
function P(a,b,d,g,h,k,n,v){this.i=a;this.G=b||[];this.o=d||null;this.C=g||null;this.u=h||null;this.A=k||null;this.f=n||this;this.I=v||"";this.Jf=this.H=this.K=!1;this.F=this.B=this.Zc=0;this.m=this.j=this.c=null;l.call(this,"KeyBinding");if(!0===B.T(this.o,"string")||B.Ga(this.o,"string"))this.c=new ac(this.i),this.c.c(this.o);if(!0===B.T(this.u,"string")||B.Ga(this.u,"string"))this.j=new ac(this.i),this.j.c(this.u);if(!0===B.T(this.C,"string")||B.Ga(this.C,"string"))this.m=new ac(this.i),this.m.c(this.C)}
P.prototype=Object.create(l.prototype);e=P.prototype;e.constructor=P;e.ke=function(a){return"number"===typeof this.G&&this.G===a?!0:"function"===typeof this.G.indexOf?-1!==this.G.indexOf(a):!1};e.ig=function(a){if(null!==this.A){if("number"===typeof this.A&&this.A===a)return!0;if("function"===typeof this.A.indexOf)return-1!==this.A.indexOf(a)}return!1};e.nh=function(a){this.log("down");this.Zc++;this.H=!0;"function"===typeof this.o?this.o.call(this.f,this,a):null!==this.c&&this.c.D()};
e.ko=function(){this.K=!0;var a=this.Zc;return function(){this.log("downCompleteCallback "+a+" "+this.Zc);a===this.Zc&&(this.Jf=!0)}.bind(this)};e.Ck=function(a){this.log("up");this.F++;this.Jf=this.H=!1;"function"===typeof this.C?this.C.call(this.f,this,a):null!==this.m&&this.m.D()};e.Xj=function(){this.log("hold");this.B++;"function"===typeof this.u?this.u.call(this.f,this):null!==this.j&&this.j.D()};
e.destroy=function(){this.f=this.A=this.u=this.C=this.o=this.G=null;null!==this.c&&(this.c.destroy(),this.c=null);null!==this.j&&(this.j.destroy(),this.j=null);null!==this.m&&(this.m.destroy(),this.m=null);l.prototype.destroy.call(this)};Object.defineProperty(P.prototype,"name",{get:function(){return this.I}});Object.defineProperty(P.prototype,"pressed",{get:function(){return this.H}});Object.defineProperty(P.prototype,"downCount",{get:function(){return this.Zc}});
Object.defineProperty(P.prototype,"upCount",{get:function(){return this.F}});Object.defineProperty(P.prototype,"holdCount",{get:function(){return this.B}});Object.defineProperty(P.prototype,"hasToWaitToHold",{get:function(){return this.K}});Object.defineProperty(P.prototype,"downComplete",{get:function(){return this.Jf}});
function Bd(a){this.f=this.L=a;this.J=!1;this.c=null;this.j="";this.G=this.I=null;this.K=this.B=this.H=!1;this.m=null;this.R=200;this.F=this.N=1;this.U=Cd.LINEAR;this.C=this.u=this.A=this.o=null;l.call(this,"Drag");this.F=this.L.alpha}Bd.prototype=Object.create(l.prototype);e=Bd.prototype;e.constructor=Bd;
function Dd(a,b){null!==a.f&&(null!==a.f&&(a.f.pointer.onPanStart.remove(a.jh,a),a.f.pointer.onPanMove.remove(a.ih,a),a.f.pointer.onPanEnd.remove(a.hh,a)),a.f=null);a.f=b;a.f.pointer.enabled=!0;a.f.pointer.onPanStart.add(a.jh,a);a.f.pointer.onPanMove.add(a.ih,a);a.f.pointer.onPanEnd.add(a.hh,a)}
e.jh=function(a){this.log("_panStartHandler");var b=a.data;a=a.data.srcEvent;"undefined"!==typeof a.touches&&"object"===typeof a.touches[0]&&(a=a.touches[0]);if(b=!0!==this.K&&b.target===this.f.dom){if(null===this.c)b=!0;else var b=this.L.globalOffset,d=this.c.globalOffset,g=b.left+this.L.pixelWidth>d.left+this.c.innerWidth,h=b.top<d.top,k=b.top+this.L.pixelHeight>d.top+this.c.innerHeight,b=!0===b.left<d.left||!0===g||!0===h||!0===k?!1:!0;b=!1!==b}b&&(this.H=!0,this.I={x:this.L.x,y:this.L.y},this.L.top=
null,this.L.right=null,this.L.bottom=null,this.L.left=null,this.G={x:a.pageX,y:a.pageY},this.N=this.L.alpha,this.L.alpha=this.F,null!==this.o&&this.o.D())};e.hh=function(){this.log("_panEndHandler");!0===this.H&&(this.H=!1,null!==this.u&&this.u.D(),!0===this.B&&null!==this.m?(this.K=!0,this.m.$e({x:this.I.x,y:this.I.y},this.R,this.U).start()):this.L.alpha=this.N,this.G=this.I=null)};
e.ih=function(a){this.log("_panMoveHandler");if(!0===this.H){a=a.data.srcEvent;"undefined"!==typeof a.touches&&"object"===typeof a.touches[0]&&(a=a.touches[0]);var b={x:a.pageX,y:a.pageY};a=b.x-this.G.x;var d=b.y-this.G.y;this.G=b;if(null!==this.c){var b=this.L.globalOffset,g=this.L.parent.globalOffset,h=this.c.globalOffset;if(""===this.j||"x"===this.j)b.left+a<h.left?(this.log("out left"),this.L.x=Math.abs(g.left-h.left)):b.left+a+this.L.pixelWidth>h.left+this.c.innerWidth?(this.log("out right"),
this.L.x=Math.abs(g.left-h.left)+this.c.innerWidth-this.L.pixelWidth):this.L.x+=a;if(""===this.j||"y"===this.j)b.top+d<h.top?(this.log("out top"),this.L.y=Math.abs(g.top-h.top)):b.top+d+this.L.pixelHeight>h.top+this.c.innerHeight?(this.log("out bottom"),this.L.y=Math.abs(g.top-h.top)+this.c.innerHeight-this.L.pixelHeight):this.L.y+=d}else{if(""===this.j||"x"===this.j)this.L.x+=a;if(""===this.j||"y"===this.j)this.L.y+=d}null!==this.A&&this.A.D()}};
e.Pi=function(){this.log("_revertCompleteHandler");this.K=!1;this.L.alpha=this.N;null!==this.C&&this.C.D()};e.enable=function(){this.J=!0;Dd(this,this.f)};e.kh=function(){this.J=!1};e.destroy=function(){this.revert=!1;null!==this.o&&(this.o.destroy(),this.o=null);null!==this.A&&(this.A.destroy(),this.A=null);null!==this.u&&(this.u.destroy(),this.u=null);null!==this.C&&(this.C.destroy(),this.C=null);this.G=this.c=this.L=this.f=null;l.prototype.destroy.call(this)};
Object.defineProperty(Bd.prototype,"enabled",{get:function(){return this.J},set:function(a){!0===!!a?this.enable():this.kh()}});Object.defineProperty(Bd.prototype,"dragging",{get:function(){return this.H}});Object.defineProperty(Bd.prototype,"handle",{get:function(){return this.f},set:function(a){Dd(this,a)}});Object.defineProperty(Bd.prototype,"constrain",{get:function(){return this.c},set:function(a){this.c=a}});
Object.defineProperty(Bd.prototype,"progress",{get:function(){if(null!==this.c){var a=this.L.globalOffset,b=this.c.globalOffset;return{x:(a.left-b.left)/(this.c.innerWidth-this.L.pixelWidth),y:(a.top-b.top)/(this.c.innerHeight-this.L.pixelHeight)}}}});Object.defineProperty(Bd.prototype,"axis",{get:function(){return this.j},set:function(a){"x"===a||"y"===a?this.j=a:this.j=""}});Object.defineProperty(Bd.prototype,"alpha",{get:function(){return this.F},set:function(a){"number"===typeof a&&(this.F=a)}});
Object.defineProperty(Bd.prototype,"reverting",{get:function(){return this.K}});Object.defineProperty(Bd.prototype,"revert",{get:function(){return this.B},set:function(a){this.B=!!a;!0===this.B&&null===this.m?(this.m=new Ab(this.L.viewer,this.L),this.m.onComplete.add(this.Pi,this),this.L.viewer.tween.add(this.m)):!1===this.B&&null!==this.m&&(this.L.viewer.tween.remove(this.m),this.m.onComplete.remove(this.Pi,this),this.m.destroy(),this.m=null)}});
Object.defineProperty(Bd.prototype,"revertDuration",{get:function(){return this.R},set:function(a){"number"===typeof a&&(this.R=a)}});Object.defineProperty(Bd.prototype,"revertEasing",{get:function(){return this.U},set:function(a){"function"===typeof a&&(this.U=a)}});Object.defineProperty(Bd.prototype,"onStart",{get:function(){null===this.o&&(this.o=new q(this.L));return this.o}});Object.defineProperty(Bd.prototype,"onDrag",{get:function(){null===this.A&&(this.A=new q(this.L));return this.A}});
Object.defineProperty(Bd.prototype,"onStop",{get:function(){null===this.u&&(this.u=new q(this.L));return this.u}});Object.defineProperty(Bd.prototype,"onRevert",{get:function(){null===this.C&&(this.C=new q(this.L));return this.C}});
function U(a){this.L=a;this.c=!1;this.$=Ed.DEFAULT;this.Ua=null;this.rd=[];this.P=this.f=this.j=this.m=this.A=this.u=this.W=this.N=this.R=this.U=this.B=this.F=this.K=this.C=this.G=this.H=this.I=this.J=this.o=this.M=this.ba=this.S=this.ya=this.xa=this.na=this.oa=this.wa=this.va=this.V=null;l.call(this,"Pointer");this.Ua=new Hammer.Manager(this.L.dom);this.Ua.set({enable:!1})}U.prototype=Object.create(l.prototype);e=U.prototype;e.constructor=U;
function Fd(a,b,d,g){for(var h,k=0,n=a.rd.length;k<n;k++)if(h=a.rd[k],h.event===b&&h.rn===d&&h.type===g)return k;return-1}function Gd(a,b,d,g){if(-1===Fd(a,b,d,g))if(a.rd.push({event:b,rn:d,type:g}),g===V.Ra)a.L.dom.addEventListener(b,Hammer.bindFn(d,a));else if(g===V.ka)a.Ua.on(b,Hammer.bindFn(d,a))}function Hd(a,b,d){return function(){var g=Fd(this,a,b,d);-1!==g&&(this.rd.splice(g,1),d===V.Ra?this.L.dom.removeEventListener(a,b):d===V.ka&&this.Ua.off(a))}}
e.Yi=function(a){null!==this.M&&!0===this.c&&this.M.D(a)};e.wi=function(a){null!==this.o&&!0===this.c&&this.o.D(a)};e.Eh=function(a){null!==this.J&&!0===this.c&&this.J.D(a)};e.Dh=function(a){null!==this.I&&!0===this.c&&this.I.D(a)};e.zh=function(a){null!==this.H&&!0===this.c&&this.H.D(a)};e.yh=function(a){null!==this.G&&!0===this.c&&this.G.D(a)};e.xh=function(a){null!==this.C&&!0===this.c&&this.C.D(a)};e.Ch=function(a){null!==this.K&&!0===this.c&&this.K.D(a)};
e.Bh=function(a){null!==this.F&&!0===this.c&&this.F.D(a)};e.Ah=function(a){null!==this.B&&!0===this.c&&this.B.D(a)};e.Si=function(a){null!==this.U&&!0===this.c&&this.U.D(a)};e.Ri=function(a){null!==this.R&&!0===this.c&&this.R.D(a)};e.Qi=function(a){null!==this.N&&!0===this.c&&this.N.D(a)};e.Wi=function(a){null!==this.W&&!0===this.c&&this.W.D(a)};e.zi=function(a){null!==this.u&&!0===this.c&&this.u.D(a)};e.Bi=function(a){null!==this.A&&!0===this.c&&this.A.D(a)};
e.Ki=function(a){null!==this.m&&!0===this.c&&this.m.D(a)};e.Ji=function(a){null!==this.j&&!0===this.c&&this.j.D(a)};e.Ei=function(a){null!==this.f&&!0===this.c&&this.f.D(a)};e.Fh=function(a){null!==this.P&&!0===this.c&&this.P.D(a)};
e.enable=function(){!0===N.cd&&(this.L.dom.style.pointerEvents="auto");this.Ua.set({enable:!0});null===this.V&&(this.V=new Hammer.Tap,this.Ua.add(this.V));null===this.va&&(this.va=(new Hammer.Tap({event:U.events.Ad,so:2})).recognizeWith(this.V),this.Ua.add(this.va));null===this.wa&&(this.wa=(new Hammer.Press).recognizeWith(this.V),this.Ua.add(this.wa));null===this.oa&&(this.oa=new Hammer.Pan,this.Ua.add(this.oa));null===this.na&&(this.na=new Hammer.Pinch,this.Ua.add(this.na));null===this.xa&&(this.xa=
(new Hammer.Rotate).recognizeWith(this.na),this.Ua.add(this.xa));null===this.ya&&(this.ya=(new Hammer.Swipe).recognizeWith(this.oa),this.Ua.add(this.ya));this.c=!0;null!==this.S&&this.S.D()};e.Ve=function(){!0===N.cd&&(this.L.dom.style.pointerEvents="none");this.c=!1;this.Ua.set({enable:!1});null!==this.ba&&this.ba.D()};
e.destroy=function(){this.Ve();this.ya=this.xa=this.na=this.oa=this.wa=this.va=this.V=null;null!==this.S&&(this.S.destroy(),this.S=null);null!==this.ba&&(this.ba.destroy(),this.ba=null);null!==this.M&&(this.M.destroy(),this.M=null);null!==this.o&&(this.o.destroy(),this.o=null);null!==this.J&&(this.J.destroy(),this.J=null);null!==this.I&&(this.I.destroy(),this.I=null);null!==this.H&&(this.H.destroy(),this.H=null);null!==this.G&&(this.G.destroy(),this.G=null);null!==this.C&&(this.C.destroy(),this.C=
null);null!==this.K&&(this.K.destroy(),this.K=null);null!==this.F&&(this.F.destroy(),this.F=null);null!==this.B&&(this.B.destroy(),this.B=null);null!==this.U&&(this.U.destroy(),this.U=null);null!==this.R&&(this.R.destroy(),this.R=null);null!==this.N&&(this.N.destroy(),this.N=null);null!==this.W&&(this.W.destroy(),this.W=null);null!==this.u&&(this.u.destroy(),this.u=null);null!==this.A&&(this.A.destroy(),this.A=null);null!==this.m&&(this.m.destroy(),this.m=null);null!==this.j&&(this.j.destroy(),this.j=
null);null!==this.f&&(this.f.destroy(),this.f=null);null!==this.P&&(this.P.destroy(),this.P=null);this.L=null;l.prototype.destroy.call(this)};Object.defineProperty(U.prototype,"enabled",{get:function(){return this.c},set:function(a){!0===!!a?this.enable():this.Ve()}});Object.defineProperty(U.prototype,"cursor",{get:function(){return this.$},set:function(a){this.L.dom.style.cursor=a;if(a!==this.L.dom.style.cursor||""===this.L.dom.style.cursor)this.L.dom.style.cursor="-webkit-"+a;this.$=a}});
Object.defineProperty(U.prototype,"onEnable",{get:function(){null===this.S&&(this.S=new q(this));return this.S}});Object.defineProperty(U.prototype,"onDisable",{get:function(){null===this.ba&&(this.ba=new q(this));return this.ba}});Object.defineProperty(U.prototype,"onTap",{get:function(){null===this.M&&(this.M=new q(this.L),this.M.onDestroy.da(Hd(U.events.Ef,this.Yi,V.ka),this),Gd(this,U.events.Ef,this.Yi,V.ka));return this.M}});Object.defineProperty(U.prototype,"onClick",{get:function(){return this.onTap}});
Object.defineProperty(U.prototype,"onDoubleTap",{get:function(){null===this.o&&(this.o=new q(this.L),this.o.onDestroy.da(Hd(U.events.Ad,this.wi,V.ka),this),Gd(this,U.events.Ad,this.wi,V.ka));return this.o}});Object.defineProperty(U.prototype,"onDoubleClick",{get:function(){return this.onDoubleTap}});Object.defineProperty(U.prototype,"onPressStart",{get:function(){null===this.J&&(this.J=new q(this.L),this.J.onDestroy.da(Hd(U.events.yf,this.Eh,V.ka),this),Gd(this,U.events.yf,this.Eh,V.ka));return this.J}});
Object.defineProperty(U.prototype,"onDown",{get:function(){return this.onPressStart}});Object.defineProperty(U.prototype,"onPressEnd",{get:function(){null===this.I&&(this.I=new q(this.L),this.I.onDestroy.da(Hd(U.events.xf,this.Dh,V.ka),this),Gd(this,U.events.xf,this.Dh,V.ka));return this.I}});Object.defineProperty(U.prototype,"onUp",{get:function(){return this.onPressEnd}});
Object.defineProperty(U.prototype,"onPanStart",{get:function(){null===this.H&&(this.H=new q(this.L),this.H.onDestroy.da(Hd(U.events.sf,this.zh,V.ka),this),Gd(this,U.events.sf,this.zh,V.ka));return this.H}});Object.defineProperty(U.prototype,"onPanMove",{get:function(){null===this.G&&(this.G=new q(this.L),this.G.onDestroy.da(Hd(U.events.rf,this.yh,V.ka),this),Gd(this,U.events.rf,this.yh,V.ka));return this.G}});
Object.defineProperty(U.prototype,"onPanEnd",{get:function(){null===this.C&&(this.C=new q(this.L),this.C.onDestroy.da(Hd(U.events.qf,this.xh,V.ka),this),Gd(this,U.events.qf,this.xh,V.ka));return this.C}});Object.defineProperty(U.prototype,"onPinchStart",{get:function(){null===this.K&&(this.K=new q(this.L),this.K.onDestroy.da(Hd(U.events.wf,this.Ch,V.ka),this),Gd(this,U.events.wf,this.Ch,V.ka));return this.K}});
Object.defineProperty(U.prototype,"onPinchMove",{get:function(){null===this.F&&(this.F=new q(this.L),this.F.onDestroy.da(Hd(U.events.vf,this.Bh,V.ka),this),Gd(this,U.events.vf,this.Bh,V.ka));return this.F}});Object.defineProperty(U.prototype,"onPinchEnd",{get:function(){null===this.B&&(this.B=new q(this.L),this.B.onDestroy.da(Hd(U.events.uf,this.Ah,V.ka),this),Gd(this,U.events.uf,this.Ah,V.ka));return this.B}});
Object.defineProperty(U.prototype,"onRotateStart",{get:function(){null===this.U&&(this.U=new q(this.L),this.U.onDestroy.da(Hd(U.events.Bf,this.Si,V.ka),this),Gd(this,U.events.Bf,this.Si,V.ka));return this.U}});Object.defineProperty(U.prototype,"onRotateMove",{get:function(){null===this.R&&(this.R=new q(this.L),this.R.onDestroy.da(Hd(U.events.Af,this.Ri,V.ka),this),Gd(this,U.events.Af,this.Ri,V.ka));return this.R}});
Object.defineProperty(U.prototype,"onRotateEnd",{get:function(){null===this.N&&(this.N=new q(this.L),this.N.onDestroy.da(Hd(U.events.zf,this.Qi,V.ka),this),Gd(this,U.events.zf,this.Qi,V.ka));return this.N}});Object.defineProperty(U.prototype,"onSwipe",{get:function(){null===this.W&&(this.W=new q(this.L),this.W.onDestroy.da(Hd(U.events.Df,this.Wi,V.ka),this),Gd(this,U.events.Df,this.Wi,V.ka));return this.W}});
Object.defineProperty(U.prototype,"onEnter",{get:function(){null===this.u&&(this.u=new q(this.L),this.u.onDestroy.da(Hd(U.events.df,this.zi,V.Ra),this),Gd(this,U.events.df,this.zi,V.Ra));return this.u}});Object.defineProperty(U.prototype,"onLeave",{get:function(){null===this.A&&(this.A=new q(this.L),this.A.onDestroy.da(Hd(U.events.lf,this.Bi,V.Ra),this),Gd(this,U.events.lf,this.Bi,V.Ra));return this.A}});
Object.defineProperty(U.prototype,"onOver",{get:function(){null===this.m&&(this.m=new q(this.L),this.m.onDestroy.da(Hd(U.events.pf,this.Ki,V.Ra),this),Gd(this,U.events.pf,this.Ki,V.Ra));return this.m}});Object.defineProperty(U.prototype,"onOut",{get:function(){null===this.j&&(this.j=new q(this.L),this.j.onDestroy.da(Hd(U.events.nf,this.Ji,V.Ra),this),Gd(this,U.events.nf,this.Ji,V.Ra));return this.j}});
Object.defineProperty(U.prototype,"onMove",{get:function(){null===this.f&&(this.f=new q(this.L),this.f.onDestroy.da(Hd(U.events.mf,this.Ei,V.Ra),this),Gd(this,U.events.mf,this.Ei,V.Ra));return this.f}});Object.defineProperty(U.prototype,"onWheel",{get:function(){null===this.P&&(this.P=new q(this.L),this.P.onDestroy.da(Hd(U.events.Gf,this.Fh,V.Ra),this),Gd(this,U.events.Gf,this.Fh,V.Ra));return this.P}});var V={Ra:0,ka:1};U.events={};U.events.Ef="tap";U.events.Ad="doubletap";U.events.yf="press";
U.events.xf="pressup";U.events.sf="panstart";U.events.rf="panmove";U.events.qf="panend";U.events.wf="pinchstart";U.events.vf="pinchmove";U.events.uf="pinchend";U.events.Bf="rotatestart";U.events.Af="rotatemove";U.events.zf="rotateend";U.events.Df="swipe";U.events.df="mouseenter";U.events.lf="mouseleave";U.events.pf="mouseover";U.events.nf="mouseout";U.events.mf="mousemove";U.events.Gf="wheel";var Ed={DEFAULT:"default",Za:"pointer",Dl:"grab",El:"grabbing"};
function ga(a){this.i=a;this.Z=[];this.f=[];this.j=this.c=null;l.call(this,"DisplayList");this.c=this.im.bind(this);document.addEventListener("fullscreenchange",this.c,!1);document.addEventListener("mozfullscreenchange",this.c,!1);document.addEventListener("webkitfullscreenchange",this.c,!1);document.addEventListener("MSFullscreenChange",this.c,!1)}ga.prototype=Object.create(l.prototype);e=ga.prototype;e.constructor=ga;
e.im=function(){this.log("_fullScreenChangeHandler");if(null!==document[N.fullscreenElement])for(var a,b=this.Z.length;b--;){if(a=this.Z[b],a.dom===document[N.fullscreenElement]){a=this.j=a;a.log("_notifyFullscreenEnter");b=a;b.log("_fullscreenSaveData");b.U={x:b.G,y:b.H,width:b.u,unitWidth:b.C,height:b.o,unitHeight:b.A,top:b.Rb,right:b.ya,bottom:b.Ib,left:b.va};b.G=0;b.H=0;b.u=screen.width;b.C="px";b.c.style.width=b.u+"px";b.o=screen.height;b.A="px";b.c.style.height=b.o+"px";b.Rb=null;b.ya=null;
b.Ib=null;b.va=null;b.c.style.top="0";b.c.style.left="0";b.ta({property:"both"});null!==a.Ob&&a.Ob.D();break}}else a=this.j,a.log("_notifyFullscreenChange"),a.log("_fullscreenRestoreData"),a.G=a.U.x,a.c.style.left=a.G+"px",a.H=a.U.y,a.c.style.top=a.H+"px",a.u=a.U.width,a.C=a.U.unitWidth,a.c.style.width=a.pixelWidth+"px",a.o=a.U.height,a.A=a.U.unitHeight,a.c.style.height=a.pixelHeight+"px",a.Rb=a.U.top,a.ya=a.U.right,a.Ib=a.U.bottom,a.va=a.U.left,a.ta({property:"both"}),a.U=null,null!==a.Pb&&a.Pb.D(),
this.j=null};e.register=function(a,b){this.Z.push(a);!0===b&&this.f.push(a)};e.unregister=function(a){this.Z.splice(this.Z.indexOf(a),1);a=this.f.indexOf(a);-1!==a&&this.f.splice(a,1)};e.update=function(){for(var a=0,b=this.f.length;a<b;a++)this.f[a].update()};
e.destroy=function(){for(var a=this.Z.length;a--;)this.Z[a].destroy();this.Z=[];this.f=[];document.removeEventListener("fullscreenchange",this.c,!1);document.removeEventListener("mozfullscreenchange",this.c,!1);document.removeEventListener("webkitfullscreenchange",this.c,!1);document.removeEventListener("MSFullscreenChange",this.c,!1);this.j=this.c=null};var Id="DisplayObject DisplayObjectContainer Image TextField Button Video Canvas Sprite Iframe".split(" ");
function T(a,b,d){this.i=a;this.c=b||null;this.m=null;this.ne=0;this.cf="";this.H=this.G=0;this.Kb=!1;this.u=0;this.C="px";this.na=1;this.o=0;this.A="px";this.oa=1;this.zc=this.xc=!1;this.va=this.Ib=this.ya=this.Rb=null;this.me=1;this.pe=0;this.wc=this.yc=null;this.Tc="";this.Vc="solid";this.N=0;this.Uc="rgb(0, 0, 0)";this.xe=0;this.R=!1;this.sd="";this.hb=null;this.oe=!1;this.W=!0;this.xa=null;this.ba=!1;this.Pb=this.Ob=this.Mc=this.gd=this.Lb=this.Mb=this.K=this.Nb=this.Qb=this.wa=this.U=null;l.call(this,
d||"DisplayObject");this.Ea()}T.prototype=Object.create(l.prototype);e=T.prototype;e.constructor=T;
e.Ea=function(){!0!==this.oe&&("undefined"===typeof this.c||null===this.c?this.c=document.createElement("div"):(this.u=ha.Qj(this.c),this.C=ha.Oj(this.c),this.o=ha.Pj(this.c),this.A=ha.Nj(this.c)),this.c.style.width=this.u+""+this.C,this.c.style.height=this.o+""+this.A,this.c.style.display="block",this.c.style.position="relative",this.c.style.margin="0px",this.c.style.padding="0px",this.c.style.top=this.H+"px",this.c.style.left=this.G+"px",this.c.style.overflow="hidden",this.c.style.boxSizing="border-box",
!0===N.cd&&(this.c.style.pointerEvents="none"),this.c.style.O="none",this.c.style.webkitUserSelect="none",this.c.style.c="none",this.c.style.f="none",this.c.style.j="none",this.c.style.borderStyle=this.Vc,this.c.style.borderWidth=this.N+"px",this.c.style.borderColor=this.Uc,this.c.style.background=this.Tc,this.xa=[],"DisplayObject"===this.Ta&&(this.i.display.register(this),Jd(this),Kd(this)))};function Jd(a){!0!==a.oe&&(a.log("_notifyReady"),a.oe=!0,null!==a.wa&&a.wa.D())}
e.Sd=function(){this.log("_notifyAddedToDom");null!==this.Lb&&this.Lb.D()};e.ic=function(){this.log("_notifyShow");!1!==this.kd()&&null!==this.gd&&!0===this.visible&&this.gd.D()};e.Td=function(){this.log("_notifyHide");null!==this.Mc&&!1===this.visible&&this.Mc.D()};e.Mf=function(){null!==this.Nb&&this.Nb.D()};e.ta=function(a){Ld(this);null!==this.Qb&&this.Qb.D(a)};
function Ld(a){null!==a.m&&a.u&&a.o&&(a.log("_updateAnchors"),!0===a.xc?a.horizontalCenter=!0:(a.left=a.va,a.right=a.ya),!0===a.zc?a.verticalCenter=!0:(a.top=a.Rb,a.bottom=a.Ib))}
function Md(a,b){var d=-1!==b.toLowerCase().indexOf("height")||"both"===b;!0===(-1!==b.toLowerCase().indexOf("width")||"both"===b)&&"%"===a.C&&(a.c.style.width=a.pixelWidth+"px",a.c.width=a.pixelWidth,a.ta({property:"width"}));!0===d&&"%"===a.A&&(a.c.style.height=a.pixelHeight+"px",a.c.height=a.pixelHeight,a.ta({property:"height"}))}function Nd(a,b,d){a.xa.push({prop:b,value:d})}
function Kd(a){a.log("_applyPending");a.W=!1;if(null!==a.xa&&0!==a.xa.length){a.ba=!0;for(var b=0,d=a.xa.length;b<d;b++)a[a.xa[b].prop]=a.xa[b].value;a.ba=!1;a.xa=[]}}e.gh=function(){this.c.style.display="block";this.ic()};e.Wj=function(){this.c.style.display="none";this.Td()};e.io=function(){this.visible=!this.visible};
e.Ab=function(a){!0===a&&(this.R=!0,!0===this.W&&Nd(this,"maximized",!0));null!==this.m&&(this.Kb=!1,a=this.pixelWidth,this.u=this.m.innerWidth,this.C="px",this.c.style.width=this.m.innerWidth+"px",this.c.width=this.m.innerWidth,a!==this.pixelWidth&&this.ta({property:"width"}),a=this.pixelHeight,this.o=this.m.innerHeight,this.A="px",this.c.style.height=this.m.innerHeight+"px",this.c.height=this.m.innerHeight,a!==this.pixelHeight&&this.ta({property:"height"}))};e.kd=function(){return ha.has(this.c)};
e.fh=function(a,b){null!==a&&"undefined"!==typeof a&&(this.width=a);null!==b&&"undefined"!==typeof b&&(this.height=b)};e.Aj=function(){if(!0===document[N.fullscreenEnabled]&&!1===this.jd())this.c[N.requestFullscreen]()};e.Bj=function(){if(!0===document[N.fullscreenEnabled]&&!0===this.jd())document[N.exitFullscreen]()};e.jd=function(){return document[N.fullscreenElement]===this.c};
e.destroy=function(){!1!==this.ib&&(this.i.display.unregister(this),null!==this.m&&(this.m.removeChild(this,!1),this.m=null),null!==this.yc&&(this.yc.destroy(),this.yc=null),null!==this.wc&&(this.wc.destroy(),this.wc=null),null!==this.Qb&&(this.Qb.destroy(),this.Qb=null),null!==this.Nb&&(this.Nb.destroy(),this.Nb=null),null!==this.wa&&(this.wa.destroy(),this.wa=null),null!==this.Mb&&(this.Mb.destroy(),this.Mb=null),null!==this.Lb&&(this.Lb.destroy(),this.Lb=null),null!==this.Ob&&(this.Ob.destroy(),
this.Ob=null),null!==this.Pb&&(this.Pb.destroy(),this.Pb=null),this.i=this.hb=this.c=null,l.prototype.destroy.call(this))};Object.defineProperty(T.prototype,"viewer",{get:function(){return this.i}});Object.defineProperty(T.prototype,"dom",{get:function(){return this.c}});Object.defineProperty(T.prototype,"id",{get:function(){return this.cf},set:function(a){this.cf=a;this.c.id=this.cf}});Object.defineProperty(T.prototype,"ready",{get:function(){return this.oe}});
Object.defineProperty(T.prototype,"parent",{get:function(){return this.m},set:function(a){"object"===typeof a&&!1!==Array.isArray(a.children)&&a!==this.m&&(this.m=a,this.c.style.position="absolute",!0===this.R&&this.Ab(this.R),Md(this,"both"),Ld(this),null!==this.Mb&&this.Mb.D(),!0===this.m.kd()&&(this.Sd(),this.ic()))}});Object.defineProperty(T.prototype,"visible",{get:function(){return"block"===this.c.style.display},set:function(a){"boolean"===typeof a&&(!0===a?this.gh():this.Wj())}});
Object.defineProperty(T.prototype,"x",{get:function(){return this.G},set:function(a){if("number"===typeof a){var b=this.G;this.G=a;this.c.style.left=this.G+"px";null!==this.K&&b!==this.G&&this.K.D({property:"x"})}}});Object.defineProperty(T.prototype,"y",{get:function(){return this.H},set:function(a){if("number"===typeof a){var b=this.H;this.H=a;this.c.style.top=this.H+"px";null!==this.K&&b!==this.H&&this.K.D({property:"y"})}}});
Object.defineProperty(T.prototype,"keepRatio",{get:function(){return this.Kb},set:function(a){"boolean"===typeof a&&a!==this.Kb&&(this.Kb=a)}});
Object.defineProperty(T.prototype,"width",{get:function(){return this.u},set:function(a){var b=this.u,d=this.C;if("string"===typeof a){var g=B.Ag(a);if(null===g.value||null===g.Hc)throw"$_DisplayObject.width value "+a+" is incorrect";this.C=g.Hc;this.u=g.value}else if("number"===typeof a)this.u=a;else return;!0===this.W?Nd(this,"width",this.u):(this.R=!1,this.c.style.width=this.pixelWidth+"px",this.c.width=this.pixelWidth,b===this.u&&d===this.C&&!0!==this.ba||this.ta({property:"width"}))}});
Object.defineProperty(T.prototype,"pixelWidth",{get:function(){if("px"===this.C)return this.u;if("%"===this.C)return null!==this.m?this.m.innerWidth*this.u/100:0},set:function(a){if("number"===typeof a){var b=this.u,d=this.C;this.u=a;this.C="px";!0===this.W?Nd(this,"pixelWidth",a):(this.R=!1,this.c.style.width=this.pixelWidth+"px",this.c.width=this.pixelWidth,b===this.u&&"px"===d&&!0!==this.ba||this.ta({property:"pixelWidth"}))}}});
Object.defineProperty(T.prototype,"percentWidth",{get:function(){if("%"===this.C)return this.u;if("px"===this.C)return null!==this.m?this.u/this.m.innerWidth*100:0},set:function(a){if("number"===typeof a){var b=this.u,d=this.C;this.u=a;this.C="%";!0===this.W?Nd(this,"percentWidth",a):(this.R=!1,this.c.style.width=this.pixelWidth+"px",this.c.width=this.pixelWidth,b===this.u&&"%"===d&&!0!==this.ba||this.ta({property:"percentWidth"}))}}});
Object.defineProperty(T.prototype,"unitWidth",{get:function(){return this.C},set:function(a){if("string"===typeof a&&("px"===a||"%"===a)){var b=this.C;this.C=a;!0===this.W?Nd(this,"unitWidth",a):(this.R=!1,this.c.style.width=this.pixelWidth+"px",this.c.width=this.pixelWidth,b===this.C&&!0!==this.ba||this.ta({property:"unitWidth"}))}}});Object.defineProperty(T.prototype,"innerWidth",{get:function(){return this.pixelWidth-2*this.N}});
Object.defineProperty(T.prototype,"height",{get:function(){return this.o},set:function(a){var b=this.o,d=this.A;if("string"===typeof a){var g=B.Ag(a);if(null===g.value||null===g.Hc)throw"$_DisplayObject.height value "+a+" is incorrect";this.A=g.Hc;this.o=g.value}else if("number"===typeof a)this.o=a;else return;!0===this.W?Nd(this,"height",this.o):(this.R=!1,this.c.style.height=this.pixelHeight+"px",this.c.height=this.pixelHeight,b===this.o&&d===this.A&&!0!==this.ba||this.ta({property:"height"}))}});
Object.defineProperty(T.prototype,"pixelHeight",{get:function(){if("px"===this.A)return this.o;if("%"===this.A)return null!==this.m?this.m.innerHeight*this.o/100:0},set:function(a){if("number"===typeof a){var b=this.o,d=this.A;this.o=a;this.A="px";!0===this.W?Nd(this,"pixelHeight",a):(this.R=!1,this.c.style.height=this.pixelHeight+"px",this.c.height=this.pixelHeight,b===this.o&&"px"===d&&!0!==this.ba||this.ta({property:"pixelHeight"}))}}});
Object.defineProperty(T.prototype,"percentHeight",{get:function(){if("%"===this.A)return this.o;if("px"===this.A)return null!==this.m?this.o/this.m.innerHeight*100:0},set:function(a){if("number"===typeof a){var b=this.o,d=this.A;this.o=a;this.A="%";!0===this.W?Nd(this,"percentHeight",a):(this.R=!1,this.c.style.height=this.pixelHeight+"px",this.c.height=this.pixelHeight,b===this.o&&"%"===d&&!0!==this.ba||this.ta({property:"percentHeight"}))}}});
Object.defineProperty(T.prototype,"unitHeight",{get:function(){return this.A},set:function(a){if("string"===typeof a){var b=this.A;this.A=a;!0===this.W?Nd(this,"unitHeight",a):(this.R=!1,this.c.style.height=this.pixelHeight+"px",this.c.height=this.pixelHeight,b===this.A&&!0!==this.ba||this.ta({property:"unitHeight"}))}}});Object.defineProperty(T.prototype,"innerHeight",{get:function(){return this.pixelHeight-2*this.N}});
Object.defineProperty(T.prototype,"maximized",{get:function(){return this.R},set:function(a){"boolean"===typeof a&&(this.R=a,!0===this.R&&this.Ab(!0))}});Object.defineProperty(T.prototype,"horizontalCenter",{get:function(){return this.xc},set:function(a){"boolean"===typeof a&&(this.xc=a,!0===this.xc&&(this.ya=this.va=null),null!==this.m&&(a=this.G,this.G=(this.m.innerWidth-this.pixelWidth)/2,this.c.style.left=this.G+"px",null!==this.K&&a!==this.G&&this.K.D({property:"x"})))}});
Object.defineProperty(T.prototype,"verticalCenter",{get:function(){return this.zc},set:function(a){"boolean"===typeof a&&(this.zc=a,!0===this.zc&&(this.Ib=this.Rb=null),null!==this.m&&(a=this.H,this.H=(this.m.innerHeight-this.pixelHeight)/2,this.c.style.top=this.H+"px",null!==this.K&&a!==this.H&&this.K.D({property:"y"})))}});
Object.defineProperty(T.prototype,"top",{get:function(){return this.Rb},set:function(a){if("number"===typeof a||null===a)if(this.Rb=a,this.zc=!1,null!==this.m&&null!==this.Rb){var b=this.H;this.H=a;this.c.style.top=this.H+"px";null!==this.K&&b!==this.H&&this.K.D({property:"y"})}}});
Object.defineProperty(T.prototype,"right",{get:function(){return this.ya},set:function(a){if("number"===typeof a||null===a)if(this.ya=a,this.xc=!1,null!==this.m&&null!==this.ya){var b=this.G;this.G=this.m.innerWidth-this.pixelWidth-a;this.c.style.left=this.G+"px";null!==this.K&&b!==this.G&&this.K.D({property:"x"})}}});
Object.defineProperty(T.prototype,"bottom",{get:function(){return this.Ib},set:function(a){if("number"===typeof a||null===a)if(this.Ib=a,this.zc=!1,null!==this.m&&null!==this.Ib){var b=this.H;this.H=this.m.innerHeight-this.pixelHeight-a;this.c.style.top=this.H+"px";null!==this.K&&b!==this.H&&this.K.D({property:"y"})}}});
Object.defineProperty(T.prototype,"left",{get:function(){return this.va},set:function(a){if("number"===typeof a||null===a)if(this.va=a,this.xc=!1,null!==this.m&&null!==this.va){var b=this.G;this.G=a;this.c.style.left=this.G+"px";null!==this.K&&b!==this.G&&this.K.D({property:"x"})}}});Object.defineProperty(T.prototype,"alpha",{get:function(){return this.me},set:function(a){"number"===typeof a&&a!==this.me&&(this.me=a,this.c.style.opacity=this.me)}});
Object.defineProperty(T.prototype,"rotation",{get:function(){return this.pe},set:function(a){"number"===typeof a&&a!==this.pe&&(this.pe=a,this.c.style.transform="rotate("+this.pe+"deg)")}});Object.defineProperty(T.prototype,"background",{get:function(){return this.Tc},set:function(a){"string"===typeof a&&a!==this.Tc&&(this.Tc=a,this.c.style.background=this.Tc)}});
Object.defineProperty(T.prototype,"borderStyle",{get:function(){return this.Vc},set:function(a){-1!=="none dotted dashed solid double groove ridge inset outset".split(" ").indexOf(a)&&a!==this.Vc&&(this.Vc=a,!0===this.W?Nd(this,"borderStyle",a):this.c.style.borderStyle=this.Vc)}});
Object.defineProperty(T.prototype,"borderWidth",{get:function(){return this.N},set:function(a){if("number"===typeof a){var b=this.N;this.N=a;!0===this.W?Nd(this,"borderWidth",a):(this.c.style.borderWidth=this.N+"px",b===this.N&&!0!==this.ba||this.Mf())}}});Object.defineProperty(T.prototype,"borderColor",{get:function(){return this.Uc},set:function(a){"string"===typeof a&&a!==this.Uc&&(this.Uc=a,this.c.style.borderColor=this.Uc)}});
Object.defineProperty(T.prototype,"borderRadius",{get:function(){return this.xe},set:function(a){"number"!==typeof a&&"string"!==typeof a||a===this.xe||("string"===typeof a&&(a=parseInt(a,10)),isNaN(a)||(this.xe=a,this.c.style.borderRadius=this.xe+"px"))}});Object.defineProperty(T.prototype,"globalOffset",{get:function(){var a=this.c,b=0,d=0;do b+=a.offsetTop||0,d+=a.offsetLeft||0,a=a.offsetParent;while(a);return{top:b,left:d}}});
Object.defineProperty(T.prototype,"tooltip",{get:function(){return this.sd},set:function(a){"string"===typeof a&&a!==this.sd&&(this.sd=a,this.c.title=this.sd)}});Object.defineProperty(T.prototype,"index",{get:function(){return this.ne},set:function(a){"number"===typeof a&&a!==this.ne&&(this.ne=a,this.c.style.zIndex=this.ne)}});Object.defineProperty(T.prototype,"fullscreen",{set:function(a){"boolean"===typeof a&&(!0===a?this.Aj():this.Bj())}});
Object.defineProperty(T.prototype,"pointer",{get:function(){null===this.yc&&(this.yc=new U(this));return this.yc}});Object.defineProperty(T.prototype,"drag",{get:function(){null===this.wc&&(this.wc=new Bd(this));return this.wc}});Object.defineProperty(T.prototype,"onResize",{get:function(){null===this.Qb&&(this.Qb=new q(this));return this.Qb}});Object.defineProperty(T.prototype,"onBorderResize",{get:function(){null===this.Nb&&(this.Nb=new q(this));return this.Nb}});
Object.defineProperty(T.prototype,"onMove",{get:function(){null===this.K&&(this.K=new q(this));return this.K}});Object.defineProperty(T.prototype,"onReady",{get:function(){null===this.wa&&(this.wa=new q(this,!0));return this.wa}});Object.defineProperty(T.prototype,"onAddedToParent",{get:function(){null===this.Mb&&(this.Mb=new q(this));return this.Mb}});Object.defineProperty(T.prototype,"onAddedToDom",{get:function(){null===this.Lb&&(this.Lb=new q(this));return this.Lb}});
Object.defineProperty(T.prototype,"onShow",{get:function(){null===this.gd&&(this.gd=new q(this));return this.gd}});Object.defineProperty(T.prototype,"onHide",{get:function(){null===this.Mc&&(this.Mc=new q(this));return this.Mc}});Object.defineProperty(T.prototype,"onFullscreenEnter",{get:function(){null===this.Ob&&(this.Ob=new q(this));return this.Ob}});Object.defineProperty(T.prototype,"onFullscreenExit",{get:function(){null===this.Pb&&(this.Pb=new q(this));return this.Pb}});
function t(a,b,d,g){this.f=[];this.M="undefined"!==typeof g?g:null;this.B=null;this.Kf=!1;this.fa="hidden";T.call(this,a,b,d||"DisplayObjectContainer")}t.prototype=Object.create(T.prototype);e=t.prototype;e.constructor=t;
e.Ea=function(){T.prototype.Ea.call(this);if("DisplayObjectContainer"===this.Ta){var a=null!==this.M;!0===a&&(this.B={originalWidth:this.M.clientWidth,originalHeight:this.M.clientHeight,currentWidth:this.M.clientWidth,currentHeight:this.M.clientHeight,scaleWidth:1,scaleHeight:1,frameCount:0,frameInterval:10},this.u=this.B.currentWidth,this.c.style.width=this.pixelWidth+"px",this.o=this.B.currentHeight,this.c.style.height=this.pixelHeight+"px",this.c.style.position="absolute",this.M.appendChild(this.c));
this.i.display.register(this,a);Jd(this);Kd(this)}};e.ta=function(a){for(var b=0,d=this.f.length;b<d;b++){var g=this.f[b],h=a;!0===g.R&&g.Ab(g.R);Md(g,h.property);Ld(g)}T.prototype.ta.call(this,a)};e.Sd=function(){T.prototype.Sd.call(this);for(var a=0,b=this.f.length;a<b;a++)this.f[a].Sd()};e.ic=function(){T.prototype.ic.call(this);for(var a=0,b=this.f.length;a<b;a++)this.f[a].ic()};e.Td=function(){T.prototype.Td.call(this);for(var a=0,b=this.f.length;a<b;a++)this.f[a].Td()};
function Od(a,b){if(null===a.f)return-1;for(var d=0,g=a.f.length;d<g;d++)if(a.f[d]===b)return d;return-1}
e.update=function(){this.B.frameCount++;if(!(this.B.frameCount<this.B.frameInterval)){this.B.frameCount=0;var a=this.M.clientWidth,b=this.M.clientHeight,d=!1;a!==this.B.currentWidth&&(this.B.currentWidth=a,this.B.scaleWidth=this.B.currentWidth/this.B.originalWidth,d=!0);b!==this.B.currentHeight&&(this.B.currentHeight=b,this.B.scaleHeight=this.B.currentHeight/this.B.scaleHeight,d=!0);!0===d&&this.fh(this.B.currentWidth,this.B.currentHeight)}};
e.Xb=function(a){if(a===this)throw"You can't add a $_DisplayObjectContainer to itself!";var b=a;a instanceof Element&&(b=new T(a));this.c.appendChild(b.dom);b.parent=this;a=this.f.push(b)-1;null===b.index&&(b.index=a)};e.nn=function(a,b){var d=a;a instanceof Element&&(d=new T(a));this.c.appendChild(d.dom);d.parent=this;this.f.splice(b,0,d);d.index=b;b=0;for(d=this.f.length;b<d;b++)a=this.f[b],a.index=b};
e.zj=function(){var a=this.f;if(0<a.length){this.Kf=!0;for(var b=0,d=a.length;b<d;b++)if(!0===a[b].kd()&&!0===a[b].visible){var g=Math.max(a[b].width+a[b].x,a[b].width+a[b].left,a[b].width+a[b].right),h=Math.max(a[b].height+a[b].y,a[b].height+a[b].top,a[b].height+a[b].bottom);g>this.pixelWidth&&(this.width=g);h>this.pixelHeight&&(this.height=h)}}null!==this.parent&&!0===B.T(this.parent,"DisplayObjectContainer")&&!0===this.parent.Kf&&this.parent.zj()};
e.removeChild=function(a,b){a=Od(this,a);-1!==a&&this.Bg(a,b)};e.Bg=function(a,b){if(0<=a&&a<this.f.length){var d=this.f[a];this.f.splice(a,1);this.c.removeChild(d.dom);"undefined"!==typeof b&&!0!==b||d.destroy();!0!==this.Kf||this.f.length||(this.height=this.width=0)}};e.eh=function(a){for(var b=this.f.length;b--;)this.Bg(b,a)};e.Kk=function(a){return-1!==Od(this,a)};e.destroy=function(){this.eh(!1);this.B=this.M=this.f=null;T.prototype.destroy.call(this)};
Object.defineProperty(t.prototype,"children",{get:function(){return this.f}});Object.defineProperty(t.prototype,"overflow",{get:function(){return this.fa},set:function(a){-1!==["hidden","visible","scroll"].indexOf(a)&&(this.fa=a,this.c.style.overflow=a)}});
function I(a,b,d){this.ra=b||null;this.ia=this.M="";this.fa=!1;this.ga=this.sa="";this.B=this.V=null;this.$=!1;this.ea=this.f=null;this.ma="";this.P=this.la=!1;this.pa=this.qa=!0;this.F=Pd;this.J=this.S=this.j=null;T.call(this,a,null,d||"Image")}I.prototype=Object.create(T.prototype);I.prototype.constructor=I;var Qd={CSS:"css",Jb:"canvas"},Pd=Qd.CSS;e=I.prototype;
e.Ea=function(){T.prototype.Ea.call(this);this.Kb=!0;this.F===Qd.CSS?this.c.style.backgroundRepeat="no-repeat":this.F===Qd.Jb&&(this.j=document.createElement("canvas"),this.j.style.position="absolute",this.j.style.top="0px",this.j.style.left="0px",this.c.appendChild(this.j));null!==this.ra&&this.load(this.ra);this.i.display.register(this);Jd(this)};
e.ta=function(a){var b=a.property;-1!==b.toLowerCase().indexOf("width")&&"autoWidth"!==b&&(this.qa=!1);-1!==b.toLowerCase().indexOf("height")&&"autoHeight"!==b&&(this.pa=!1);null!==this.B&&(this.F===Qd.CSS?(Rd(this),Sd(this)):this.F===Qd.Jb&&null!==this.f&&this.$c(this.f),!0===this.Kb&&(-1!==b.toLowerCase().indexOf("width")?(b=this.pixelWidth/this.f.w,b!==this.na&&(this.na=b,!0===this.Kb&&(this.oa=b,this.height=this.f.h*this.oa))):-1!==b.toLowerCase().indexOf("height")&&(b=this.pixelHeight/this.f.h,
b!==this.oa&&(this.oa=b,!0===this.Kb&&(this.na=b,this.width=this.f.w*this.na)))),T.prototype.ta.call(this,a))};e.Mf=function(){this.F===Qd.CSS?this.c.style.backgroundPosition=-this.N+"px "+-this.N+"px":this.F===Qd.Jb&&(this.j.style.top=-this.N+"px",this.j.style.left=-this.N+"px");T.prototype.Mf.call(this)};e.Qe=function(){var a=this.M+"_"+this.i.i18n.locale;if(a!==this.sa&&(this.sa=a,!0===this.i.i18n.xb(this.ga))){var b=this.V.value;this.P=!1;this.i.load.image(a,b,this.Rd,this)}};
function Td(a,b){a.f=b;!0===a.qa&&(a.u=a.f.w,a.C="px",a.c.style.width=a.pixelWidth+"px");!0===a.pa&&(a.o=a.f.h,a.A="px",a.c.style.height=a.pixelHeight+"px");a.F===Qd.CSS?(Rd(a),Sd(a)):a.F===Qd.Jb&&a.$c(a.f)}e.$c=function(a){if(null!==this.B&&!1!==this.$){this.j.width=this.innerWidth;this.j.height=this.innerHeight;var b=this.j.getContext("2d");b.clearRect(0,0,this.innerWidth,this.innerHeight);b.drawImage(this.B,a.x,a.y,a.w,a.h,0,0,this.innerWidth,this.innerHeight)}};
function Rd(a){a.c.style.backgroundSize=a.pixelWidth/a.f.w*a.B.naturalWidth+"px "+a.pixelHeight/a.f.h*a.B.naturalHeight+"px"}function Sd(a){a.c.style.backgroundPosition=a.pixelWidth/a.f.w*(-a.f.x-a.N)+"px "+a.pixelHeight/a.f.h*(-a.f.y-a.N)+"px"}e.Rd=function(a){!1!==this.ib&&(this.B=a.data,this.F===Qd.CSS&&(this.c.style.backgroundImage="url('"+a.url+"')"),this.$=!0,Ud(this))};
e.qm=function(a){"undefined"!==typeof a.data.frames?this.ea=a.data.frames:this.warn("No frames found in file!");this.la=!0;Ud(this)};function Ud(a){if(!0!==a.P&&!0===a.$&&!0===a.la){a.P=!0;var b;null!==a.f?b=a.f:null!==a.ea?b=a.ea[0].frame:b={x:0,y:0,w:a.B.naturalWidth,h:a.B.naturalHeight};Td(a,b);Ld(a);Kd(a);null!==a.J&&a.J.D()}}
e.load=function(a){this.la=this.$=this.P=!1;"object"===typeof a&&null!==a?(this.M=a.key||"",this.fa=a.i18n||!1,!0===this.fa?(this.ia="",this.ga=a.url):this.ia=a.url,this.f=a.frame||null,"string"===typeof a.frames?this.ma=a.frames:"object"===typeof a.frames&&null!==a.frames&&(this.ea=a.frames),this.alpha=a.alpha,this.keepRatio=a.keepRatio,this.maximized=a.maximized,this.width=a.width,this.height=a.height):(this.ia=this.M="",this.fa=!1,"string"===typeof a&&(this.ia=a));a=this.M;var b=this.ia;if(!0===
this.fa&&"string"===typeof this.ga){this.V=new za(this.i,this.ga);!1===this.i.i18n.onLocaleChangeComplete.has(this.Qe,this)&&this.i.i18n.onLocaleChangeComplete.add(this.Qe,this);var d=this.i.i18n.locale;""!==d&&(a=this.M+"_"+d);!0===this.i.i18n.xb(this.ga)&&(b=this.V.value)}""!==b?(this.P=!1,this.i.load.image(a,b,this.Rd,this)):this.$=!0;"string"===typeof this.ma&&""!==this.ma?(a=this.ma,this.P=!1,this.i.load.json(this.M+"-frames",a,this.qm,this)):this.la=!0};
e.Ee=function(){this.c.style.backgroundImage="";this.B=null};
e.destroy=function(a){if(!1!==this.ib){null!==this.V&&(this.V.destroy(),this.V=null,this.i.i18n.onLocaleChangeComplete.remove(this.Qe,this));null!==this.S&&(this.S.destroy(),this.S=null);null!==this.J&&(this.J.destroy(),this.J=null);this.B=null;if("undefined"===typeof a||!0===a)if(!0===this.fa){a=this.i.i18n.locales;for(var b,d=0,g=a.length;d<g;d++)b=this.M+"_"+a[d],this.i.cache.remove(A.IMAGE,b)}else this.i.cache.remove(A.IMAGE,this.M);T.prototype.destroy.call(this)}};
Object.defineProperty(I.prototype,"loaded",{get:function(){return this.P}});Object.defineProperty(I.prototype,"element",{get:function(){return this.B}});Object.defineProperty(I.prototype,"frame",{get:function(){return this.f},set:function(a){Td(this,a)}});Object.defineProperty(I.prototype,"frames",{get:function(){return this.ea}});Object.defineProperty(I.prototype,"originalWidth",{get:function(){if(null!==this.B)return this.B.naturalWidth}});
Object.defineProperty(I.prototype,"originalHeight",{get:function(){if(null!==this.B)return this.B.naturalHeight}});Object.defineProperty(I.prototype,"onLoadStart",{get:function(){null===this.S&&(this.S=new q(this));return this.S}});Object.defineProperty(I.prototype,"onLoadComplete",{get:function(){null===this.J&&(this.J=new q(this));return this.J}});function ic(a,b){this.oa=this.na=1;this.I=null;I.call(this,a,b,"ImageScalable");this.Ea()}ic.prototype=Object.create(I.prototype);e=ic.prototype;
e.constructor=ic;e.Ea=function(){this.warn(this.Ta+" test both render modes");this.F=Qd.Jb;I.prototype.Ea.call(this)};e.Rd=function(a){var b=a.data;this.I=new Ia(b.naturalWidth,b.naturalHeight);I.prototype.Rd.call(this,a)};
e.$c=function(a){this.log(a);this.F!==Qd.Jb?this.warn("Invalid render mode for "+this.Ta):null!==this.B&&!1!==this.$&&(this.u=this.j.width=this.I.width*this.na,this.c.style.width=this.j.width+"px",this.o=this.j.height=this.I.height*this.oa,this.c.style.height=this.j.height+"px",a=this.j.getContext("2d"),a.clearRect(0,0,this.j.width,this.j.height),a.drawImage(this.B,0,0,this.I.width,this.I.height,0,0,this.j.width,this.j.height))};e.destroy=function(){this.I=null;I.prototype.destroy.call(this)};
Object.defineProperty(ic.prototype,"scaleWidth",{get:function(){return this.na},set:function(a){a=Math.max(Number.EPSILON,a);this.na!==a&&(this.na=a,this.$c(this.frame))}});Object.defineProperty(ic.prototype,"scaleHeight",{get:function(){return this.oa},set:function(a){a=Math.max(Number.EPSILON,a);this.oa!==a&&(this.oa=a,this.$c(this.frame))}});function nd(a,b){this.I=null;I.call(this,a,b,"Sprite")}nd.prototype=Object.create(I.prototype);e=nd.prototype;e.constructor=nd;
e.Ea=function(){this.F=Qd.Jb;I.prototype.Ea.call(this);this.I=new Vd(this);this.i.display.register(this,!0)};e.play=function(a,b,d){this.I.play(a,b,d)};e.pause=function(a){this.I.pause(a)};e.resume=function(a){this.I.resume(a)};e.stop=function(){this.I.stop()};e.update=function(){this.I.update()};e.destroy=function(){!1!==this.ib&&(this.I.destroy(),this.I=null,I.prototype.destroy.call(this))};Object.defineProperty(nd.prototype,"animations",{get:function(){return this.I}});
Object.defineProperty(nd.prototype,"animation",{get:function(){return this.I.currentAnimation}});function Wd(a,b){this.f=null;this.V=b||null;this.j="";this.M=!1;this.B="";this.S=this.J=null;this.P=!1;this.F=this.I=null;T.call(this,a,null,"Iframe")}Wd.prototype=Object.create(T.prototype);e=Wd.prototype;e.constructor=Wd;
e.Ea=function(){T.prototype.Ea.call(this);this.S=this.om.bind(this);this.f=document.createElement("iframe");this.f.style.width="100%";this.f.style.height="100%";this.f.style.border=0;this.f.style.overflow="hidden";this.f.addEventListener("load",this.S,null!==this&&!!this);this.f.setAttribute("allowFullScreen","");this.c.appendChild(this.f);null!==this.V&&this.load(this.V);this.i.display.register(this);Jd(this);Kd(this)};
e.Pe=function(){this.log("_localeChangeComplete");!0===this.i.i18n.xb(this.B)&&Xd(this,this.J.value)};function Xd(a,b){a.log("_loadIframe url: "+b);a.P=!1;null!==a.I&&a.I.D();a.j=b;a.f.src=a.j}e.om=function(){""!==this.j&&(this.log("_loadCompleteHandler url: "+this.j),this.P=!0,null!==this.F&&this.F.D())};function Yd(a){!1===a.i.i18n.onLocaleChangeComplete.has(a.Pe,a)&&a.i.i18n.onLocaleChangeComplete.add(a.Pe,a)}
e.load=function(a){"object"===typeof a&&null!==a?(this.M=a.i18n||!1,!0===this.M?(this.j="",this.B=a.url):this.j=a.url):(this.M=!1,this.j="","string"===typeof a&&(this.j=a));var b;!0===this.M&&"string"===typeof this.B&&""!==this.B?(this.J=new za(this.i,this.B),Yd(this),b=this.J.value):"string"===typeof this.j&&""!==this.j&&(b=this.j);"undefined"!==typeof b&&Xd(this,b)};
e.destroy=function(){!1!==this.ib&&(null!==this.J&&(this.J.destroy(),this.J=null,this.i.i18n.onLocaleChangeComplete.remove(this.Pe,this)),null!==this.I&&(this.I.destroy(),this.I=null),null!==this.F&&(this.F.destroy(),this.F=null),this.S=this.f=null,T.prototype.destroy.call(this))};
Object.defineProperty(Wd.prototype,"i18nUrl",{get:function(){return this.B},set:function(a){if("string"===typeof a){this.M=!0;this.B=a;var b;""!==this.B&&(this.J=new za(this.i,this.B),Yd(this),b=this.J.value);"undefined"!==typeof b&&Xd(this,b)}}});Object.defineProperty(Wd.prototype,"url",{get:function(){return this.j},set:function(a){"string"===typeof a&&(this.M=!1,Xd(this,a))}});Object.defineProperty(Wd.prototype,"loaded",{get:function(){return this.P}});
Object.defineProperty(Wd.prototype,"onLoadStart",{get:function(){null===this.I&&(this.I=new q(this));return this.I}});Object.defineProperty(Wd.prototype,"onLoadComplete",{get:function(){null===this.F&&(this.F=new q(this));return this.F}});
function S(a,b){this.fa=b;this.F="";this.j=!1;this.I=null;this.V="";this.ea="rgb(0, 0, 0)";this.P=this.S=!0;this.Ca=0;this.M=this.Da=!1;this.$=null;this.Pa=!1;this.Ba=this.za=this.Aa=this.sa=this.ra=this.qa=this.pa=this.Oa=this.Ka=this.Ma=this.La=this.Ja=this.Ha="";this.ia=this.la=this.ma=this.f=this.Fa=null;this.ga=!1;this.B=this.J=null;T.call(this,a,null,"TextField")}S.prototype=Object.create(T.prototype);e=S.prototype;e.constructor=S;
e.Ea=function(){T.prototype.Ea.call(this);this.ma=this.cm.bind(this);this.la=this.Nl.bind(this);this.ia=this.Ml.bind(this);this.Fa=document.createElement("span");this.c.appendChild(this.Fa);"undefined"!==typeof this.fa&&null!==this.fa&&this.load(this.fa);this.i.display.register(this);Jd(this);Kd(this)};
e.ta=function(a){var b=a.property;-1!==b.toLowerCase().indexOf("width")&&"autoWidth"!==b&&(this.S=!1);-1!==b.toLowerCase().indexOf("height")&&"autoHeight"!==b&&(this.P=!1);T.prototype.ta.call(this,a)};e.ic=function(){Zd(this);T.prototype.ic.call(this)};function $d(a,b){b!==a.V&&(a.V=String(b),a.Fa.innerHTML=b,Zd(a),Ld(a),null!==a.J&&a.J.D());if(!1===a.j||!0===a.j&&!0===a.I.loaded)a.ga=!0,null!==a.B&&a.B.D()}
function Zd(a){if(!1!==a.kd()){if(!0===a.S){var b=a.pixelWidth;a.c.style.width="";var d=a.c.offsetWidth;0<d&&(d+=1);a.u=d;a.C="px";a.c.style.width=a.u+"px";b!==a.u&&a.ta({property:"autoWidth"})}!0===a.P&&(b=a.pixelHeight,a.c.style.height="",d=a.c.offsetHeight,0<d&&(d+=1),a.o=d,a.A="px",a.c.style.height=a.o+"px",b!==a.o&&a.ta({property:"autoHeight"}))}}function ae(a){null===a.I&&(a.I=new za(a.i,a.F));$d(a,a.I.value)}
function be(a){!1===a.i.i18n.onLocaleChangeComplete.has(a.Ye,a)&&a.i.i18n.onLocaleChangeComplete.add(a.Ye,a)}e.Ye=function(){this.log("_localeChangeComplete");!0===this.i.i18n.xb(this.F)&&(this.value=this.I.value)};
e.cm=function(){!0===this.M&&null===this.f&&(this.f=document.createElement("textarea"),this.f.style.position="absolute",this.f.style.top="0px",this.f.style.left="0px",this.f.style.width="100%",this.f.style.height="100%",this.f.style.resize="none",this.f.style.margin="0px",this.f.style.padding="0px",this.f.style.overflowX="hidden",this.f.style.overflowY="auto",this.f.style.boxSizing="border-box",this.f.value=this.V,this.f.addEventListener("input",this.la,!1),this.f.addEventListener("blur",this.ia,
!1),this.c.appendChild(this.f),this.f.focus())};e.Nl=function(){$d(this,this.f.value)};e.Ml=function(){this.If()};e.If=function(){null!==this.f&&(this.f.removeEventListener("input",this.la,!1),this.f.removeEventListener("blur",this.ia,!1),this.c.removeChild(this.f),this.f=null)};
e.load=function(a){this.ga=!1;"object"===typeof a&&null!==a?(a.color&&(this.color=a.color),a.font&&(this.font=a.font),a.fontFamily&&(this.fontFamily=a.fontFamily),a.fontWeight&&(this.fontWeight=a.fontWeight),a.fontSize&&(this.fontSize=a.fontSize),a.fontStyle&&(this.fontStyle=a.fontStyle),a.fontVariant&&(this.fontVariant=a.fontVariant),a.textAlign&&(this.textAlign=a.textAlign),a.textShadow&&(this.textShadow=a.textShadow),a.textDecoration&&(this.textDecoration=a.textDecoration),a.textOverflow&&(this.textOverflow=
a.textOverflow),a.textTransform&&(this.textTransform=a.textTransform),a.whiteSpace&&(this.whiteSpace=a.whiteSpace),a.wordWrap&&(this.wordWrap=a.wordWrap),a.lineHeight&&(this.lineHeight=a.lineHeight),a.autoWidth&&(this.autoWidth=a.autoWidth),a.autoHeight&&(this.autoHeight=a.autoHeight),a.padding&&(this.padding=a.padding),a.selectable&&(this.selectable=a.selectable),a.editable&&(this.editable=a.editable),this.j=a.i18n||!1,!0===this.j?this.F=a.value:this.value=a.value):"string"===typeof a&&(this.j=!1,
this.value=a);!0===this.j&&"string"===typeof this.F&&""!==this.F&&(ae(this),be(this))};e.destroy=function(){!1!==this.ib&&(null!==this.I&&(this.I.destroy(),this.I=null,this.i.i18n.onLocaleChangeComplete.remove(this.Ye,this)),this.If(),null!==this.B&&(this.B.destroy(),this.B=null),null!==this.J&&(this.J.destroy(),this.J=null),T.prototype.destroy.call(this))};
Object.defineProperty(S.prototype,"i18nValue",{get:function(){return this.F},set:function(a){"string"===typeof a&&(""===this.F&&be(this),this.j=!0,this.F=a,ae(this))}});Object.defineProperty(S.prototype,"i18n",{get:function(){return this.j}});Object.defineProperty(S.prototype,"value",{get:function(){return this.V},set:function(a){if("string"===typeof a||"number"===typeof a)this.j=!1,$d(this,a)}});
Object.defineProperty(S.prototype,"color",{get:function(){return this.ea},set:function(a){"string"===typeof a&&(this.ea=a,this.c.style.color=this.ea)}});Object.defineProperty(S.prototype,"font",{get:function(){return this.pa},set:function(a){"string"!==typeof a||2>a.split(" ").toString().length||(this.pa=a.replace(/"/g,'"'),this.c.style.font=this.pa)}});
Object.defineProperty(S.prototype,"fontFamily",{get:function(){return this.qa},set:function(a){"string"===typeof a&&(this.qa=a.replace(/"/g,'"'),this.c.style.fontFamily=this.qa,Zd(this))}});Object.defineProperty(S.prototype,"fontSize",{get:function(){return this.ra},set:function(a){if("number"===typeof a||"string"===typeof a)"number"===typeof a&&(a+="px"),this.ra=a,this.c.style.fontSize=this.ra}});
Object.defineProperty(S.prototype,"fontStyle",{get:function(){return this.sa},set:function(a){"string"===typeof a&&(this.sa=a,this.c.style.fontStyle=this.sa)}});Object.defineProperty(S.prototype,"fontWeight",{get:function(){return this.Aa},set:function(a){"string"===typeof a&&"number"===typeof a&&(this.Aa=a,this.c.style.fontWeight=this.Aa)}});Object.defineProperty(S.prototype,"fontVariant",{get:function(){return this.za},set:function(a){"string"===typeof a&&(this.za=a,this.c.style.fontVariant=this.za)}});
Object.defineProperty(S.prototype,"lineHeight",{get:function(){return this.Ba},set:function(a){if("number"===typeof a||"string"===typeof a)"number"===typeof a&&(a+="px"),this.Ba=a,this.c.style.lineHeight=this.Ba}});Object.defineProperty(S.prototype,"textAlign",{get:function(){return this.Ha},set:function(a){"string"===typeof a&&(this.Ha=a,this.c.style.textAlign=this.Ha)}});
Object.defineProperty(S.prototype,"textShadow",{get:function(){return this.La},set:function(a){"string"===typeof a&&(this.La=a,this.c.style.textShadow=this.La)}});Object.defineProperty(S.prototype,"textDecoration",{get:function(){return this.Ja},set:function(a){"string"===typeof a&&(this.Ja=a,this.c.style.textDecoration=this.Ja)}});Object.defineProperty(S.prototype,"textTransform",{get:function(){return this.Ma},set:function(a){"string"===typeof a&&(this.Ma=a,this.c.style.textTransform=this.Ma)}});
Object.defineProperty(S.prototype,"autoWidth",{get:function(){return this.S},set:function(a){"boolean"===typeof a&&(this.S=a,Zd(this))}});Object.defineProperty(S.prototype,"autoHeight",{get:function(){return this.P},set:function(a){"boolean"===typeof a&&(this.P=a,Zd(this))}});
Object.defineProperty(S.prototype,"padding",{get:function(){return this.Ca},set:function(a){if("number"===typeof a||"string"===typeof a)this.Ca=a="string"===typeof a?a.split(" ",4).toString().replace(/,/g," "):a+"px",this.c.style.padding=this.Ca}});
Object.defineProperty(S.prototype,"selectable",{get:function(){return this.Da},set:function(a){"boolean"===typeof a&&(this.Da=a,!1===this.Da?(!1===this.M&&!0===this.Sa&&(this.Sa=this.pointer.enabled=!1),this.c.style.O="none",this.c.style.webkitUserSelect="none",this.c.style.c="none",this.c.style.f="none",this.c.style.j="none"):(!1===this.pointer.enabled&&(this.Sa=this.pointer.enabled=!0),this.c.style.O="text",this.c.style.webkitUserSelect="text",this.c.style.c="text",this.c.style.f="text",this.c.style.j=
"inherit"))}});Object.defineProperty(S.prototype,"wordWrap",{get:function(){return this.Pa},set:function(a){"boolean"===typeof a&&(this.Pa=a,this.c.style.wordWrap=!1===this.Pa?"normal":"break-word")}});Object.defineProperty(S.prototype,"whiteSpace",{get:function(){return this.Oa},set:function(a){"string"===typeof a&&(this.Oa=a,this.c.style.whiteSpace=this.Oa)}});
Object.defineProperty(S.prototype,"textOverflow",{get:function(){return this.Ka},set:function(a){"string"===typeof a&&(this.Ka=a,this.c.style.textOverflow=this.Ka)}});
Object.defineProperty(S.prototype,"editable",{get:function(){return this.M},set:function(a){a=!!a;this.M!==a&&(this.M=a,!1===this.M?(this.c.removeEventListener("click",this.ma,null!==this&&!!this),this.i.keyboard.ze(this.$),this.$=null,this.pointer.enabled=!0,this.c.style.cursor="text"):(this.c.addEventListener("click",this.ma,null!==this&&!!this),this.$=new P(this.i,[13,27],this.If,null,null,null,this),this.i.keyboard.Rf(this.$),this.c.style.cursor="default"))}});
Object.defineProperty(S.prototype,"loaded",{get:function(){return this.ga}});Object.defineProperty(S.prototype,"onLoadComplete",{get:function(){null===this.B&&(this.B=new q(this));return this.B}});Object.defineProperty(S.prototype,"onValueChange",{get:function(){null===this.J&&(this.J=new q(this));return this.J}});function od(a,b){this.ga=b||null;this.F={};this.$=this.I=this.P="";this.j=this.J=null;this.S=this.V=!1;this.ea=0;t.call(this,a,null,"Button")}od.prototype=Object.create(t.prototype);e=od.prototype;
e.constructor=od;
e.Ea=function(){t.prototype.Ea.call(this);this.I="out";this.J=new I(this.i);this.J.onLoadComplete.add(this.Pd,this);this.J.onResize.add(this.Qd,this);this.Xb(this.J);this.j=new S(this.i);this.j.onLoadComplete.add(this.Pd,this);this.j.onResize.add(this.Qd,this);this.j.autoWidth=!0;this.j.autoHeight=!0;this.Xb(this.j);this.pointer.enabled=!0;this.pointer.cursor=Ed.Za;this.pointer.onEnter.add(this.um,this);this.pointer.onLeave.add(this.vm,this);this.pointer.onPressStart.add(this.Jk,this);this.pointer.onPressEnd.add(this.Ik,
this);this.i.display.register(this);Jd(this);Kd(this);this.i.i18n.onLocaleChangeComplete.add(this.Xg,this);this.load(this.ga)};e.um=function(){ce(this,"over")};e.vm=function(){ce(this,"out")};e.Jk=function(){ce(this,"down")};e.Ik=function(){ce(this,"over")};e.Xg=function(){ce(this,this.I)};e.Pd=function(a){this.log("_itemLoadComplete "+a.emitter.className);this.ea++;2===this.ea&&(this.log("_allItemsLoaded"),de(this),ee(this))};e.Qd=function(){de(this);ee(this)};function fe(a,b){a.P=b;ce(a,a.I)}
function ce(a,b){a.I=b;b=a.F[a.P];a.ea=0;var d=b.Sj(a.I);a.background=b.Qa("background",a.I);a.borderStyle=b.Qa("borderStyle",a.I);a.borderColor=b.Qa("borderColor",a.I);a.borderRadius=b.Qa("borderRadius",a.I);a.borderWidth=b.Qa("borderWidth",a.I);a.V=b.Qa("autoWidth",a.I);a.S=b.Qa("autoHeight",a.I);var g=b.Qa("label",a.I);"undefined"!==typeof g&&a.j.load(g);!0===d&&a.J.load(b.Qa("image",a.I))}
function de(a){a.log("_updateLayout");var b=a.F[a.P],d=b.Qa("align",a.I),g=b.Qa("padding",a.I),h=b.Qa("spacing",a.I);"label"===b.Qa("first",a.I)?(b=a.j,a=a.J):(b=a.J,a=a.j);switch(d){case "left":b.left=g;b.verticalCenter=!0;a.left=b.left+h+b.pixelWidth;a.verticalCenter=!0;break;case "right":b.right=g;b.verticalCenter=!0;a.right=b.right+h+b.pixelWidth;a.verticalCenter=!0;break;case "top":b.top=g;b.horizontalCenter=!0;a.top=b.top+b.pixelHeight+h;a.horizontalCenter=!0;break;case "bottom":b.bottom=g;
b.horizontalCenter=!0;a.bottom=b.bottom+h+b.pixelHeight;a.horizontalCenter=!0;break;default:b.horizontalCenter=!0,b.verticalCenter=!0,a.horizontalCenter=!0,a.verticalCenter=!0}}
function ee(a){a.log("_updateAutoSize");if(!1!==a.V||!1!==a.S){var b=a.F[a.P].Qa("padding",a.I);if(!0===a.V){var d=a.pixelWidth;a.u=Math.max(a.j.x+a.j.pixelWidth,a.J.x+a.J.pixelWidth)-Math.min(a.j.x,a.J.x)+2*b+2*a.N;a.C="px";a.c.style.width=a.u+"px";d!==a.pixelWidth&&a.ta({property:"autoWidth"})}!0===a.S&&(d=a.pixelHeight,a.o=Math.max(a.j.y+a.j.pixelHeight,a.J.y+a.J.pixelHeight)-Math.min(a.j.y,a.J.y)+2*b+2*a.N,a.A="px",a.c.style.height=a.o+"px",d!==a.pixelHeight&&a.ta({property:"autoHeight"}))}}
e.load=function(a){if("undefined"!==typeof a&&null!==a){if(!0===B.Ga(a.skins,"ButtonSkin"))for(var b=0,d=a.skins.length;b<d;b++)this.jc(a.skins[b]);else if("object"===typeof a.skins&&0<a.skins.length)for(var d=0,g=a.skins.length;d<g;d++)b=new ge(a.skins[d].name,a.skins[d].states),this.jc(b);B.T(a.skin,"ButtonSkin")?this.jc(a.skin):"object"===typeof a.skin&&(b=new ge(a.skin.name,a.skin.states),this.jc(b));!0===B.T(a["default"],"string")&&!0===this.Tj(a["default"])&&(this.$=a["default"])}a=this.F||
{};Object.keys(a).length||(b=new ge("default"),this.jc(b));""===this.$&&(this.$=this.F[Object.keys(a)[0]].name);fe(this,this.$)};e.jc=function(a,b){if(!1===B.T(a,"ButtonSkin"))throw"$_Button: Invalid button skin!";a.Hg("out");this.F[a.name]=a;!0===b&&fe(this,a.name)};e.vk=function(a){"string"===typeof a&&!0===B.T(this.F[a],"ButtonSkin")?fe(this,a):!0===B.T(a,"ButtonSkin")&&(this.F[a.name]===a?fe(this,a.name):"undefined"!==typeof this.F[a.name]&&null!==this.F[a.name]||this.jc(a,!0))};
e.Tj=function(a){return"undefined"!==typeof this.F[a]};e.jo=function(){this.F[this.P].Hg("out");fe(this,this.P)};
e.destroy=function(){this.i.i18n.onLocaleChangeComplete.remove(this.Xg,this);if("undefined"!==typeof this.F&&0<this.F.length)for(var a in this.F)this.F.hasOwnProperty(a)&&this.F[a].destroy();this.F={};null!==this.J&&(this.J.onLoadComplete.remove(this.Pd,this),this.J.onResize.remove(this.Qd,this),this.removeChild(this.J,!0),this.J=null);null!==this.j&&(this.j.onLoadComplete.remove(this.Pd,this),this.j.onResize.remove(this.Qd,this),this.removeChild(this.j,!0),this.j=null);t.prototype.destroy.call(this)};
Object.defineProperty(od.prototype,"skins",{get:function(){return this.F}});Object.defineProperty(od.prototype,"skin",{get:function(){return this.F[this.P]},set:function(a){this.vk(a)}});Object.defineProperty(od.prototype,"autoWidth",{get:function(){return this.V},set:function(a){"boolean"===typeof a&&(this.V=a,ee(this))}});Object.defineProperty(od.prototype,"autoHeight",{get:function(){return this.S},set:function(a){"boolean"===typeof a&&(this.S=a,ee(this))}});
function ge(a,b){this.j=a||"";this.f=B.kc(he,{});this.c=B.kc(b||{},{out:{},over:{},down:{}});l.call(this,"ButtonSkin")}ge.prototype=Object.create(l.prototype);ge.prototype.constructor=ge;
var ie={key:"",url:"",i18n:!1,keepRatio:!0,maximized:!1,alpha:1},je={value:"",i18n:!1,color:"",fontFamily:"",fontWeight:""},ke={name:"",background:"",borderStyle:"solid",borderColor:"",borderRadius:0,borderWidth:0,autoWidth:!0,autoHeight:!0,align:"center",padding:0,spacing:0,first:"image",image:ie,label:je},le={key:"",url:"",i18n:!1,keepRatio:!0,maximized:!1,alpha:1},me={value:"Button",i18n:!1,color:"",fontFamily:"",fontWeight:""},he={name:"default",background:"#eee",borderStyle:"solid",borderColor:"#555",
borderRadius:5,borderWidth:2,autoWidth:!0,autoHeight:!0,align:"left",padding:5,spacing:0,first:"image",image:le,label:me};ge.prototype.Hg=function(a){"undefined"!==typeof this.c[a]&&(this.f=this.c[a])};ge.prototype.Qa=function(a,b){b=B.he(this.c,b+"."+a,B.he(this.f,a,B.he(ke,a)));"object"===typeof b&&(b=B.kc(this.f[a],b));return b};ge.prototype.Sj=function(a){a=this.Qa("image",a);return"undefined"!==typeof a&&"string"===typeof a.url&&""!==a.url};
ge.prototype.m=function(a){a=this.Qa("label",a);return"undefined"!==typeof a&&"string"===typeof a.value&&""!==a.value};Object.defineProperty(ge.prototype,"name",{get:function(){return this.j}});Object.defineProperty(ge.prototype,"default",{get:function(){return this.f},set:function(a){this.f=a}});Object.defineProperty(ge.prototype,"out",{get:function(){return this.c.out},set:function(a){this.c.out=a}});
Object.defineProperty(ge.prototype,"over",{get:function(){return this.c.over},set:function(a){this.c.over=a}});Object.defineProperty(ge.prototype,"down",{get:function(){return this.c.down},set:function(a){this.c.down=a}});function ia(a){T.call(this,a,document.createElement("canvas"),"Canvas")}ia.prototype=Object.create(T.prototype);ia.prototype.constructor=ia;ia.prototype.Ea=function(){T.prototype.Ea.call(this);this.i.display.register(this);Jd(this);Kd(this)};
Object.defineProperty(ia.prototype,"context2D",{get:function(){return this.c.getContext("2d")}});Object.defineProperty(ia.prototype,"context3D",{get:function(){return this.c.getContext("webgl")}});Object.defineProperty(ia.prototype,"element",{get:function(){return this.c}});
function K(a,b,d,g,h){this.i=a;this.Rc=b;this.ac=d||null;this.F=null;this.Qc=g||ne.Hb;this.Xa="";this.J=null;this.I=this.B=-1;this.Pa=null;this.qb=!1;this.gb=null;this.bc=!1;this.fb=1;this.Sa=!1;this.sc=0;this.Eb=null;this.Bb=h||!1;this.Ic=[0,1,2,3];this.rc=!1;this.Da=this.V=this.Ba=this.Ca=this.Fa=this.La=this.qa=this.za=this.Ja=this.Oa=this.ia=this.ga=this.Ha=this.Ma=this.M=this.Ka=this.ra=this.sa=this.ea=this.$=this.fa=this.Aa=this.ma=this.pa=this.la=null;this.Db=this.P=!1;this.qc=this.tc=0;this.dc=
this.ec=this.j=this.Fb=this.rb=this.wb=this.sb=this.ub=this.vb=this.tb=this.S=null;T.call(this,a,null,"VideoHTML5")}K.prototype=Object.create(T.prototype);e=K.prototype;e.constructor=K;
e.Ea=function(){T.prototype.Ea.call(this);!0===this.Bb&&!1===oe(this)&&(this.log("$_VideoHTML5: can't manage ambisonic sound without Google Chrome Omnitone library and WebAudio API."),this.Bb=!1);this.O=this.Rc;ba(this);this.S=this.Lm.bind(this);this.tb=this.Mm.bind(this);this.vb=this.Om.bind(this);this.ub=this.Nm.bind(this);this.sb=this.Km.bind(this);this.wb=this.Pm.bind(this);this.rb=this.Jm.bind(this);this.Fb=this.Qm.bind(this);this.j=this.Am.bind(this);this.Pa=this.i.clock.create(!1);this.gb=
this.i.clock.create(!1);this.gb.Ze(500,this.Ll,this);this.i.audio.onVolumeChange.add(this.Wh,this);this.i.audio.onDisable.add(this.Vh,this);this.V=new q(this,!0);null!==this.ac&&this.load(this.ac);this.i.display.register(this,oe(this));Jd(this);Kd(this)};e.ta=function(a){var b=pe(this);null!==b&&null!==b.element&&(b.element.setAttribute("width",this.pixelWidth),b.element.setAttribute("height",this.pixelHeight));T.prototype.ta.call(this,a)};
function qe(a,b){for(var d,g=0,h=a.J.length;g<h;g++)if(d=a.J[g],d===b)return g;return-1}function re(a,b){if(null===a.J)return null;a=a.J[b];return null!==a&&"undefined"!==typeof a?a:null}function se(a){return re(a,a.B)}function pe(a){return re(a,a.I)}function te(a,b){a=pe(a);return null!==a&&null!==a.element?a.element[b]:0}
function ue(a,b){if(-1!==b){a.log("_destroyVideoAt "+b);b=a.J[b];var d=b.element;if("undefined"!==typeof d&&null!==d){d.removeEventListener("loadstart",a.j,!1);d.removeEventListener("durationchange",a.j,!1);d.removeEventListener("loadedmetadata",a.j,!1);d.removeEventListener("loadeddata",a.j,!1);d.removeEventListener("progress",a.j,!1);d.removeEventListener("canplay",a.j,!1);d.removeEventListener("canplaythrough",a.j,!1);d.removeEventListener("play",a.j,!1);d.removeEventListener("pause",a.j,!1);d.removeEventListener("timeupdate",
a.j,!1);d.removeEventListener("volumechange",a.j,!1);d.removeEventListener("seeked",a.j,!1);d.removeEventListener("ended",a.j,!1);d.removeEventListener("error",a.j,!1);d.removeEventListener("waiting",a.j,!1);d.removeEventListener("stalled",a.j,!1);d.removeEventListener("playing",a.j,!1);d.removeEventListener("error",a.S,!1);d.pause();d.src="";for(var g,h=0,k=d.children.length;h<k;h++)g=d.children[h],g.removeEventListener("error",a.S,!1),g.src="",d.removeChild(g);d.load();d.parentNode===a.c&&a.c.removeChild(d)}b.element=
null;null!==b.buffer&&(b.buffer.destroy(),b.buffer=null);null!==b.played&&(b.played.destroy(),b.played=null)}}
function ve(a,b,d){a.qb=d||!1;a.log("Requesting index: "+b+", force: "+a.qb);-1!==a.B&&a.B!==b&&we(a);d=b===a.B?!0:!1;a.B=b;null!==a.Fa&&a.Fa.D(b);if(b!==a.I&&!0!==d){d=a.B;var g=document.createElement("video");g.setAttribute("webkit-playsinline","webkit-playsinline");g.setAttribute("width",a.pixelWidth);g.setAttribute("height",a.pixelHeight);g.volume=0;g.crossOrigin="anonymous";g.id="FORGE-VideoHTML5-"+a.O+"-"+d;var h=new xe(g,"buffered"),k=new xe(g,"played");d=a.J[d];d.element=g;d.buffer=h;d.played=
k;d.lastTimeStamp=0;d.requestCount++;g=a.F[a.B];-1<a.I&&(d.element.addEventListener("loadstart",a.tb,!1),d.element.addEventListener("error",a.S,!1));h=document.createElement("source");h.addEventListener("error",a.S,!1);h.src=g.url;h.type=g.mimeType;d.element.appendChild(h);a.ec=a.vi.bind(a);!0===oe(a)?(a.f=a.i.audio.context,a.Eb=Omnitone.createFOADecoder(a.f,d.element,{channelMap:a.Ic}),a.dc=a.em.bind(a),a.Eb.initialize().then(a.ec,a.dc)):a.vi();-1===a.I?(a.log("No current video, set directly the current index"),
ye(a,b)):(a.Pa.add(2E4,a.bn,a),a.Pa.start())}}e.vi=function(){-1===this.B?pe(this).element.load():se(this).element.load()};e.em=function(){this.log("FOA decoder could not be initialized")};e.Mm=function(){var a=se(this).element;this.log("_onRequestLoadStart [readyState: "+a.readyState+"]");a.removeEventListener("loadstart",this.tb,!1);a.addEventListener("loadedmetadata",this.vb,!1)};
e.Om=function(){var a=se(this).element;this.log("_onRequestLoadedMetaData [readyState: "+a.readyState+"]");a.removeEventListener("loadedmetadata",this.vb,!1);a.addEventListener("loadeddata",this.ub,!1)};e.Nm=function(){var a=se(this).element;this.log("_onRequestLoadedData [readyState: "+a.readyState+"]");a.removeEventListener("loadeddata",this.ub,!1);!0===N.Dc?(a.addEventListener("play",this.sb,!1),a.play()):ye(this,this.B,!0)};
e.Km=function(){var a=se(this).element;this.log("_onRequestCanPlayBeforeSeek [readyState: "+a.readyState+"]");a.pause();a.removeEventListener("play",this.sb,!1);a.addEventListener("seeked",this.wb,!1);var b=this.currentTime;a.currentTime=!0===this.P&&!1===this.qb?b+6:b};
e.Pm=function(){var a=se(this).element;this.log("_onRequestSeeked [readyState: "+a.readyState+"]");a.removeEventListener("seeked",this.wb,!1);4===a.readyState?(a.removeEventListener("error",this.S,!1),ze(this)):a.addEventListener("canplay",this.rb,!1)};e.Jm=function(){var a=se(this).element;this.log("_onRequestCanPlayAfterSeek [readyState: "+a.readyState+"]");a.removeEventListener("canplay",this.rb,!1);a.removeEventListener("error",this.S,!1);ze(this)};
function ze(a){var b=pe(a);null!==b&&null!==b.element&&!1===a.qb&&(a.log("Current video listen to seek, wait both video to sync"),b.element.addEventListener("seeked",a.Fb,!1),a.Pa.Ze(10,a.kn,a));for(var b=se(a).element,d,g=0,h=b.children.length;g<h;g++)d=b.children[g],d.removeEventListener("error",a.S,!1);!0===a.qb&&ye(a,a.B)}e.Qm=function(){this.log("_onRequestSeekedWhileSync "+this.currentTime);var a=this.B;Ae(this,!1);ve(this,a)};
e.kn=function(){this.log("_videoSyncTimerLoop "+this.B);var a=se(this);null!==a&&this.currentTime>=a.element.currentTime&&this.currentTime<a.element.currentTime+.05&&ye(this,this.B)};e.bn=function(){this.log("_requestTimeOutHandler");Ae(this,!0)};e.Lm=function(a){this.log("_onRequestError");this.log(a);Ae(this,!0)};
function ye(a,b,d){if(b!==a.I){a.c.innerHTML="";var g=se(a);!0===a.P&&g.element.play();Be(a,g);g=pe(a);a.B=-1;a.I=b;b=pe(a);b.currentCount++;!0===d&&null!==g&&(b.element.currentTime=g.element.currentTime);d=b.element;d.addEventListener("loadstart",a.j,!1);d.addEventListener("durationchange",a.j,!1);d.addEventListener("loadedmetadata",a.j,!1);d.addEventListener("loadeddata",a.j,!1);d.addEventListener("progress",a.j,!1);d.addEventListener("canplay",a.j,!1);d.addEventListener("canplaythrough",a.j,!1);
d.addEventListener("play",a.j,!1);d.addEventListener("pause",a.j,!1);d.addEventListener("timeupdate",a.j,!1);d.addEventListener("volumechange",a.j,!1);d.addEventListener("seeked",a.j,!1);d.addEventListener("ended",a.j,!1);d.addEventListener("error",a.j,!1);d.addEventListener("waiting",a.j,!1);d.addEventListener("stalled",a.j,!1);d.addEventListener("playing",a.j,!1);a.c.appendChild(b.element);null!==g&&null!==g.element&&(g.element.removeEventListener("seeked",a.Fb,!1),d=qe(a,g),-1!==d&&ue(a,d));a.Pa.stop(!0);
null!==a.Ca&&a.Ca.D(a.I);""===a.Xa&&Ce(a,a.Qc)}}
e.Ll=function(){this.log("Auto quality timer loop");if(!1!==this.P&&-1===this.B){var a;a=pe(this);var b=a.element.currentTime;!1===a.element.playing?a=!1:b===a.lastTimeStamp?(a.lastTimeStamp=0,a=!0):(a.lastTimeStamp=b,a=!1);!0===a?(this.log("AutoQuality downgrade quality"),pe(this).leaveCount++,0<=this.I-1?ve(this,this.I-1,!0):this.log("Can't downgrade video quality anymore!")):(a=pe(this),!0===(null!==a&&null!==a.buffer&&a.buffer.ck(a.element.currentTime,6)?!0:!1)&&this.I!==this.F.length-1&&(a=this.I+
1,this.J[a].abortCount||this.J[a].leaveCount?this.log("AutoQuality do not attempt to load an already aborted video"):(this.log("AutoQuality upgrade quality"),ve(this,a))))}};function Ce(a,b){!1===N.Dc&&(b=ne.MANUAL,a.warn("Quality mode force to manual, you are not on desktop"));a.Xa===b||b!==ne.Hb&&b!==ne.MANUAL||(a.Xa=b,a.gb.stop(!1),a.Xa===ne.Hb&&a.gb.start(),null!==a.Da&&a.Da.D(a.Xa))}function Ae(a,b){var d=se(a);null!==d&&(!0===b&&d.abortCount++,we(a),a.Pa.stop(!0),null!==a.Ba&&a.Ba.D())}
function we(a){var b=se(a),d;null!==b&&(d=b.element,d.removeEventListener("loadstart",a.tb,!1),d.removeEventListener("loadedmetadata",a.vb,!1),d.removeEventListener("loadeddata",a.ub,!1),d.removeEventListener("play",a.sb,!1),d.removeEventListener("seeked",a.wb,!1),d.removeEventListener("canplay",a.rb,!1),d.removeEventListener("error",a.S,!1),b=qe(a,b),-1!==b&&ue(a,b),a.B=-1)}e.Wh=function(){Be(this)};
function Be(a,b){b=b||pe(a);null!==b&&null!==b.element&&!0===a.i.audio.enabled&&(b.element.volume=a.fb*a.i.audio.volume)}e.Vh=function(){var a=pe(this);null!==a&&null!==a.element&&!1===this.i.audio.enabled&&(a.element.volume=0)};
e.Am=function(a){var b=pe(this).element;this.log(a.type+" [readyState: "+b.readyState+"]");switch(a.type){case "loadstart":null!==this.la&&this.la.D(a);break;case "durationchange":null!==this.fa&&1===b.readyState&&this.fa.D(a);break;case "loadedmetadata":this.rc=!0;null!==this.pa&&this.pa.D(a);break;case "loadeddata":null!==this.ma&&this.ma.D(a);break;case "progress":null!==this.Aa&&this.Aa.D(a);break;case "canplay":this.Db=!0;null!==this.$&&this.$.D(a);break;case "canplaythrough":this.Db=!0;null!==
this.ea&&this.ea.D(a);break;case "play":null!==this.sa&&this.sa.D(a);break;case "pause":this.P=!1;null!==this.ra&&this.ra.D(a);break;case "timeupdate":null!==this.Ka&&this.Ka.D(a);break;case "volumechange":null!==this.Ma&&0!==b.readyState&&this.Ma.D(a);break;case "seeked":this.Db=!1;null!==this.Ha&&this.Ha.D(a);break;case "ended":this.P=!1;this.c.currentTime=0;this.qc++;!0===this.bc&&this.play(0);null!==this.ga&&this.ga.D(a);break;case "error":null!==this.ia&&this.ia.D(a);break;case "waiting":null!==
this.Oa&&this.Oa.D(a);break;case "stalled":null!==this.Ja&&this.Ja.D(a);break;case "playing":null!==this.za&&this.za.D(a);break;default:this.warn('The event "'+a.type+'" is not handled.')}};function oe(a){return!0===a.Bb&&!0===a.i.audio.useWebAudio&&"undefined"!==typeof Omnitone}e.update=function(){null!==this.Eb&&!0===this.P&&this.Eb.setRotationMatrixFromCamera(this.i.renderer.camera.modelViewInverse)};
e.load=function(a){if(null!==a)if(!0===B.T(a,"string")?a=[a]:!0===B.T(a,"VideoQuality")&&(a=[a]),!0===B.Ga(a,"string")){for(var b=[],d,g=0,h=a.length;g<h;g++)d=new De(a[g]),b.push(d);this.F=b}else!0===B.Ga(a,"VideoQuality")&&(this.F=a);null!==this.V&&this.V.D(this.F);if(null===this.F||!this.F.length)throw"$_VideoHTML5.load: Can't create video with no qualities set!";a=this.F.length;b=[];for(g=0;g<a;g++)d={index:g,element:null,buffer:null,played:null,requestCount:0,currentCount:0,abortCount:0,leaveCount:0,
lastTimeStamp:0},b[g]=d;this.J=b;ve(this,0)};e.play=function(a,b){this.currentTime=a;this.loop=b;a=pe(this);null!==a&&null!==a.element&&(a.element.play(),this.P=!0,this.tc++)};e.pause=function(){var a=pe(this);null!==a&&null!==a.element&&(a.element.pause(),this.P=!1)};e.stop=function(){var a=pe(this);null!==a&&null!==a.element&&(a.element.pause(),a.element.currentTime=0,this.P=!1)};e.Al=function(){!0===this.P||!1===this.i.audio.enabled?this.pause():this.play()};
e.bb=function(){!0!==this.Sa&&!1!==this.i.audio.enabled&&(this.Sa=!0,this.sc=this.fb,this.fb=0,Be(this),null!==this.qa&&this.qa.D())};e.Xh=function(a){!1!==this.Sa&&(a="number"===typeof a?a:this.sc,this.Sa=!1,this.fb=G.X(a,0,1),Be(this),null!==this.La&&this.La.D())};
e.destroy=function(){we(this);this.Pa.destroy();this.Pa=null;this.gb.destroy();this.gb=null;null!==this.la&&(this.la.destroy(),this.la=null);null!==this.pa&&(this.pa.destroy(),this.pa=null);null!==this.ma&&(this.ma.destroy(),this.ma=null);null!==this.Aa&&(this.Aa.destroy(),this.Aa=null);null!==this.fa&&(this.fa.destroy(),this.fa=null);null!==this.$&&(this.$.destroy(),this.$=null);null!==this.ea&&(this.ea.destroy(),this.ea=null);null!==this.sa&&(this.sa.destroy(),this.sa=null);null!==this.ra&&(this.ra.destroy(),
this.ra=null);null!==this.Ka&&(this.Ka.destroy(),this.Ka=null);null!==this.M&&(this.M.destroy(),this.M=null);null!==this.Ma&&(this.Ma.destroy(),this.Ma=null);null!==this.Ha&&(this.Ha.destroy(),this.Ha=null);null!==this.ga&&(this.ga.destroy(),this.ga=null);null!==this.ia&&(this.ia.destroy(),this.ia=null);null!==this.Oa&&(this.Oa.destroy(),this.Oa=null);null!==this.Ja&&(this.Ja.destroy(),this.Ja=null);null!==this.za&&(this.za.destroy(),this.za=null);null!==this.qa&&(this.qa.destroy(),this.qa=null);
null!==this.La&&(this.La.destroy(),this.La=null);null!==this.Fa&&(this.Fa.destroy(),this.Fa=null);null!==this.Ca&&(this.Ca.destroy(),this.Ca=null);null!==this.Ba&&(this.Ba.destroy(),this.Ba=null);null!==this.Da&&(this.Da.destroy(),this.Da=null);null!==this.V&&(this.V.destroy(),this.V=null);for(var a=0,b=this.J.length;a<b;a++)ue(this,a);this.j=this.Fb=this.rb=this.wb=this.sb=this.ub=this.vb=this.tb=this.S=this.dc=this.ec=null;this.i.audio.onVolumeChange.remove(this.Wh,this);this.i.audio.onDisable.remove(this.Vh,
this);this.J=this.F=this.ac=null;T.prototype.destroy.call(this)};Object.defineProperty(K.prototype,"quality",{get:function(){return this.F[this.I]},set:function(a){if("number"===typeof a&&0<=a&&a<this.F.length)Ce(this,ne.MANUAL),ve(this,a);else if(!0===B.T(a,"VideoQuality")){a:{for(var b,d=0,g=this.F.length;d<g;d++)if(b=this.F[d],b===a){a=d;break a}a=-1}if(-1!==a)Ce(this,ne.MANUAL),ve(this,a);else throw"Unknown quality";}else throw"Video quality "+a+" out of bounds";}});
Object.defineProperty(K.prototype,"qualityMode",{get:function(){return this.Xa},set:function(a){a!==ne.Hb&&a!==ne.MANUAL||Ce(this,a)}});Object.defineProperty(K.prototype,"qualities",{get:function(){return this.F}});Object.defineProperty(K.prototype,"requestIndex",{get:function(){return this.B}});Object.defineProperty(K.prototype,"currentIndex",{get:function(){return this.I}});Object.defineProperty(K.prototype,"videos",{get:function(){return this.J}});
Object.defineProperty(K.prototype,"element",{get:function(){var a=pe(this);return null!==a&&null!==a.element?a.element:null}});Object.defineProperty(K.prototype,"buffer",{get:function(){var a=pe(this);return null!==a&&null!==a.buffer?a.buffer:null}});Object.defineProperty(K.prototype,"played",{get:function(){var a=pe(this);return null!==a&&null!==a.played?a.played:null}});Object.defineProperty(K.prototype,"originalWidth",{get:function(){return te(this,"videoWidth")}});
Object.defineProperty(K.prototype,"originalHeight",{get:function(){return te(this,"videoHeight")}});Object.defineProperty(K.prototype,"currentTime",{get:function(){return te(this,"currentTime")},set:function(a){if("number"===typeof a){var b=pe(this);null!==b&&null!==b.element&&(b.element.currentTime=a,null!==this.M&&this.M.D(a))}}});Object.defineProperty(K.prototype,"currentTimeMS",{get:function(){return 1E3*this.currentTime},set:function(a){this.currentTime=a/1E3}});
Object.defineProperty(K.prototype,"remainingTime",{get:function(){return this.duration-this.currentTime}});Object.defineProperty(K.prototype,"duration",{get:function(){return te(this,"duration")}});Object.defineProperty(K.prototype,"durationMS",{get:function(){return Math.round(1E3*this.duration)}});Object.defineProperty(K.prototype,"playing",{get:function(){return this.P}});Object.defineProperty(K.prototype,"playCount",{get:function(){return this.tc}});
Object.defineProperty(K.prototype,"canPlay",{get:function(){return this.Db}});Object.defineProperty(K.prototype,"endCount",{get:function(){return this.qc}});Object.defineProperty(K.prototype,"metaDataLoaded",{get:function(){return this.rc}});Object.defineProperty(K.prototype,"loop",{get:function(){return this.bc},set:function(a){"boolean"===typeof a&&(this.bc=a)}});
Object.defineProperty(K.prototype,"volume",{get:function(){return this.fb},set:function(a){"number"===typeof a&&(this.fb=G.X(a,0,1),this.Sa=!1,Be(this))}});Object.defineProperty(K.prototype,"muted",{get:function(){return this.Sa},set:function(a){!0===!!a?this.bb():this.Xh()}});Object.defineProperty(K.prototype,"ambisonic",{get:function(){return this.Bb}});Object.defineProperty(K.prototype,"onLoadStart",{get:function(){null===this.la&&(this.la=new q(this));return this.la}});
Object.defineProperty(K.prototype,"onLoadedMetaData",{get:function(){null===this.pa&&(this.pa=new q(this));return this.pa}});Object.defineProperty(K.prototype,"onLoadedData",{get:function(){null===this.ma&&(this.ma=new q(this));return this.ma}});Object.defineProperty(K.prototype,"onProgress",{get:function(){null===this.Aa&&(this.Aa=new q(this));return this.Aa}});Object.defineProperty(K.prototype,"onDurationChange",{get:function(){null===this.fa&&(this.fa=new q(this));return this.fa}});
Object.defineProperty(K.prototype,"onCanPlay",{get:function(){null===this.$&&(this.$=new q(this));return this.$}});Object.defineProperty(K.prototype,"onCanPlayThrough",{get:function(){null===this.ea&&(this.ea=new q(this));return this.ea}});Object.defineProperty(K.prototype,"onPlay",{get:function(){null===this.sa&&(this.sa=new q(this));return this.sa}});Object.defineProperty(K.prototype,"onPause",{get:function(){null===this.ra&&(this.ra=new q(this));return this.ra}});
Object.defineProperty(K.prototype,"onTimeUpdate",{get:function(){null===this.Ka&&(this.Ka=new q(this));return this.Ka}});Object.defineProperty(K.prototype,"onCurrentTimeChange",{get:function(){null===this.M&&(this.M=new q(this));return this.M}});Object.defineProperty(K.prototype,"onVolumeChange",{get:function(){null===this.Ma&&(this.Ma=new q(this));return this.Ma}});Object.defineProperty(K.prototype,"onSeeked",{get:function(){null===this.Ha&&(this.Ha=new q(this));return this.Ha}});
Object.defineProperty(K.prototype,"onEnded",{get:function(){null===this.ga&&(this.ga=new q(this));return this.ga}});Object.defineProperty(K.prototype,"onError",{get:function(){null===this.ia&&(this.ia=new q(this));return this.ia}});Object.defineProperty(K.prototype,"onWaiting",{get:function(){null===this.Oa&&(this.Oa=new q(this));return this.Oa}});Object.defineProperty(K.prototype,"onStalled",{get:function(){null===this.Ja&&(this.Ja=new q(this));return this.Ja}});
Object.defineProperty(K.prototype,"onPlaying",{get:function(){null===this.za&&(this.za=new q(this));return this.za}});Object.defineProperty(K.prototype,"onMute",{get:function(){null===this.qa&&(this.qa=new q(this));return this.qa}});Object.defineProperty(K.prototype,"onUnmute",{get:function(){null===this.La&&(this.La=new q(this));return this.La}});Object.defineProperty(K.prototype,"onQualityRequest",{get:function(){null===this.Fa&&(this.Fa=new q(this));return this.Fa}});
Object.defineProperty(K.prototype,"onQualityChange",{get:function(){null===this.Ca&&(this.Ca=new q(this));return this.Ca}});Object.defineProperty(K.prototype,"onQualityAbort",{get:function(){null===this.Ba&&(this.Ba=new q(this));return this.Ba}});Object.defineProperty(K.prototype,"onQualityModeChange",{get:function(){null===this.Da&&(this.Da=new q(this));return this.Da}});Object.defineProperty(K.prototype,"onQualitiesLoaded",{get:function(){null===this.V&&(this.V=new q(this,!0));return this.V}});
function J(a,b,d,g){this.i=a;this.Il=b;this.Qc=d||null;this.Sa="";this.Fa=null;this.Hl=g||ne.Hb;this.Oa="";this.j=null;this.Rc=!1;this.Ka=1;this.Ca=!1;this.ii=0;this.fi=!1;this.Xa=this.f=null;this.gf=this.ff=this.Ha=this.Pa=0;this.gb=this.Aa=this.tc=this.Ic=null;this.fb=this.Da=!1;this.ei=this.ji=0;this.Bb=this.jf=this.bc=this.dc=this.Fb=this.qc=this.La=this.tb=this.ec=this.sc=this.rc=this.Db=this.Eb=this.rb=this.qb=this.sb=this.ac=this.vb=this.wb=this.ub=this.Ba=this.ma=this.B=this.Ja=this.la=this.pa=
this.ga=this.ra=this.P=this.M=this.qa=this.za=this.Ma=this.sa=this.ea=this.fa=this.I=this.F=this.J=this.ia=this.V=this.$=this.S=null;T.call(this,a,null,"VideoDash")}J.prototype=Object.create(T.prototype);J.prototype.constructor=J;var Ee={VIDEO:"video",AUDIO:"audio"};e=J.prototype;
e.Ea=function(){T.prototype.Ea.call(this);if("undefined"===typeof dashjs)throw"$_VideoDash._boot: Can't create MPEG-DASH video stream without dash.js Media Player.";this.O=this.Il;ba(this);this.ub=this.Cm.bind(this);this.sb=this.ym.bind(this);this.wb=this.vl.bind(this);this.vb=this.Dm.bind(this);this.ac=this.Gm.bind(this);this.qb=this.xm.bind(this);this.rb=this.tl.bind(this);this.Eb=this.xl.bind(this);this.Db=this.wl.bind(this);this.rc=this.Vm.bind(this);this.sc=this.$m.bind(this);this.ec=this.Sm.bind(this);
this.tb=this.ul.bind(this);this.La=this.zm.bind(this);this.qc=this.Tm.bind(this);this.Fb=this.Fm.bind(this);this.dc=this.Im.bind(this);this.bc=this.Hm.bind(this);this.jf=this.Um.bind(this);this.Bb=this.Em.bind(this);this.i.audio.onVolumeChange.add(this.Th,this);this.i.audio.onDisable.add(this.Sh,this);this.B=new q(this,!0);null!==this.Qc&&this.load(this.Qc);this.i.display.register(this);Jd(this);Kd(this)};
e.ta=function(a){var b=this.j;null!==b&&null!==b.element&&(b.element.setAttribute("width",this.pixelWidth),b.element.setAttribute("height",this.pixelHeight));T.prototype.ta.call(this,a)};function Fe(a,b){a=a.j;return null!==a&&null!==a.element?a.element[b]:0}
e.Cm=function(a){this.log("onLoadStart [readyState: "+this.j.element.readyState+"]");var b=this.Sa,d=this.f.getBitrateInfoListFor(Ee.VIDEO),g=[],h;if(null!==d){for(var k=0,n=d.length;k<n;k++)h=new De(b),h.id=d[k].qualityIndex,h.bitrate=d[k].bitrate,h.width=d[k].width,h.height=d[k].height,g.push(h);this.Fa=g;null!==this.B&&this.B.D(g)}else this.destroy();null!==this.S&&this.S.D(a)};e.Um=function(a){this.log("_onSwitchCompleted [readyState: "+this.j.element.readyState+"]");this.Xa=a.toStreamInfo};
e.Em=function(a){this.log("_onMetricsChangedHandler [readyState: "+this.j.element.readyState+"]");null===this.Ic&&(this.Ic=this.f.getMetricsFor(Ee.VIDEO));null===this.tc&&(this.tc=this.f.getMetricsFor(Ee.AUDIO));null===this.Aa&&(this.Aa=this.f.getDashMetrics());if(null!==this.Ba){var b;a.mediaType===Ee.VIDEO&&(b=Ge(this,Ee.VIDEO,this.Ic,this.Aa))&&(this.gb={videoBitrate:b.bitrate,videoIndex:b.index,videoPendingIndex:b.nk,videoMaxIndex:b.hk,videoBufferLength:b.kj,videoDroppedFrames:b.droppedFrames});
a.mediaType===Ee.AUDIO&&(b=Ge(this,Ee.AUDIO,this.tc,this.Aa))&&(this.gb={audioBitrate:b.bitrate,audioIndex:b.index,audioPendingIndex:b.nk,audioMaxIndex:b.hk,audioBufferLength:b.kj,audioDroppedFrames:b.droppedFrames});this.Ba.D(a)}};
function Ge(a,b,d,g){if(null!==d&&null!==g){var h=a.Xa.index,k,n,v,x,E,Cb;k=g.getCurrentRepresentationSwitch(d);null!==k&&(n=Math.round(g.getBandwidthForRepresentation(k.to,h)/1E3));if(isNaN(n)||void 0===n)n=0;b===Ee.VIDEO?(v=a.Pa+1,x=a.Ha+1):b===Ee.AUDIO&&(v=a.ff+1,x=a.gf+1);if(isNaN(v)||void 0===v)v=0;if(isNaN(x)||void 0===x)x=0;a=g.getMaxIndexForBufferType(b,h);if(isNaN(a)||void 0===a)a=0;b=g.getCurrentBufferLevel(d);null!==b&&(E=b.toPrecision(5));if(isNaN(E)||void 0===E)E=0;d=g.getCurrentDroppedFrames(d);
null!==d&&(Cb=d.droppedFrames);return{bitrate:n,index:v,nk:x,hk:a,kj:E,droppedFrames:Cb}}return null}e.Hm=function(a){this.log("onQualityChange [readyState: "+this.j.element.readyState+"]");a.mediaType===Ee.AUDIO?this.gf=this.ff=a.newQuality:a.mediaType===Ee.VIDEO&&(this.Ha=this.Pa=a.newQuality,null!==this.la&&this.la.D(this.Ha))};
e.Im=function(a){this.log("onQualityRequest [readyState: "+this.j.element.readyState+"]");a.mediaType===Ee.AUDIO?(this.ff=a.oldQuality,this.gf=a.newQuality):a.mediaType===Ee.VIDEO&&(this.Pa=a.oldQuality,this.Ha=a.newQuality,null!==this.pa&&this.pa.D(this.Ha))};e.ym=function(a){var b=this.j.element;this.log("onDurationChange [readyState: "+b.readyState+"]");null!==this.J&&1===b.readyState&&this.J.D(a)};
e.vl=function(a){this.log("onLoadedMetaData [readyState: "+this.j.element.readyState+"]");this.fi=!0;null!==this.$&&this.$.D(a)};e.Dm=function(a){this.log("onLoadedData [readyState: "+this.j.element.readyState+"]");null!==this.V&&this.V.D(a)};e.Gm=function(a){null!==this.ia&&this.ia.D(a)};e.xm=function(a){this.log("onCanPlay [readyState: "+this.j.element.readyState+"]");this.fb=!0;null!==this.F&&this.F.D(a)};
e.tl=function(a){this.log("onCanPlayThrough [readyState: "+this.j.element.readyState+"]");this.fb=!0;null!==this.I&&this.I.D(a)};e.xl=function(a){this.log("onPlay [readyState: "+this.j.element.readyState+"]");null!==this.fa&&this.fa.D(a)};e.wl=function(a){this.log("onPause [readyState: "+this.j.element.readyState+"]");this.Da=!1;null!==this.ea&&this.ea.D(a)};e.Vm=function(a){null!==this.sa&&this.sa.D(a)};
e.$m=function(a){var b=this.j.element;this.log("onVolumeChange [readyState: "+b.readyState+"]");null!==this.za&&0!==b.readyState&&this.za.D(a)};e.Sm=function(a){this.log("onSeeked [readyState: "+this.j.element.readyState+"]");this.fb=!1;null!==this.qa&&this.qa.D(a)};e.ul=function(a){this.log("onEnded [readyState: "+this.j.element.readyState+"]");this.Da=!1;this.ei++;!0===this.Rc&&this.play();null!==this.M&&this.M.D(a)};
e.zm=function(a){this.log("onError [readyState: "+this.j.element.readyState+"]");null!==this.P&&this.P.D(a)};e.Tm=function(a){this.log("onStalled [readyState: "+this.j.element.readyState+"]");null!==this.ra&&this.ra.D(a)};e.Fm=function(a){this.log("onPlaying [readyState: "+this.j.element.readyState+"]");null!==this.ga&&this.ga.D(a)};e.Sh=function(){var a=this.j;null!==a&&null!==a.element&&!1===this.i.audio.enabled&&this.f.setVolume(0)};e.Th=function(){He(this)};
function He(a){var b=a.j;null!==b&&null!==b.element&&!0===a.i.audio.enabled&&(a.f.setVolume(a.Ka*a.i.audio.volume),!0===a.Ca?a.f.setMute(!0):a.f.setMute(!1))}function Ie(a,b){a.Ha=b;if(null!==a.Xa&&null!==a.f&&!0===a.f.isReady()&&null!==a.Aa){var d=a.Xa.index,g=a.Aa.getMaxIndexForBufferType(Ee.VIDEO,d),d=a.Aa.getMaxIndexForBufferType(Ee.AUDIO,d),h=b;h>=g&&(h=g-1);0>h&&(h=0);b>=d&&(b=d-1);0>b&&(b=0);a.f.setQualityFor(Ee.VIDEO,h);a.f.setQualityFor(Ee.AUDIO,b)}He(a)}
function Je(a,b){a.Oa===b||b!==ne.Hb&&b!==ne.MANUAL||(a.Oa=b,null!==a.f&&!0===a.f.isReady()&&(b===ne.MANUAL?(a.f.setAutoSwitchQualityFor(Ee.VIDEO,!1),a.f.setAutoSwitchQualityFor(Ee.AUDIO,!1)):(a.f.setAutoSwitchQualityFor(Ee.VIDEO,!0),a.f.setAutoSwitchQualityFor(Ee.AUDIO,!0))),null!==a.ma&&a.ma.D(a.Oa))}
e.load=function(a){null!==a&&(!0===B.T(a,"string")?a=[a]:!0===B.T(a,"VideoQuality")&&(a=[a]),!0===B.Ga(a,"string")?this.Sa=a[0]:!0===B.Ga(a,"VideoQuality")&&(this.Sa=a[0].url));if(""===this.Sa)throw"$_VideoDash : Can't create video with no manifest!";this.j={index:0,element:null,buffer:null,played:null};a=document.createElement("video");a.setAttribute("webkit-playsinline","webkit-playsinline");a.setAttribute("width",this.pixelWidth);a.setAttribute("height",this.pixelHeight);a.volume=0;a.crossOrigin=
"anonymous";a.id="FORGE-VideoDash-"+this.O;var b=new xe(a,"buffered"),d=new xe(a,"played"),g=this.j;g.element=a;g.buffer=b;g.played=d;g.lastTimeStamp=0;this.f=dashjs.MediaPlayer().create();this.f.getDebug().setLogToBrowserConsole(!1);this.f.initialize();this.f.setAutoPlay(!1);this.f.attachView(this.j.element);this.f.attachSource(this.Sa);!0===this.f.isReady()&&(this.f.on(dashjs.MediaPlayer.events.CAN_PLAY,this.qb),this.f.on(dashjs.MediaPlayer.events.ERROR,this.La),this.f.on(dashjs.MediaPlayer.events.PLAYBACK_ENDED,
this.tb),this.f.on(dashjs.MediaPlayer.events.PLAYBACK_ERROR,this.La),this.f.on(dashjs.MediaPlayer.events.PLAYBACK_METADATA_LOADED,this.wb),this.f.on(dashjs.MediaPlayer.events.PLAYBACK_PAUSED,this.Db),this.f.on(dashjs.MediaPlayer.events.PLAYBACK_PROGRESS,this.ac),this.f.on(dashjs.MediaPlayer.events.PLAYBACK_SEEKED,this.ec),this.f.on(dashjs.MediaPlayer.events.PLAYBACK_STARTED,this.Eb),this.f.on(dashjs.MediaPlayer.events.PLAYBACK_TIME_UPDATED,this.rc),this.f.on(dashjs.MediaPlayer.events.QUALITY_CHANGE_RENDERED,
this.bc),this.f.on(dashjs.MediaPlayer.events.QUALITY_CHANGE_REQUESTED,this.dc),this.f.on(dashjs.MediaPlayer.events.STREAM_INITIALIZED,this.ub),this.f.on(dashjs.MediaPlayer.events.PLAYBACK_PLAYING,this.Fb),this.f.on(dashjs.MediaPlayer.events.BUFFER_EMPTY,this.qc),this.f.on(dashjs.MediaPlayer.events.PERIOD_SWITCH_COMPLETED,this.jf),this.f.on(dashjs.MediaPlayer.events.METRIC_CHANGED,this.Bb),this.j.element.addEventListener("loadeddata",this.vb,!1),this.j.element.addEventListener("durationchange",this.sb,
!1),this.j.element.addEventListener("canplaythrough",this.rb,!1),this.j.element.addEventListener("volumechange",this.sc,!1),this.c.innerHTML="",this.c.appendChild(this.j.element));""===this.Oa&&Je(this,this.Hl)};e.play=function(a,b){this.currentTime=a;this.loop=b;null!==this.f&&!0===this.f.isReady()&&(this.f.play(),this.Da=!0,this.ji++)};e.pause=function(){null!==this.f&&!0===this.f.isReady()&&(this.f.pause(),this.Da=!1)};
e.stop=function(){null!==this.f&&!0===this.f.isReady()&&(this.f.pause(),this.f.seek(0),this.j.element.currentTime=0,this.Da=!1)};e.zl=function(){!0===this.Da||!1===this.i.audio.enabled?this.pause():this.play()};e.bb=function(){!0!==this.Ca&&!1!==this.i.audio.enabled&&(this.Ca=!0,this.ii=this.Ka,this.Ka=0,He(this))};e.Uh=function(a){!1!==this.Ca&&(a="number"===typeof a?a:this.ii,this.Ca=!1,this.Ka=G.X(a,0,1),He(this))};e.yl=function(a){null!==this.f&&!0===this.f.isReady()&&this.f.enableBufferOccupancyABR(a)};
e.destroy=function(){this.log("_destroyVideo");null!==this.f&&!0===this.f.isReady()&&(this.f.off(dashjs.MediaPlayer.events.CAN_PLAY,this.qb),this.f.off(dashjs.MediaPlayer.events.ERROR,this.La),this.f.off(dashjs.MediaPlayer.events.PLAYBACK_ENDED,this.tb),this.f.off(dashjs.MediaPlayer.events.PLAYBACK_ERROR,this.La),this.f.off(dashjs.MediaPlayer.events.PLAYBACK_METADATA_LOADED,this.wb),this.f.off(dashjs.MediaPlayer.events.PLAYBACK_PAUSED,this.Db),this.f.off(dashjs.MediaPlayer.events.PLAYBACK_PROGRESS,
this.ac),this.f.off(dashjs.MediaPlayer.events.PLAYBACK_SEEKED,this.ec),this.f.off(dashjs.MediaPlayer.events.PLAYBACK_STARTED,this.Eb),this.f.off(dashjs.MediaPlayer.events.PLAYBACK_TIME_UPDATED,this.rc),this.f.off(dashjs.MediaPlayer.events.QUALITY_CHANGE_RENDERED,this.bc),this.f.off(dashjs.MediaPlayer.events.QUALITY_CHANGE_REQUESTED,this.dc),this.f.off(dashjs.MediaPlayer.events.STREAM_INITIALIZED,this.ub),this.f.off(dashjs.MediaPlayer.events.PLAYBACK_PLAYING,this.Fb),this.f.off(dashjs.MediaPlayer.events.BUFFER_EMPTY,
this.qc),this.f.off(dashjs.MediaPlayer.events.PERIOD_SWITCH_COMPLETED,this.jf),this.f.off(dashjs.MediaPlayer.events.METRIC_CHANGED,this.Bb),this.j.element.removeEventListener("loadeddata",this.vb,!1),this.j.element.removeEventListener("durationchange",this.sb,!1),this.j.element.removeEventListener("canplaythrough",this.rb,!1),this.j.element.removeEventListener("volumechange",this.sc,!1),this.f.pause(),this.f.reset());var a=this.j,b=a.element;"undefined"!==typeof b&&null!==b&&b.parentNode===this.c&&
this.c.removeChild(b);a.element=null;null!==a.buffer&&(a.buffer.destroy(),a.buffer=null);null!==a.played&&(a.played.destroy(),a.played=null);null!==this.S&&(this.S.destroy(),this.S=null);null!==this.$&&(this.$.destroy(),this.$=null);null!==this.V&&(this.V.destroy(),this.V=null);null!==this.ia&&(this.ia.destroy(),this.ia=null);null!==this.J&&(this.J.destroy(),this.J=null);null!==this.F&&(this.F.destroy(),this.F=null);null!==this.I&&(this.I.destroy(),this.I=null);null!==this.fa&&(this.fa.destroy(),
this.fa=null);null!==this.ea&&(this.ea.destroy(),this.ea=null);null!==this.sa&&(this.sa.destroy(),this.sa=null);null!==this.Ma&&(this.Ma.destroy(),this.Ma=null);null!==this.za&&(this.za.destroy(),this.za=null);null!==this.qa&&(this.qa.destroy(),this.qa=null);null!==this.M&&(this.M.destroy(),this.M=null);null!==this.P&&(this.P.destroy(),this.P=null);null!==this.ra&&(this.ra.destroy(),this.ra=null);null!==this.ga&&(this.ga.destroy(),this.ga=null);null!==this.pa&&(this.pa.destroy(),this.pa=null);null!==
this.la&&(this.la.destroy(),this.la=null);null!==this.Ja&&(this.Ja.destroy(),this.Ja=null);null!==this.B&&(this.B.destroy(),this.B=null);null!==this.ma&&(this.ma.destroy(),this.ma=null);null!==this.Ba&&(this.Ba.destroy(),this.Ba=null);this.Bb=this.bc=this.dc=this.qc=this.Fb=this.La=this.tb=this.ec=this.sc=this.rc=this.Db=this.Eb=this.rb=this.qb=this.sb=this.ac=this.vb=this.wb=this.ub=null;this.i.audio.onVolumeChange.remove(this.Th,this);this.i.audio.onDisable.remove(this.Sh,this);this.j=this.Fa=this.Qc=
this.Xa=this.gb=this.Aa=this.tc=this.Ic=this.f=null;T.prototype.destroy.call(this)};Object.defineProperty(J.prototype,"monitoring",{get:function(){return this.gb}});
Object.defineProperty(J.prototype,"quality",{get:function(){return this.Fa[this.Pa]},set:function(a){if("number"===typeof a&&0<=a&&a<this.Fa.length)Je(this,ne.MANUAL),Ie(this,a);else if(!0===B.T(a,"VideoQuality")){a:{for(var b,d=0,g=this.Fa.length;d<g;d++)if(b=this.Fa[d],b===a){a=d;break a}a=-1}if(-1!==a)Je(this,ne.MANUAL),Ie(this,a);else throw"Unknown quality";}else throw"Video quality "+a+" out of bounds";}});
Object.defineProperty(J.prototype,"qualityMode",{get:function(){return this.Oa},set:function(a){a!==ne.Hb&&a!==ne.MANUAL||Je(this,a)}});Object.defineProperty(J.prototype,"qualities",{get:function(){return this.Fa}});Object.defineProperty(J.prototype,"requestIndex",{get:function(){return this.Ha}});Object.defineProperty(J.prototype,"currentIndex",{get:function(){return this.Pa}});Object.defineProperty(J.prototype,"video",{get:function(){return this.j}});
Object.defineProperty(J.prototype,"element",{get:function(){var a=this.j;return null!==a&&null!==a.element?a.element:null}});Object.defineProperty(J.prototype,"buffer",{get:function(){var a=this.j;return null!==a&&null!==a.buffer?a.buffer:null}});Object.defineProperty(J.prototype,"played",{get:function(){var a=this.j;return null!==a&&null!==a.played?a.played:null}});Object.defineProperty(J.prototype,"originalWidth",{get:function(){return Fe(this,"videoWidth")}});
Object.defineProperty(J.prototype,"originalHeight",{get:function(){return Fe(this,"videoHeight")}});Object.defineProperty(J.prototype,"currentTime",{get:function(){return this.f.time()},set:function(a){"number"===typeof a&&(this.f.seek(a),null!==this.Ma&&this.Ma.D(a))}});Object.defineProperty(J.prototype,"currentTimeMS",{get:function(){return 1E3*this.currentTime},set:function(a){this.currentTime=a/1E3}});Object.defineProperty(J.prototype,"remainingTime",{get:function(){return this.duration-this.currentTime}});
Object.defineProperty(J.prototype,"duration",{get:function(){return this.f.duration()}});Object.defineProperty(J.prototype,"durationMS",{get:function(){return Math.round(1E3*this.duration)}});Object.defineProperty(J.prototype,"playing",{get:function(){return this.Da}});Object.defineProperty(J.prototype,"playCount",{get:function(){return this.ji}});Object.defineProperty(J.prototype,"canPlay",{get:function(){return this.fb}});Object.defineProperty(J.prototype,"endCount",{get:function(){return this.ei}});
Object.defineProperty(J.prototype,"metaDataLoaded",{get:function(){return this.fi}});Object.defineProperty(J.prototype,"loop",{get:function(){return this.Rc},set:function(a){"boolean"===typeof a&&(this.Rc=a)}});Object.defineProperty(J.prototype,"volume",{get:function(){return this.Ka},set:function(a){"number"===typeof a&&(this.Ka=G.X(a,0,1),this.Ca=!1,He(this))}});Object.defineProperty(J.prototype,"muted",{get:function(){return this.Ca},set:function(a){!0===!!a?this.bb():this.Uh()}});
Object.defineProperty(J.prototype,"onLoadStart",{get:function(){null===this.S&&(this.S=new q(this));return this.S}});Object.defineProperty(J.prototype,"onLoadedMetaData",{get:function(){null===this.$&&(this.$=new q(this));return this.$}});Object.defineProperty(J.prototype,"onLoadedData",{get:function(){null===this.V&&(this.V=new q(this));return this.V}});Object.defineProperty(J.prototype,"onProgress",{get:function(){null===this.ia&&(this.ia=new q(this));return this.ia}});
Object.defineProperty(J.prototype,"onDurationChange",{get:function(){null===this.J&&(this.J=new q(this));return this.J}});Object.defineProperty(J.prototype,"onCanPlay",{get:function(){null===this.F&&(this.F=new q(this));return this.F}});Object.defineProperty(J.prototype,"onCanPlayThrough",{get:function(){null===this.I&&(this.I=new q(this));return this.I}});Object.defineProperty(J.prototype,"onPlay",{get:function(){null===this.fa&&(this.fa=new q(this));return this.fa}});
Object.defineProperty(J.prototype,"onPause",{get:function(){null===this.ea&&(this.ea=new q(this));return this.ea}});Object.defineProperty(J.prototype,"onTimeUpdate",{get:function(){null===this.sa&&(this.sa=new q(this));return this.sa}});Object.defineProperty(J.prototype,"onCurrentTimeChange",{get:function(){null===this.M&&(this.M=new q(this));return this.M}});Object.defineProperty(J.prototype,"onVolumeChange",{get:function(){null===this.za&&(this.za=new q(this));return this.za}});
Object.defineProperty(J.prototype,"onSeeked",{get:function(){null===this.qa&&(this.qa=new q(this));return this.qa}});Object.defineProperty(J.prototype,"onEnded",{get:function(){null===this.M&&(this.M=new q(this));return this.M}});Object.defineProperty(J.prototype,"onError",{get:function(){null===this.P&&(this.P=new q(this));return this.P}});Object.defineProperty(J.prototype,"onStalled",{get:function(){null===this.ra&&(this.ra=new q(this));return this.ra}});
Object.defineProperty(J.prototype,"onWaiting",{get:function(){return this.onStalled}});Object.defineProperty(J.prototype,"onPlaying",{get:function(){null===this.ga&&(this.ga=new q(this));return this.ga}});Object.defineProperty(J.prototype,"onQualityRequest",{get:function(){null===this.pa&&(this.pa=new q(this));return this.pa}});Object.defineProperty(J.prototype,"onQualityChange",{get:function(){null===this.la&&(this.la=new q(this));return this.la}});
Object.defineProperty(J.prototype,"onQualityAbort",{get:function(){null===this.Ja&&(this.Ja=new q(this));return this.Ja}});Object.defineProperty(J.prototype,"onMetricsChanged",{get:function(){null===this.Ba&&(this.Ba=new q(this));return this.Ba}});Object.defineProperty(J.prototype,"onQualitiesLoaded",{get:function(){null===this.B&&(this.B=new q(this,!0));return this.B}});Object.defineProperty(J.prototype,"onQualityModeChange",{get:function(){null===this.ma&&(this.ma=new q(this));return this.ma}});
function xe(a,b){this.c=a;this.f=b;l.call(this,"VideoTimeRanges")}xe.prototype=Object.create(l.prototype);xe.prototype.constructor=xe;
xe.prototype.j=function(a){var b=this.c[this.f];if(!this.length)return this.warn("No available range for now"),null;if(a>this.length-1)return this.warn("Time range out of bounds, returning the last available range"),this.j(this.length-1);if(0>a)return this.warn("Time range out of bounds, returning the first available range"),this.j(0);var d=b.start(a);a=b.end(a);return{start:d,end:a}};
xe.prototype.ck=function(a,b){"number"!==typeof b&&(b=0);for(var d=this.c[this.f],g,h,k=this.length;k--;)if(g=d.start(k),h=d.end(k),a>=g&&a+b<=h)return!0;return!1};Object.defineProperty(xe.prototype,"length",{get:function(){return this.c[this.f].length}});function De(a){this.m="";this.j=a||"";this.o=this.c="";this.f=this.u=this.A=0;l.call(this,"VideoQuality")}De.prototype=Object.create(l.prototype);De.prototype.constructor=De;
function Ke(a){var b=["mp4","webm","ogg"];a=Da(a);if(""!==a.extension&&-1!==b.indexOf(a.extension))return"video/"+a.extension;b=["mpd"];return""!==a.extension&&-1!==b.indexOf(a.extension)?"application/dash+xml":""}Object.defineProperty(De.prototype,"id",{get:function(){return this.m},set:function(a){if("number"===typeof a||"string"===typeof a)this.m=a}});Object.defineProperty(De.prototype,"url",{get:function(){return this.j},set:function(a){"string"===typeof a&&(this.j=a)}});
Object.defineProperty(De.prototype,"mimeType",{get:function(){""===this.c&&""!==this.j&&(this.c=Ke(this.j));return this.c}});Object.defineProperty(De.prototype,"name",{get:function(){return this.o},set:function(a){"string"===typeof a&&(this.o=a)}});Object.defineProperty(De.prototype,"framerate",{get:function(){return 0}});Object.defineProperty(De.prototype,"bitrate",{get:function(){return this.A},set:function(a){"number"===typeof a&&(this.A=a)}});
Object.defineProperty(De.prototype,"width",{get:function(){return this.u},set:function(a){"number"===typeof a&&(this.u=a)}});Object.defineProperty(De.prototype,"height",{get:function(){return this.f},set:function(a){"number"===typeof a&&(this.f=a)}});Object.defineProperty(De.prototype,"speed",{get:function(){return 1}});var ne={Hb:"auto",MANUAL:"manual"},Ma={bf:"dash",Gl:"html5",Kd:"unknown"};
function Vd(a){this.m=a;this.f={};this.c=null;this.j=[];l.call(this,"SpriteAnimationManager");!1===this.m.loaded&&this.m.onLoadComplete.da(this.gn,this)}Vd.prototype=Object.create(l.prototype);e=Vd.prototype;e.constructor=Vd;e.gn=function(){this.log("_spriteLoadComplete");for(var a,b,d=0,g=this.j.length;d<g;d++)a=this.j[d].method,b=this.j[d].args,Vd.prototype[a].apply(this,b);this.j=[]};
e.add=function(a,b,d,g,h){if(!1===this.m.loaded)this.j.push({method:"add",args:arguments});else{this.log("add");"string"!==typeof a&&(a="default");b=parseInt(b,10);d=parseInt(d,10);var k=this.m.frames;if("number"!==typeof b||!0===isNaN(b)||0>b||b>=k.length)b=0;if("number"!==typeof d||!0===isNaN(d)||0>d||d>=k.length)d=k.length;h="undefined"===typeof h?!1:!!h;this.f[a]=new W(this.m,a,k.slice(b,d),g||60);this.c=this.f[a]}};
e.play=function(a,b,d){if(!1===this.m.loaded)this.j.push({method:"play",args:arguments});else{var g=this.c;"string"===typeof a&&null!==a&&(g=this.get(a));null!==g&&g.play(b,d)}};e.pause=function(a){var b=this.c;null!==b&&b.pause(a)};e.resume=function(a){var b=this.c;null!==b&&b.resume(a)};e.stop=function(){var a=this.c;null!==a&&a.stop()};e.get=function(a){return!0===B.T(this.f[a],"SpriteAnimation")?this.f[a]:null};e.update=function(){null!==this.c&&this.c.update()};
e.destroy=function(){for(var a in this.f)this.f[a].destroy(),this.f[a]=null;this.j=this.c=this.f=this.m=null;l.prototype.destroy.call(this)};Object.defineProperty(Vd.prototype,"currentAnimation",{get:function(){return this.c},set:function(a){!0===B.T(a,"SpriteAnimation")&&(this.c=a)}});
function W(a,b,d,g){this.B=a;this.M=b;this.C=d||[];this.N=0;this.U=g||60;this.J=!1;this.W=0;this.G=1E3/g;this.F=this.K=0;this.R=1;this.I=this.c=this.H=!1;this.f=this.A=this.j=this.u=this.m=this.o=null;l.call(this,"SpriteAnimation")}W.prototype=Object.create(l.prototype);e=W.prototype;e.constructor=W;function Le(a,b){a.N="number"===typeof b&&0<=b&&b<a.C.length?b:0;a.B.frame=a.C[a.N].frame}
e.play=function(a,b){"boolean"===typeof a&&(this.J=a);this.H=!0;this.c=this.I=!1;this.W=0;this.K=this.B.viewer.clock.time+this.G;Le(this,b);this.B.animations.oo=this;null!==this.o&&this.o.D()};e.pause=function(a){!0!==this.c&&(this.c=!0,"number"===typeof a&&Le(this,a),null!==this.m&&this.m.D())};e.resume=function(a){!1!==this.c&&(this.c=!1,"number"===typeof a&&Le(this,a),this.H&&(this.K=this.B.viewer.clock.time+this.G),null!==this.u&&this.u.D())};
e.stop=function(){this.H=!1;this.I=!0;this.c=!1;Le(this,0);null!==this.A&&this.A.D()};
e.update=function(){if(!0!==this.c){var a=this.B.viewer.clock.time;!0===this.H&&a>=this.K&&(this.R=1,this.F=a-this.K,this.F>this.G&&(this.R=Math.floor(this.F/this.G),this.F-=this.R*this.G),this.K=a+(this.G-this.F),a=this.N+this.R,a>=this.C.length?!0===this.J?(a%=this.C.length,this.W++,null!==this.j&&this.j.D(),Le(this,a)):(Le(this,this.C.length-1),this.H=!1,this.I=!0,this.c=!1,null!==this.f&&this.f.D()):Le(this,a))}};
e.destroy=function(){this.C=this.B=null;null!==this.o&&(this.o.destroy(),this.o=null);null!==this.m&&(this.m.destroy(),this.m=null);null!==this.u&&(this.u.destroy(),this.u=null);null!==this.f&&(this.f.destroy(),this.f=null);null!==this.j&&(this.j.destroy(),this.j=null);null!==this.A&&(this.A.destroy(),this.A=null);l.prototype.destroy.call(this)};Object.defineProperty(W.prototype,"name",{get:function(){return this.M}});Object.defineProperty(W.prototype,"frames",{get:function(){return this.C}});
Object.defineProperty(W.prototype,"frameIndex",{get:function(){return this.N}});Object.defineProperty(W.prototype,"frameRate",{get:function(){return this.U},set:function(a){"number"===typeof a&&(this.U=a,this.G=1E3/this.U)}});Object.defineProperty(W.prototype,"loop",{get:function(){return this.J},set:function(a){this.J=!!a}});Object.defineProperty(W.prototype,"loopCount",{get:function(){return this.W}});Object.defineProperty(W.prototype,"playing",{get:function(){return this.H}});
Object.defineProperty(W.prototype,"paused",{get:function(){return this.c},set:function(a){!0===!!a?this.pause():this.resume()}});Object.defineProperty(W.prototype,"complete",{get:function(){return this.I}});Object.defineProperty(W.prototype,"onPlay",{get:function(){null===this.o&&(this.o=new q(this));return this.o}});Object.defineProperty(W.prototype,"onPause",{get:function(){null===this.m&&(this.m=new q(this));return this.m}});
Object.defineProperty(W.prototype,"onResume",{get:function(){null===this.u&&(this.u=new q(this));return this.u}});Object.defineProperty(W.prototype,"onLoop",{get:function(){null===this.j&&(this.j=new q(this));return this.j}});Object.defineProperty(W.prototype,"onComplete",{get:function(){null===this.f&&(this.f=new q(this));return this.f}});Object.defineProperty(W.prototype,"onStop",{get:function(){null===this.A&&(this.A=new q(this));return this.A}});
function va(a){this.i=a;this.O=new Me;this.m=new Me;this.f=new Me;this.c=new Me;this.j=0}var A={JSON:"json",Tb:"xml",IMAGE:"image",pb:"sound"},Ne={Oc:["forge","forgejs","FORGE"]};Ne.JSON=["forge.story.config"].concat(Ne.Oc);Ne.Tb=[].concat(Ne.Oc);Ne.IMAGE=[].concat(Ne.Oc);Ne.pb=[].concat(Ne.Oc);function Oe(a,b){var d=null;switch(b){case A.JSON:d=a.O;break;case A.Tb:d=a.m;break;case A.IMAGE:d=a.f;break;case A.pb:d=a.c}return d}
function Pe(a,b,d){var g=Oe(a,b),h=(d||"FORGE-cache")+"-"+a.j;a.j++;return!1===g.has(h)&&!1===Qe(b,h)?h:Pe(a,b,d)}function Qe(a,b){var d=null;switch(a){case A.JSON:d=Ne.JSON;break;case A.Tb:d=Ne.Tb;break;case A.IMAGE:d=Ne.IMAGE;break;case A.pb:d=Ne.pb}a=d;return null!==a?-1!==a.indexOf(b.toLowerCase()):!1}e=va.prototype;e.has=function(a,b){a=Oe(this,a);return null!==a?a.has(b):!1};e.get=function(a,b){return!0===this.has(a,b)&&(a=Oe(this,a),null!==a)?a.get(b):null};
e.add=function(a,b,d){var g;(g="string"!==typeof b||""===b)||(g=Oe(this,a),g=!0===(!0===Qe(a,b)&&!0===g.has(b)));g&&(b=Pe(this,a,a+"-cache"));return!1===this.has(b,a)&&(a=Oe(this,a),null!==a)?(a.set(b,d),!0):!1};e.remove=function(a,b){return!0===this.has(a,b)&&(a=Oe(this,a),null!==a)?(a.Re(b),!0):!1};e.destroy=function(){this.c=this.f=this.O=this.i=null};function Re(){}e=Re.prototype;e.key="";e.url="";e.type="";e.data=null;e.lo=null;e.zb=!1;e.Mk=!1;e.Lk="";e.constructor=Re;
function wa(a){this.i=a;l.call(this,"Loader")}wa.prototype=Object.create(l.prototype);e=wa.prototype;e.constructor=wa;e.json=function(a,b,d,g,h,k){var n=new Re;n.type="json";n.key=a;n.url=b;n.c=d;n.f=g;n.O=h;n.j=k;Se(this,n,"text",this.km,this.lm)};
e.km=function(a,b){if(b.responseText){if(a.data=Object(JSON.parse(b.responseText)),!1===this.i.cache.has(A.JSON,a.key)?this.i.cache.add(A.JSON,a.key,a):this.log("$_Loader.json : JSON file already exists"),"function"===typeof a.c&&null!==a.f){b=a.c;var d=a.f;a.c=null;a.f=null;a.O=null;a.j=null;b.call(d,a)}}else throw"$_Loader.json : JSON file empty ?";};
e.lm=function(a,b){if(b.responseText){if("function"===typeof a.O&&null!==a.j){b=a.O;var d=a.j;a.c=null;a.f=null;a.O=null;a.j=null;b.call(d,a)}}else throw"$_Loader.json : JSON file empty ?";};e.Sk=function(a,b,d,g,h,k){h=new Re;h.type="xml";h.key=a;h.url=b;h.c=d;h.f=g;h.O=d;h.j=k;Se(this,h,"document",this.ln,this.mn)};
e.ln=function(a,b){if(b.responseXML){if(a.data=b.responseXML,!1===this.i.cache.has(A.Tb,a.key)?this.i.cache.add(A.Tb,a.key,a):this.log("$_Loader.xml : XML file already exists"),"function"===typeof a.c&&null!==a.f){b=a.c;var d=a.f;a.c=null;a.f=null;a.O=null;a.j=null;b.call(d,a)}}else throw"$_Loader.xml : XML file empty ?";};
e.mn=function(a,b){if(b.responseXML){if("function"===typeof a.O&&null!==a.j){b=a.O;var d=a.j;a.c=null;a.f=null;a.O=null;a.j=null;b.call(d,a)}}else throw"$_Loader.xml : JSON file empty ?";};e.sound=function(a,b,d,g,h){var k=new Re;k.type="sound";k.key=a;k.url=b;k.c=d;k.f=g;!0===this.i.audio.useWebAudio&&!0!==h?Se(this,k,"arraybuffer",this.Vi):!0!==this.i.audio.useAudioTag&&!0!==h||Te(k,this.Vi,this)};
e.Vi=function(a,b){!0===this.i.audio.useWebAudio&&"undefined"!==typeof b&&(a.data=b.response);this.i.cache.add(A.pb,a.key,a);"function"===typeof a.c&&null!==a.f&&a.c.call(a.f,a)};
function Te(a,b,d){function g(){a.data.removeEventListener("canplay",g,!1);a.data.onerror=null;"function"===typeof b&&b.call(d,a)}a.data=new Audio;a.data.preload="auto";a.data.crossOrigin="anonymous";a.data.src=a.url;a.data.onerror=function(){a.data.removeEventListener("canplay",g,!1);a.data.onerror=null;throw"$_Loader._loadAudioTag : Could not load "+a.url;};a.data.addEventListener("canplay",g,!1);a.data.load()}
function Se(a,b,d,g,h){b.zb=!0;var k=new XMLHttpRequest;k.open("GET",b.url,!0);k.responseType=d;k.onreadystatechange=function(){if(k.readyState===XMLHttpRequest.DONE){if(200!==k.status&&k.status)throw"$_Loader._xhr : Could not load "+b.url;this.onreadystatechange=null;"function"===typeof g&&(b.loaded=!0,g.call(this,b,k))}}.bind(a);k.onerror=function(){"function"===typeof h&&h.call(this,b,k)}.bind(a);k.send()}
e.image=function(a,b,d,g){var h=new Re;h.type="image";h.key=a;h.url=b;h.data=new Image;h.data.crossOrigin="anonymous";h.data.onload=function(){h.data.onload=null;h.data.onerror=null;h.zb=!1;h.loaded=!0;this.i.cache.add(A.IMAGE,h.key,h);d.call(g,h)}.bind(this);h.data.onerror=function(){h.data.onload=null;h.data.onerror=null;throw"ERROR : $_Loader.image, failed to load image key : "+a+" at url "+b;};h.data.src=h.url;h.zb=!0};
e.Gg=function(a,b,d){for(var g=document.getElementsByTagName("head")[0],h=g.getElementsByTagName("script"),k=0,n=h.length;k<n;k++)if(h[k].src===a){this.warn("Attempt to load an already loaded script!");b.call(d);return}var v=document.createElement("script");v.type="text/javascript";v.onload=function(){v.onload=null;b.call(d)};v.src=a;g.appendChild(v)};
e.oj=function(a,b,d){var g=document.createElement("link");g.type="text/css";g.rel="stylesheet";"undefined"!==typeof b&&"undefined"!==typeof d&&(g.onload=function(){g.onload=null;b.call(d)});g.href=a;document.getElementsByTagName("head")[0].appendChild(g)};e.destroy=function(){this.i=null;l.prototype.destroy.call(this)};function ja(a){this.i=a;this.j=this.f=0;this.c=null;l.call(this,"DependencyManager")}ja.prototype=Object.create(l.prototype);ja.prototype.constructor=ja;
ja.prototype.add=function(a){"undefined"!==typeof a&&"string"===typeof a.url&&(this.f++,this.i.load.Gg(a.url,this.m,this))};ja.prototype.m=function(){this.j++;this.f-this.j||(console.log("DependencyManager : all scripts loaded"),null!==this.c&&this.c.D())};ja.prototype.destroy=function(){this.i=null;l.prototype.destroy.call(this)};Object.defineProperty(ja.prototype,"dependencies",{get:function(){return this.f}});
Object.defineProperty(ja.prototype,"onAllScriptsLoaded",{get:function(){null===this.c&&(this.c=new q(this));return this.c}});function ka(a){this.i=a;this.f=0;this.c=null;l.call(this,"Clock");this.f=Date.now();this.c=[]}ka.prototype=Object.create(l.prototype);e=ka.prototype;e.constructor=ka;e.Wm=function(a){a:{if(null!==this.c)for(var b,d=0,g=this.c.length;d<g;d++)if(b=this.c[d],b===a.emitter){a=d;break a}a=-1}-1!==a&&this.c.splice(a,1)};e.create=function(a){return this.add(new X(this.i,a))};
e.add=function(a){this.c.push(a);a.onDestroy.add(this.Wm,this);return a};e.update=function(){this.f=Date.now();for(var a=0,b=this.c.length;a<b;a++)this.c[a].update(this.f)};e.destroy=function(){this.i=null;for(var a=this.c.length;a--;)this.c[a].destroy();this.c=null};Object.defineProperty(ka.prototype,"time",{get:function(){return this.f}});
function X(a,b){this.i=a;this.J="undefined"!==typeof b?b:!0;this.B=0;this.j=!1;this.K=this.I=0;this.m=!1;this.f=0;this.F=!1;this.u=this.H=this.C=this.A=this.G=this.c=null;l.call(this,"Timer");this.c=[];this.f=Date.now()}X.prototype=Object.create(l.prototype);e=X.prototype;e.constructor=X;function Ue(a,b){for(var d=0;d<a.c.length;d++){var g=a.c[d];if(!1===g.f){var h=g.c-b;0>h&&(h=0);g.c=a.f+h}}b=a.o-b;a.o=0>b?a.f:a.f+b}function Ve(a){0<a.c.length&&(a.c.sort(a.fn),a.o=a.c[0].c)}
e.fn=function(a,b){return a.c<b.c?-1:a.c>b.c?1:0};e.create=function(a,b,d,g,h,k){var n=a=Math.round(a);this.f?n+=this.f:n+=this.i.clock.time;a=new We(0,a,n,d,b,g,h,k);this.c.push(a);Ve(this);this.F=!1;return a};e.add=function(a,b,d,g){return this.create(a,!1,0,b,d,Array.prototype.splice.call(arguments,3))};e.sl=function(a,b,d,g){return this.create(a,!1,b,d,g,Array.prototype.splice.call(arguments,4))};e.Ze=function(a,b,d){return this.create(a,!0,0,b,d,Array.prototype.splice.call(arguments,3))};
e.remove=function(a){for(var b=0;b<this.c.length;b++)if(this.c[b]===a)return this.c[b].f=!0;return!1};e.start=function(){if(!0!==this.j){this.B=this.i.clock.time;this.j=!0;for(var a,b=0;b<this.c.length;b++)a=this.c[b],a.c=a.delay+this.B;null!==this.G&&this.G.D()}};e.stop=function(a){this.j=!1;!1!==a&&(this.c.length=0);null!==this.H&&this.H.D()};e.pause=function(){!1!==this.j&&!0!==this.m&&(this.I=this.i.clock.time,this.m=!0,null!==this.A&&this.A.D())};
e.resume=function(){if(!1!==this.m){var a=this.i.clock.time;this.K+=a-this.f;this.f=a;Ue(this,this.I);this.m=!1;null!==this.C&&this.C.D()}};
e.update=function(a){if(!0!==this.m){var b=a-this.f;this.f=a;1E3<b&&Ue(this,a-b);for(a=this.c.length;a--;)!0===this.c[a].f&&this.c.splice(a,1);a=this.c.length;var d=b=0;if(!0===this.j&&this.f>=this.o&&0<a){for(var g;b<a&&!0===this.j;)if(g=this.c[b],this.f>=g.c&&!1===g.f){var h=this.f+g.delay-(this.f-g.c);0>h&&(h=this.f+g.delay);!0===g.loop?g.c=h:0<g.O?(g.O--,g.c=h):(d++,g.f=!0);g.yb();b++}else break;this.c.length>d?Ve(this):(this.F=!0,this.j=!1,null!==this.u&&this.u.D())}this.F&&this.J&&this.destroy()}};
e.destroy=function(){this.j=!1;this.c=[];l.prototype.destroy.call(this)};Object.defineProperty(X.prototype,"autoDestroy",{get:function(){return this.J}});Object.defineProperty(X.prototype,"running",{get:function(){return this.j}});Object.defineProperty(X.prototype,"paused",{get:function(){return this.m}});Object.defineProperty(X.prototype,"next",{get:function(){return this.o}});Object.defineProperty(X.prototype,"duration",{get:function(){return this.j&&this.o>this.f?this.o-this.f:0}});
Object.defineProperty(X.prototype,"length",{get:function(){return this.c.length}});Object.defineProperty(X.prototype,"ms",{get:function(){return this.j?this.f-this.B-this.K:0}});Object.defineProperty(X.prototype,"seconds",{get:function(){return this.j?.001*this.ms:0}});Object.defineProperty(X.prototype,"onStart",{get:function(){null===this.G&&(this.G=new q(this));return this.G}});Object.defineProperty(X.prototype,"onPause",{get:function(){null===this.A&&(this.A=new q(this));return this.A}});
Object.defineProperty(X.prototype,"onResume",{get:function(){null===this.C&&(this.C=new q(this));return this.C}});Object.defineProperty(X.prototype,"onStop",{get:function(){null===this.H&&(this.H=new q(this));return this.H}});Object.defineProperty(X.prototype,"onComplete",{get:function(){null===this.u&&(this.u=new q(this));return this.u}});function We(a,b,d,g,h,k,n,v){this.delay=b;this.c=d;this.O=g-1;this.loop=h;this.m=k;this.o=n;this.j=v;this.f=!1}We.prototype.constructor=We;
We.prototype.yb=function(){this.m.apply(this.o,this.j)};function xa(a){this.i=a;this.c=[];l.call(this,"TweenManager")}xa.prototype=Object.create(l.prototype);e=xa.prototype;e.constructor=xa;e.jn=function(a){this.remove(a.emitter)};e.add=function(a){this.c.push(a);a.onDestroy.da(this.jn,this)};e.remove=function(a){a:{for(var b=0,d=this.c.length;b<d;b++)if(a===this.c[b]){a=b;break a}a=-1}-1!==a&&this.c.splice(a,1)};e.update=function(){for(var a=0,b=this.c.length;a<b;a++)this.c[a].update()};
e.destroy=function(){for(var a=this.c.length;a--;)this.c[a].destroy();this.i=this.c=null;l.prototype.destroy.call(this)};function Ab(a,b){this.i=a;this.C=b;this.f=null;this.c=Cd.LINEAR;this.H=null;this.A=this.G=this.B=!1;this.u=this.j=this.m=this.o=null;l.call(this,"Tween")}Ab.prototype=Object.create(l.prototype);e=Ab.prototype;e.constructor=Ab;
e.$e=function(a,b,d){null===this.f&&(this.f={});for(var g in a)this.f[g]={name:g,min:null,max:a[g],duration:"number"===typeof b?b:0,easing:"function"===typeof d?d:null,started:!1,complete:!1,startTime:null};return this};e.start=function(){this.H=Date.now();this.B=!0;this.A=this.G=!1;var a,b;for(b in this.f)a=this.f[b],a.min=this.C[b],a.max="string"===typeof this.f[b].max?a.min+parseInt(this.f[b].max,10):a.max,a.started=!0,a.startTime=this.H;null!==this.o&&this.o.D();return this};
e.stop=function(){this.G=!0;null!==this.u&&this.u.D();return this};e.update=function(){if(!1!==this.B&&!0!==this.A&&!0!==this.G){var a,b=0,d;for(d in this.f){a=this.f[d];if(!1===a.complete){var g=a,h=Date.now()-g.startTime;g.complete=h>=g.duration;!1===g.complete?(h=(null!==g.easing?g.easing:this.c)(h/g.duration),this.C[g.name]=h*(g.max-g.min)+g.min):this.C[g.name]=g.max}!1===a.complete&&b++}null!==this.m&&this.m.D();b||(this.A=!0,null!==this.j&&this.j.D())}};
e.destroy=function(){this.stop();this.c=this.f=this.C=this.i=null;null!==this.o&&(this.o.destroy(),this.o=null);null!==this.m&&(this.m.destroy(),this.m=null);null!==this.j&&(this.j.destroy(),this.j=null);null!==this.u&&(this.u.destroy(),this.u=null);l.prototype.destroy.call(this)};
Object.defineProperty(Ab.prototype,"easing",{get:function(){return this.c},set:function(a){if("string"===typeof a)switch(a){case Y.LINEAR:this.c=Cd.LINEAR;break;case Y.Hd:this.c=Cd.Hd;break;case Y.Id:this.c=Cd.Id;break;case Y.Jd:this.c=Cd.Jd;break;case Y.Dd:this.c=Cd.Dd;break;case Y.Ed:this.c=Cd.Ed;break;case Y.Fd:this.c=Cd.Fd;break;case Y.xd:this.c=Cd.xd;break;case Y.yd:this.c=Cd.yd;break;case Y.zd:this.c=Cd.zd;break;case Y.Nc:this.c=Cd.Nc;break;case Y.ud:this.c=Cd.ud;break;default:this.c=Cd.LINEAR}else"function"===
typeof a&&(this.c=a)}});Object.defineProperty(Ab.prototype,"complete",{get:function(){return this.A}});Object.defineProperty(Ab.prototype,"onStart",{get:function(){null===this.o&&(this.o=new q(this));return this.o}});Object.defineProperty(Ab.prototype,"onProgress",{get:function(){null===this.m&&(this.m=new q(this));return this.m}});Object.defineProperty(Ab.prototype,"onComplete",{get:function(){null===this.j&&(this.j=new q(this));return this.j}});
Object.defineProperty(Ab.prototype,"onStop",{get:function(){null===this.u&&(this.u=new q(this));return this.u}});
var Cd={LINEAR:function(a){return G.X(a,0,1)},Hd:function(a){return G.X(1+Math.sin(Math.PI/2*(a-1)),0,1)},Id:function(a){return G.X(.5*(1+Math.sin(Math.PI/2*(2*a-1))),0,1)},Jd:function(a){return G.X(Math.sin(Math.PI/2*a),0,1)},Dd:function(a){return G.X(a*a,0,1)},Ed:function(a){return G.X(.5>a?2*a*a:1-2*(a-1)*(a-1),0,1)},Fd:function(a){a=1-a;return G.X(1-a*a,0,1)},xd:function(a){return G.X(a*a*a,0,1)},yd:function(a){return G.X(.5>a?4*a*a*a:1+4*(a-1)*(a-1)*(a-1),0,1)},zd:function(a){a=1-a;return G.X(1-
a*a*a,0,1)},Nc:function(a){a<1/2.75?a*=7.5625*a:a<2/2.75?(a-=1.5/2.75,a=7.5625*a*a+.75):a<2.5/2.75?(a-=2.25/2.75,a=7.5625*a*a+.9375):(a-=2.625/2.75,a=7.5625*a*a+.984375);return G.X(a,0,1)},ud:function(a){return 1-Cd.Nc(1-a)}},Y={LINEAR:"linear",Hd:"easeInSine",Id:"easeInOutSine",Jd:"easeOutSine",Dd:"easeInQuad",Ed:"easeInOutQuad",Fd:"easeOutQuad",xd:"easeInCubic",yd:"easeInOutCubic",zd:"easeOutCubic",Nc:"easeOutBounce",ud:"easeInBounce"},B={Ag:function(a){var b={value:null,Hc:null};if("string"===
typeof a){var d=parseInt(a,10);!1===isNaN(d)&&(b.value=d);-1<a.indexOf("%")?b.Hc="%":-1<a.indexOf("px")&&(b.Hc="px")}return b},kc:function(a,b,d){var g={};a="undefined"!==typeof a?a:{};b="undefined"!==typeof b?b:{};for(var h in a)a.hasOwnProperty(h)&&(g[h]=a[h]);for(var k in b)b.hasOwnProperty(k)&&(g[k]=!1!==d&&null!==a&&null!==b[k]&&"undefined"!==typeof b[k]&&b[k].constructor===Object?B.kc(a[k],b[k],!0):b[k]);return g},ab:function(a){for(var b=arguments,d={},g=0,h=b.length;g<h;g++)d=B.kc(d,b[g],
!0);return d},clone:function(a){if(!(a instanceof Object))return a;var b=new a.constructor,d;for(d in a)b[d]=B.clone(a[d]);return b},On:function(a){return null!==a&&"object"===typeof a&&"string"===typeof a.className&&-1!==Id.indexOf(a.className)?!0:!1},T:function(a,b){if("string"===typeof b&&(null!==a&&"object"===typeof a&&"string"===typeof a.className&&a.className.toLowerCase()===b.toLowerCase()||typeof a===b.toLowerCase()))return!0;if(!0===Array.isArray(b)&&!0===B.Ga(b,"string"))for(var d=0,g=b.length;d<
g;d++)if(!0===B.T(a,b[d]))return!0;return!1},Rn:function(a,b,d){b=b.split(".");for(var g=0,h=b.length;g<h;g++){a=a[b[g]];if(g===h-1)return B.T(a,d);if("undefined"===typeof a)break}return!1},Ga:function(a,b){if("object"===typeof a&&!0===Array.isArray(a)){for(var d=0,g=a.length;d<g;d++)if(!1===B.T(a[d],b))return!1;return!0}return!1},he:function(a,b,d){b=b.split(".");for(var g=0,h=b.length;g<h;g++){a=a[b[g]];if("undefined"===typeof a)break;if(g===h-1)return a}return d},pd:function(a,b){var d=b.split("."),
g=d.length;a.sort(function(a,b){for(var h=0;h<g;)a=a[d[h]],b=b[d[h]],h++;return a<b?-1:a>b?1:0});return a},nd:function(a){a=a.slice();for(var b,d,g=a.length-1;0<g;g--)d=~~(Math.random()*(g+1)),b=a[g],a[g]=a[d],a[d]=b;return a},qe:function(a,b,d){for(a=String(a);a.length<d;)a=b+a;return a},mk:function(a){a={input:a,hours:0,minutes:0,seconds:0};if("number"!==typeof a.input||isNaN(a.input))return a;a.Ln=parseInt(a.input/3600,10)%24;a.Tn=parseInt(a.input/60,10)%60;a.seconds=parseInt(a.input%60,10);return a},
xn:function(a,b){a=B.mk(a);var d="string"===typeof b?b:"H:M:S";b=0;-1!==d.indexOf("H")?b=2:-1!==d.indexOf("h")&&(b=1);var g=0;-1!==d.indexOf("M")?g=2:-1!==d.indexOf("m")&&(g=1);var h=0;-1!==d.indexOf("S")?h=2:-1!==d.indexOf("s")&&(h=1);d=d.toLowerCase();0<b&&(d=d.replace("h",B.qe(a.Ln,0,b)));0<g&&(d=d.replace("m",B.qe(a.Tn,0,g)));0<h&&(d=d.replace("s",B.qe(a.seconds,0,h)));return d},De:function(a,b,d){return new THREE.Spherical(a,Math.PI/2-d,b)},An:function(a){return{radius:a.radius,theta:a.theta,
phi:Math.PI/2-a.phi}},jj:function(a,b){return a.filter(function(a){return 0>b.indexOf(a)})},Wn:function(a,b){return b>=a.length?null:a.splice(b,1)},endsWith:function(a,b){return"function"!==typeof String.prototype.endsWith?-1!==a.indexOf(b,a.length-b.length):a.endsWith(b)}},ha={ed:function(a,b){var d=window.getComputedStyle(a,null).getPropertyValue("display");a.style.display="none";b=window.getComputedStyle(a,null).getPropertyValue(b);a.style.display=d;return b},Oj:function(a){a=ha.ed(a,"width");
var b="px";-1<a.indexOf("%")&&(b="%");-1<a.indexOf("px")&&(b="px");return b},Qj:function(a){a=parseInt(ha.ed(a,"width"),10);return isNaN(a)?0:a},Nj:function(a){a=ha.ed(a,"height");var b="px";-1<a.indexOf("%")&&(b="%");-1<a.indexOf("px")&&(b="px");return b},Pj:function(a){a=parseInt(ha.ed(a,"height"),10);return isNaN(a)?0:a},has:function(a){return document.body.contains(a)},ng:function(a){return a instanceof HTMLElement},Dn:function(a){var b,d;d=["MouseEvent","PointerEvent","TouchEvent"];"object"===
typeof a.srcEvent&&d.indexOf(a.srcEvent.constructor.toString())?(b=a.target.getBoundingClientRect(),d=a.srcEvent.clientX-b.left,a=a.srcEvent.clientY-b.top):(b=(a.currentTarget||a.target||a.srcElement).getBoundingClientRect(),d=a.clientX-b.left,a=a.clientY-b.top);return{x:d,y:a}}};function Me(){this.f=0;this.c={}}e=Me.prototype;e.constructor=Me;e.set=function(a,b){if("undefined"!==typeof a)return void 0===this.c[a]&&this.f++,this.c[a]=b,this.f};
e.Re=function(a){if("undefined"!==typeof a&&void 0!==this.c[a])return delete this.c[a],--this.f};e.get=function(a){return this.c[a]};e.Vk=function(){var a=new md,b;for(b in this.c)a.add(b);return a.Be()};e.Wk=function(){var a=new md,b;for(b in this.c)a.add(this.c[b]);return a.Be()};e.Uk=function(){var a=new md,b;for(b in this.c){var d=[];d.push(b);d.push(this.c[b]);a.add(d)}return a.Be()};e.Tk=function(){for(var a in this.c)this.Re(a)};e.has=function(a){return 0<this.f&&void 0!==this.c[a]};
Object.defineProperty(Me.prototype,"size",{get:function(){return this.f}});function md(){this.c=[]}e=md.prototype;e.constructor=md;e.add=function(a){this.c.push(a);return this.c.length};e.remove=function(a){for(var b=0,d=this.c.length;b<d;b++)this.c[b]===a&&this.c.splice(b,1)};e.get=function(a){return this.c[a]};e.Be=function(){return this.c};Object.defineProperty(md.prototype,"size",{get:function(){return this.c.length}});
function Xe(a){this.j=a;this.c=this.G=this.f=this.A=this.u=this.C="";this.o=null;this.m="";l.call(this,"URL")}Xe.prototype=Object.create(l.prototype);Xe.prototype.constructor=Xe;
function Da(a){var b=new Xe;"string"!==typeof a&&(a=window.location.toString());b.j=a;a=document.createElement("a");a.href=b.j;b.C=a.protocol;b.u=a.hostname;b.A=a.port;b.f=a.pathname;b.G=a.search;b.c=a.hash;b.m=b.f.substr(b.f.lastIndexOf(".")+1);if(""!==b.c){a=b.c.replace("#","").split("&");var d={};d.slug=a[0];for(var g=1,h=a.length;g<h;g++){var k=a[g].split("=");d[k[0]]=decodeURIComponent(k[1])}b.o=d}return b}Object.defineProperty(Xe.prototype,"url",{get:function(){return this.j}});
Object.defineProperty(Xe.prototype,"protocol",{get:function(){return this.C}});Object.defineProperty(Xe.prototype,"host",{get:function(){return this.u}});Object.defineProperty(Xe.prototype,"port",{get:function(){return this.A}});Object.defineProperty(Xe.prototype,"path",{get:function(){return this.f}});Object.defineProperty(Xe.prototype,"query",{get:function(){return this.G}});Object.defineProperty(Xe.prototype,"hash",{get:function(){return this.c}});
Object.defineProperty(Xe.prototype,"hashParameters",{get:function(){return this.o}});Object.defineProperty(Xe.prototype,"extension",{get:function(){return this.m}});
var Z={Yn:function(a,b,d){a/=255;b/=255;d/=255;var g=Math.max(a,b,d),h=Math.min(a,b,d),k,n=(g+h)/2;if(g===h)k=h=0;else{var v=g-h,h=.5<n?v/(2-g-h):v/(g+h);switch(g){case a:k=(b-d)/v+(b<d?6:0);break;case b:k=(d-a)/v+2;break;case d:k=(a-b)/v+4}k/=6}return{h:k,s:h,l:n}},Mn:function(a,b,d){if(b){var g=.5>d?d*(1+b):d+b-d*b,h=2*d-g;d=Z.le(h,g,a+1/3);b=Z.le(h,g,a);a=Z.le(h,g,a-1/3)}else d=b=a=d;return{r:255*d,g:255*b,b:255*a}},le:function(a,b,d){if(!(0>d||1<d)){if(d<1/6)return a+6*(b-a)*d;if(.5>d)return b;
if(d<2/3)return a+(b-a)*(2/3-d)*6}return a},Zn:function(a,b,d){a/=255;b/=255;d/=255;var g=Math.max(a,b,d),h=Math.min(a,b,d),k,n=g-h;if(g===h)k=0;else{switch(g){case a:k=(b-d)/n+(b<d?6:0);break;case b:k=(d-a)/n+2;break;case d:k=(a-b)/n+4}k/=6}return{h:k,s:g?n/g:0,v:g}},Nn:function(a,b,d){var g,h,k,n=Math.floor(6*a),v=6*a-n;a=d*(1-b);var x=d*(1-v*b);b=d*(1-(1-v)*b);switch(n%6){case 0:g=d;h=b;k=a;break;case 1:g=x;h=d;k=a;break;case 2:g=a;h=d;k=b;break;case 3:g=a;h=x;k=d;break;case 4:g=b;h=a;k=d;break;
case 5:g=d,h=a,k=x}return{r:255*g,g:255*h,b:255*k}},$d:function(a){a=a.toString(16);return 1===a.length?"0"+a:a},Xn:function(a,b,d){return"#"+Z.$d(a)+Z.$d(b)+Z.$d(d)},yn:function(a){a=a.split("(")[1].split(")")[0].split(",");var b={r:parseInt(a[0],10),g:parseInt(a[1],10),b:parseInt(a[2],10)};3<a.length&&(b.a=parseInt(a[3],10));return b},Kn:function(a){a=a.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(a,d,g,h){return d+d+g+g+h+h});return(a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a))?
{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:null},$n:function(a){a=new THREE.Vector3(a.r,a.g,a.b);var b=(new THREE.Matrix3).set(.299,.587,.114,-.169,-.331,.5,.5,-.419,-.081),d=new THREE.Vector3(0,128,128);a.applyMatrix3(b).add(d);return{Y:a.x,Cr:a.y,Cb:a.z}},no:function(a){a=new THREE.Vector3(a.Y,a.Cr,a.Cb);var b=new THREE.Vector3(0,-128,-128),d=(new THREE.Matrix3).set(1,0,1.4,1,-.343,-.711,1,1.765,0);a.add(b).applyMatrix3(d);return{r:a.x,g:a.y,b:a.z}},mo:function(a,b){var d=G.ca(b);
b=Math.cos(d);d=Math.sin(d);return{Y:a.Y,Cb:a.Cb*b-a.Cr*d,Cr:a.Cb*d+a.Cr*b}},distance:function(a,b){return Math.sqrt((a.Cb-b.Cb)*(a.Cb-b.Cb)+(a.Cr-b.Cr)*(a.Cr-b.Cr))}};function Pb(a,b,d,g){this.alpha=g}window.FORGE=window.FORGE||{};window.FORGE.BaseObject=l;window.FORGE.Viewer=r;window.FORGE.Tags=ca;window.FORGE.UID=p;window.FORGE.Story=w;window.FORGE.Group=D;window.FORGE.Scene=C;window.FORGE.SceneParser=F;window.FORGE.Rectangle=Ha;window.FORGE.Size=Ia;window.FORGE.Media=La;
window.FORGE.RenderManager=y;window.FORGE.RenderScene=ab;window.FORGE.RenderPipeline=Sa;window.FORGE.RenderDisplay=Qa;window.FORGE.RenderParams=qb;window.FORGE.BackgroundRenderer=rb;window.FORGE.BackgroundMeshRenderer=Ya;window.FORGE.BackgroundShaderRenderer=Xa;window.FORGE.PostProcessing=ta;window.FORGE.EffectComposer=bb;window.FORGE.TexturePass=fb;window.FORGE.ShaderPass=hb;window.FORGE.AdditionPass=kb;window.FORGE.RenderPass=db;window.FORGE.ViewBase=wb;window.FORGE.ViewGoPro=$a;
window.FORGE.ViewRectilinear=Za;window.FORGE.Timeline=xb;window.FORGE.Keyframe=yb;window.FORGE.Animation=zb;window.FORGE.MetaAnimation=Eb;window.FORGE.Track=Hb;window.FORGE.Object3D=Ib;window.FORGE.ObjectRenderer=Ra;window.FORGE.Raycaster=Mb;window.FORGE.PickingDrawPass=Qb;window.FORGE.PickingManager=Pa;window.FORGE.HotspotManager=qa;window.FORGE.Hotspot3D=Ub;window.FORGE.HotspotSound=$b;window.FORGE.HotspotMaterial=Yb;window.FORGE.HotspotTransform=Wb;window.FORGE.HotspotAnimation=Xb;
window.FORGE.HotspotAnimationTrack=Vb;window.FORGE.Camera=L;window.FORGE.CameraAnimation=vc;window.FORGE.CameraGaze=jc;window.FORGE.ControllerManager=oa;window.FORGE.ControllerBase=Gc;window.FORGE.ControllerPointer=Dc;window.FORGE.ControllerKeyboard=Fc;window.FORGE.SoundManager=u;window.FORGE.Sound=M;window.FORGE.Playlist=Q;window.FORGE.PlaylistManager=z;window.FORGE.PlaylistTrack=Yc;window.FORGE.Director=sa;window.FORGE.DirectorTrack=uc;window.FORGE.ActionEventDispatcher=ac;window.FORGE.Action=$c;
window.FORGE.ActionManager=ra;window.FORGE.Plugin=R;window.FORGE.PluginEngine=fd;window.FORGE.PluginManager=pa;window.FORGE.PluginObjectFactory=ed;window.FORGE.Device=N;window.FORGE.RequestAnimationFrame=la;window.FORGE.History=na;window.FORGE.EventDispatcher=q;window.FORGE.Event=td;window.FORGE.Listener=rd;window.FORGE.LocaleManager=ma;window.FORGE.LocaleString=za;window.FORGE.Locale=vd;window.FORGE.Keyboard=ua;window.FORGE.KeyBinding=P;window.FORGE.Drag=Bd;window.FORGE.Pointer=U;
window.FORGE.DisplayList=ga;window.FORGE.DisplayObject=T;window.FORGE.DisplayObjectContainer=t;window.FORGE.Image=I;window.FORGE.ImageScalable=ic;window.FORGE.Sprite=nd;window.FORGE.Iframe=Wd;window.FORGE.TextField=S;window.FORGE.Button=od;window.FORGE.ButtonSkin=ge;window.FORGE.Canvas=ia;window.FORGE.VideoHTML5=K;window.FORGE.VideoDash=J;window.FORGE.VideoTimeRanges=xe;window.FORGE.VideoQuality=De;window.FORGE.SpriteAnimationManager=Vd;window.FORGE.SpriteAnimation=W;window.FORGE.Cache=va;
window.FORGE.File=Re;window.FORGE.Loader=wa;window.FORGE.DependencyManager=ja;window.FORGE.Clock=ka;window.FORGE.Timer=X;window.FORGE.TimerEvent=We;window.FORGE.TweenManager=xa;window.FORGE.Tween=Ab;window.FORGE.Map=Me;window.FORGE.Collection=md;window.FORGE.URL=Xe;window.FORGE.ColorRGBA=Pb;l.prototype.log=l.prototype.log;l.prototype.warn=l.prototype.warn;l.prototype.destroy=l.prototype.destroy;r.prototype.update=r.prototype.update;r.prototype.pause=r.prototype.pause;r.prototype.resume=r.prototype.resume;
r.prototype.destroy=r.prototype.destroy;w.prototype.boot=w.prototype.boot;w.prototype.load=w.prototype.load;w.prototype.hasScenes=w.prototype.pl;w.prototype.hasGroups=w.prototype.mc;w.prototype.nextScene=w.prototype.ql;w.prototype.previousScene=w.prototype.rl;w.prototype.notifySceneConfigLoadComplete=w.prototype.kk;w.prototype.loadScene=w.prototype.ld;w.prototype.loadGroup=w.prototype.ek;w.prototype.destroy=w.prototype.destroy;D.prototype.load=D.prototype.load;D.prototype.hasChild=D.prototype.Ke;
D.prototype.hasScene=D.prototype.Ec;D.prototype.hasGroup=D.prototype.fd;D.prototype.hasChildren=D.prototype.Gn;D.prototype.hasTypeOfChild=D.prototype.jg;D.prototype.hasScenes=D.prototype.Le;D.prototype.hasGroups=D.prototype.mc;D.prototype.getChildrenUids=D.prototype.dd;D.prototype.getChildren=D.prototype.ee;D.prototype.nextScene=D.prototype.Nk;D.prototype.previousScene=D.prototype.Ok;D.prototype.destroy=D.prototype.destroy;C.prototype.addConfig=C.prototype.ha;C.prototype.load=C.prototype.load;
C.prototype.unload=C.prototype.Ee;C.prototype.hasGroup=C.prototype.fd;C.prototype.hasGroups=C.prototype.mc;C.prototype.destroy=C.prototype.destroy;F.prototype.extendConfiguration=F.prototype.wj;F.prototype.hasSoundSource=F.prototype.Uj;F.prototype.hasSoundTarget=F.prototype.Vj;F.prototype.isAmbisonic=F.prototype.ak;F.prototype.destroy=F.prototype.destroy;La.prototype.destroy=La.prototype.destroy;y.prototype.render=y.prototype.render;y.prototype.screenToWorld=y.prototype.screenToWorld;
y.prototype.worldToScreen=y.prototype.worldToScreen;y.prototype.enableVR=y.prototype.Lh;y.prototype.toggleVR=y.prototype.ho;y.prototype.setView=y.prototype.oc;y.prototype.destroy=y.prototype.destroy;ab.prototype.setSize=ab.prototype.setSize;ab.prototype.destroy=ab.prototype.destroy;Sa.prototype.enablePicking=Sa.prototype.cg;Sa.prototype.addBackground=Sa.prototype.cj;Sa.prototype.addRenderScenes=Sa.prototype.ej;Sa.prototype.addGlobalFx=Sa.prototype.dj;Sa.prototype.getShaderPassByUID=Sa.prototype.En;
Sa.prototype.setSize=Sa.prototype.setSize;Sa.prototype.render=Sa.prototype.render;Sa.prototype.clear=Sa.prototype.Xe;Sa.prototype.destroy=Sa.prototype.destroy;Qa.prototype.enableVR=Qa.prototype.Hh;Qa.prototype.getQuaternionFromPose=Qa.prototype.Ij;Qa.prototype.getRenderParams=Qa.prototype.Kj;Qa.prototype.setSize=Qa.prototype.setSize;Qa.prototype.submitFrame=Qa.prototype.Ih;Qa.prototype.destroy=Qa.prototype.destroy;rb.prototype.updateAfterViewChange=rb.prototype.fc;rb.prototype.setSize=rb.prototype.setSize;
rb.prototype.render=rb.prototype.render;rb.prototype.update=rb.prototype.update;rb.prototype.destroy=rb.prototype.destroy;Ya.prototype.updateAfterViewChange=Ya.prototype.fc;Ya.prototype.render=Ya.prototype.render;Ya.prototype.destroy=Ya.prototype.destroy;Xa.prototype.render=Xa.prototype.render;Xa.prototype.updateAfterViewChange=Xa.prototype.fc;Xa.prototype.destroy=Xa.prototype.destroy;ta.prototype.parseShaderPasses=ta.prototype.we;ta.prototype.getFxSetByUID=ta.prototype.fe;
ta.prototype.addConfig=ta.prototype.ha;ta.prototype.destroy=ta.prototype.destroy;bb.prototype.destroy=bb.prototype.destroy;hb.prototype.render=hb.prototype.render;kb.prototype.destroy=kb.prototype.destroy;wb.prototype.shaderSTW=wb.prototype.Gc;wb.prototype.shaderWTS=wb.prototype.cc;wb.prototype.updateUniforms=wb.prototype.pc;wb.prototype.worldToScreen=wb.prototype.worldToScreen;wb.prototype.screenToWorld=wb.prototype.screenToWorld;wb.prototype.getProjectionFov=wb.prototype.je;
wb.prototype.destroy=wb.prototype.destroy;$a.prototype.shaderSTW=$a.prototype.Gc;$a.prototype.shaderWTS=$a.prototype.cc;$a.prototype.updateUniforms=$a.prototype.pc;$a.prototype.getProjectionFov=$a.prototype.je;$a.prototype.destroy=$a.prototype.destroy;Za.prototype.shaderSTW=Za.prototype.Gc;Za.prototype.shaderWTS=Za.prototype.cc;Za.prototype.updateUniforms=Za.prototype.pc;Za.prototype.worldToScreen=Za.prototype.worldToScreen;Za.prototype.screenToWorld=Za.prototype.screenToWorld;
Za.prototype.destroy=Za.prototype.destroy;xb.prototype.hasKeyframes=xb.prototype.Hn;xb.prototype.addKeyframe=xb.prototype.lb;xb.prototype.getKeyframes=xb.prototype.Cn;xb.prototype.getKeyframesIndexes=xb.prototype.ge;xb.prototype.getSideKeyframes=xb.prototype.Lj;xb.prototype.getSideKeyframesIndexes=xb.prototype.Mj;xb.prototype.emptyKeyframes=xb.prototype.wn;xb.prototype.destroy=xb.prototype.destroy;zb.prototype.play=zb.prototype.play;zb.prototype.stop=zb.prototype.stop;zb.prototype.resume=zb.prototype.resume;
zb.prototype.destroy=zb.prototype.destroy;Eb.prototype.stop=Eb.prototype.stop;Eb.prototype.resume=Eb.prototype.resume;Eb.prototype.destroy=Eb.prototype.destroy;Hb.prototype.destroy=Hb.prototype.destroy;Ib.prototype.click=Ib.prototype.click;Ib.prototype.over=Ib.prototype.Te;Ib.prototype.out=Ib.prototype.qd;Ib.prototype.destroy=Ib.prototype.destroy;Ra.prototype.register=Ra.prototype.register;Ra.prototype.unregister=Ra.prototype.unregister;Ra.prototype.createRenderScenes=Ra.prototype.nj;
Ra.prototype.getRaycastable=Ra.prototype.Jj;Ra.prototype.getByMesh=Ra.prototype.Gj;Ra.prototype.clear=Ra.prototype.Ue;Ra.prototype.destroy=Ra.prototype.destroy;Mb.prototype.start=Mb.prototype.start;Mb.prototype.stop=Mb.prototype.stop;Mb.prototype.click=Mb.prototype.click;Mb.prototype.clear=Mb.prototype.Gh;Qb.prototype.start=Qb.prototype.start;Qb.prototype.stop=Qb.prototype.stop;Qb.prototype.click=Qb.prototype.click;Qb.prototype.setSize=Qb.prototype.setSize;Qb.prototype.clear=Qb.prototype.qh;
Qb.prototype.destroy=Qb.prototype.destroy;Pa.prototype.updateForViewType=Pa.prototype.Dk;Pa.prototype.clear=Pa.prototype.rh;Pa.prototype.setSize=Pa.prototype.setSize;Pa.prototype.click=Pa.prototype.click;Pa.prototype.start=Pa.prototype.start;Pa.prototype.stop=Pa.prototype.stop;Pa.prototype.destroy=Pa.prototype.destroy;qa.prototype.boot=qa.prototype.boot;qa.prototype.getByType=qa.prototype.Bn;qa.prototype.addConfig=qa.prototype.ha;qa.prototype.addTracks=qa.prototype.fj;qa.prototype.update=qa.prototype.update;
qa.prototype.clear=qa.prototype.Ne;qa.prototype.destroy=qa.prototype.destroy;Ub.prototype.update=Ub.prototype.update;Ub.prototype.destroy=Ub.prototype.destroy;$b.prototype.load=$b.prototype.load;$b.prototype.update=$b.prototype.update;$b.prototype.destroy=$b.prototype.destroy;Yb.prototype.load=Yb.prototype.load;Yb.prototype.update=Yb.prototype.update;Yb.prototype.destroy=Yb.prototype.destroy;Wb.prototype.load=Wb.prototype.load;Wb.prototype.destroy=Wb.prototype.destroy;Xb.prototype.load=Xb.prototype.load;
Xb.prototype.play=Xb.prototype.play;L.prototype.load=L.prototype.load;L.prototype.lookAt=L.prototype.gk;L.prototype.update=L.prototype.update;L.prototype.destroy=L.prototype.destroy;vc.prototype.play=vc.prototype.play;vc.prototype.destroy=vc.prototype.destroy;jc.prototype.load=jc.prototype.load;jc.prototype.start=jc.prototype.start;jc.prototype.stop=jc.prototype.stop;jc.prototype.update=jc.prototype.update;jc.prototype.destroy=jc.prototype.destroy;oa.prototype.notifyControlStart=oa.prototype.te;
oa.prototype.notifyControlEnd=oa.prototype.se;oa.prototype.update=oa.prototype.update;oa.prototype.addConfig=oa.prototype.ha;oa.prototype.destroy=oa.prototype.destroy;Gc.prototype.enable=Gc.prototype.enable;Gc.prototype.disable=Gc.prototype.Gb;Gc.prototype.destroy=Gc.prototype.destroy;Dc.prototype.enable=Dc.prototype.enable;Dc.prototype.disable=Dc.prototype.Gb;Dc.prototype.update=Dc.prototype.update;Dc.prototype.destroy=Dc.prototype.destroy;Fc.prototype.enable=Fc.prototype.enable;
Fc.prototype.disable=Fc.prototype.Gb;Fc.prototype.update=Fc.prototype.update;Fc.prototype.destroy=Fc.prototype.destroy;u.prototype.boot=u.prototype.boot;u.prototype.addConfig=u.prototype.ha;u.prototype.update=u.prototype.update;u.prototype.add=u.prototype.add;u.prototype.remove=u.prototype.remove;u.prototype.autoSuspend=u.prototype.Uf;u.prototype.autoResume=u.prototype.Tf;u.prototype.mute=u.prototype.bb;u.prototype.unmute=u.prototype.Nh;u.prototype.destroy=u.prototype.destroy;M.prototype.update=M.prototype.update;
M.prototype.play=M.prototype.play;M.prototype.stop=M.prototype.stop;M.prototype.pause=M.prototype.pause;M.prototype.resume=M.prototype.resume;M.prototype.mute=M.prototype.bb;M.prototype.unmute=M.prototype.Rh;M.prototype.destroy=M.prototype.destroy;Q.prototype.hasTracks=Q.prototype.hl;Q.prototype.play=Q.prototype.play;Q.prototype.stop=Q.prototype.stop;Q.prototype.pause=Q.prototype.pause;Q.prototype.resume=Q.prototype.resume;Q.prototype.nextTrack=Q.prototype.md;Q.prototype.previousTrack=Q.prototype.ye;
Q.prototype.destroy=Q.prototype.destroy;z.prototype.boot=z.prototype.boot;z.prototype.addConfig=z.prototype.ha;z.prototype.add=z.prototype.add;z.prototype.addTrack=z.prototype.th;z.prototype.hasPlaylists=z.prototype.In;z.prototype.hasTracks=z.prototype.bl;z.prototype.play=z.prototype.play;z.prototype.stop=z.prototype.stop;z.prototype.pause=z.prototype.pause;z.prototype.resume=z.prototype.resume;z.prototype.nextTrack=z.prototype.md;z.prototype.previousTrack=z.prototype.ye;z.prototype.destroy=z.prototype.destroy;
Yc.prototype.play=Yc.prototype.play;Yc.prototype.stop=Yc.prototype.stop;Yc.prototype.pause=Yc.prototype.pause;Yc.prototype.resume=Yc.prototype.resume;Yc.prototype.destroy=Yc.prototype.destroy;sa.prototype.load=sa.prototype.load;sa.prototype.play=sa.prototype.play;sa.prototype.stop=sa.prototype.stop;sa.prototype.destroy=sa.prototype.destroy;ac.prototype.addActions=ac.prototype.c;ac.prototype.dispatch=ac.prototype.D;ac.prototype.destroy=ac.prototype.destroy;$c.prototype.execute=$c.prototype.yb;
$c.prototype.destroy=$c.prototype.destroy;ra.prototype.get=ra.prototype.get;ra.prototype.addConfig=ra.prototype.ha;ra.prototype.destroy=ra.prototype.destroy;R.prototype.instantiate=R.prototype.$j;R.prototype.notifyInstanceReady=R.prototype.Vn;R.prototype.update=R.prototype.update;R.prototype.resetInstance=R.prototype.rk;R.prototype.destroy=R.prototype.destroy;fd.prototype.load=fd.prototype.load;fd.prototype.getNewInstance=fd.prototype.Hj;fd.prototype.destroy=fd.prototype.destroy;
pa.prototype.boot=pa.prototype.boot;pa.prototype.addConfig=pa.prototype.ha;pa.prototype.getById=pa.prototype.de;pa.prototype.getByIndex=pa.prototype.Fj;pa.prototype.get=pa.prototype.get;pa.prototype.remove=pa.prototype.remove;pa.prototype.update=pa.prototype.update;pa.prototype.render=pa.prototype.render;pa.prototype.destroy=pa.prototype.destroy;ed.prototype.string=ed.prototype.eo;ed.prototype.textField=ed.prototype.fo;ed.prototype.sound=ed.prototype.sound;ed.prototype.displayObjectContainer=ed.prototype.vn;
ed.prototype.displayObject=ed.prototype.kl;ed.prototype.image=ed.prototype.image;ed.prototype.sprite=ed.prototype.bo;ed.prototype.button=ed.prototype.jl;ed.prototype.video=ed.prototype.ml;ed.prototype.canvas=ed.prototype.canvas;ed.prototype.tween=ed.prototype.ll;ed.prototype.destroyAllObjects=ed.prototype.sj;ed.prototype.destroy=ed.prototype.destroy;la.prototype.boot=la.prototype.boot;la.prototype.start=la.prototype.start;la.prototype.stop=la.prototype.stop;la.prototype.destroy=la.prototype.destroy;
na.prototype.addConfig=na.prototype.ha;na.prototype.destroy=na.prototype.destroy;q.prototype.add=q.prototype.add;q.prototype.addOnce=q.prototype.da;q.prototype.remove=q.prototype.remove;q.prototype.has=q.prototype.has;q.prototype.dispatch=q.prototype.D;q.prototype.destroy=q.prototype.destroy;rd.prototype.execute=rd.prototype.yb;rd.prototype.detach=rd.prototype.oh;rd.prototype.destroy=rd.prototype.destroy;ma.prototype.addConfig=ma.prototype.ha;ma.prototype.getValue=ma.prototype.Yb;
ma.prototype.hasValue=ma.prototype.xb;ma.prototype.destroy=ma.prototype.destroy;za.prototype.destroy=za.prototype.destroy;vd.prototype.addConfig=vd.prototype.ha;vd.prototype.loadFiles=vd.prototype.sg;vd.prototype.getValue=vd.prototype.Yb;vd.prototype.hasValue=vd.prototype.xb;vd.prototype.getKey=vd.prototype.ph;vd.prototype.destroy=vd.prototype.destroy;ua.prototype.update=ua.prototype.update;ua.prototype.isKeyPressed=ua.prototype.Pn;ua.prototype.isKeyOut=ua.prototype.pg;ua.prototype.addBinding=ua.prototype.Rf;
ua.prototype.removeBinding=ua.prototype.ze;ua.prototype.hasBinding=ua.prototype.Fn;ua.prototype.getBindings=ua.prototype.fg;ua.prototype.destroy=ua.prototype.destroy;P.prototype.hasKeyIn=P.prototype.ke;P.prototype.hasKeyOut=P.prototype.ig;P.prototype.down=P.prototype.nh;P.prototype.waitToHold=P.prototype.ko;P.prototype.up=P.prototype.Ck;P.prototype.hold=P.prototype.Xj;P.prototype.destroy=P.prototype.destroy;Bd.prototype.enable=Bd.prototype.enable;Bd.prototype.disable=Bd.prototype.kh;
Bd.prototype.destroy=Bd.prototype.destroy;U.prototype.enable=U.prototype.enable;U.prototype.disable=U.prototype.Ve;U.prototype.destroy=U.prototype.destroy;ga.prototype.register=ga.prototype.register;ga.prototype.unregister=ga.prototype.unregister;ga.prototype.update=ga.prototype.update;ga.prototype.destroy=ga.prototype.destroy;T.prototype.show=T.prototype.gh;T.prototype.hide=T.prototype.Wj;T.prototype.toggleVisibility=T.prototype.io;T.prototype.maximize=T.prototype.Ab;T.prototype.isInDom=T.prototype.kd;
T.prototype.resize=T.prototype.fh;T.prototype.fullscreenEnter=T.prototype.Aj;T.prototype.fullscreenExit=T.prototype.Bj;T.prototype.isFullscreen=T.prototype.jd;T.prototype.destroy=T.prototype.destroy;t.prototype.update=t.prototype.update;t.prototype.addChild=t.prototype.Xb;t.prototype.addChildAt=t.prototype.nn;t.prototype.fitToContent=t.prototype.zj;t.prototype.removeChild=t.prototype.removeChild;t.prototype.removeChildAt=t.prototype.Bg;t.prototype.empty=t.prototype.eh;t.prototype.hasChild=t.prototype.Kk;
t.prototype.destroy=t.prototype.destroy;I.prototype.load=I.prototype.load;I.prototype.unload=I.prototype.Ee;I.prototype.destroy=I.prototype.destroy;ic.prototype.destroy=ic.prototype.destroy;nd.prototype.play=nd.prototype.play;nd.prototype.pause=nd.prototype.pause;nd.prototype.resume=nd.prototype.resume;nd.prototype.stop=nd.prototype.stop;nd.prototype.update=nd.prototype.update;nd.prototype.destroy=nd.prototype.destroy;Wd.prototype.load=Wd.prototype.load;Wd.prototype.destroy=Wd.prototype.destroy;
S.prototype.load=S.prototype.load;S.prototype.destroy=S.prototype.destroy;od.prototype.load=od.prototype.load;od.prototype.addSkin=od.prototype.jc;od.prototype.setSkin=od.prototype.vk;od.prototype.hasSkin=od.prototype.Tj;od.prototype.updateSkin=od.prototype.jo;od.prototype.destroy=od.prototype.destroy;ge.prototype.setDefaultFromState=ge.prototype.Hg;ge.prototype.getProperty=ge.prototype.Qa;ge.prototype.hasImage=ge.prototype.Sj;ge.prototype.hasLabel=ge.prototype.m;K.prototype.update=K.prototype.update;
K.prototype.load=K.prototype.load;K.prototype.play=K.prototype.play;K.prototype.pause=K.prototype.pause;K.prototype.stop=K.prototype.stop;K.prototype.togglePlayback=K.prototype.Al;K.prototype.mute=K.prototype.bb;K.prototype.unmute=K.prototype.Xh;K.prototype.destroy=K.prototype.destroy;J.prototype.load=J.prototype.load;J.prototype.play=J.prototype.play;J.prototype.pause=J.prototype.pause;J.prototype.stop=J.prototype.stop;J.prototype.togglePlayback=J.prototype.zl;J.prototype.mute=J.prototype.bb;
J.prototype.unmute=J.prototype.Uh;J.prototype.enableBufferOccupancyABR=J.prototype.yl;J.prototype.destroy=J.prototype.destroy;xe.prototype.getTimeRange=xe.prototype.j;xe.prototype.isInRanges=xe.prototype.ck;Vd.prototype.add=Vd.prototype.add;Vd.prototype.play=Vd.prototype.play;Vd.prototype.pause=Vd.prototype.pause;Vd.prototype.resume=Vd.prototype.resume;Vd.prototype.stop=Vd.prototype.stop;Vd.prototype.get=Vd.prototype.get;Vd.prototype.update=Vd.prototype.update;Vd.prototype.destroy=Vd.prototype.destroy;
W.prototype.play=W.prototype.play;W.prototype.pause=W.prototype.pause;W.prototype.resume=W.prototype.resume;W.prototype.stop=W.prototype.stop;W.prototype.update=W.prototype.update;W.prototype.destroy=W.prototype.destroy;va.prototype.has=va.prototype.has;va.prototype.get=va.prototype.get;va.prototype.add=va.prototype.add;va.prototype.remove=va.prototype.remove;va.prototype.destroy=va.prototype.destroy;Re.prototype.key=Re.prototype.key;Re.prototype.url=Re.prototype.url;Re.prototype.type=Re.prototype.type;
Re.prototype.data=Re.prototype.data;Re.prototype.xhr=Re.prototype.lo;Re.prototype.loading=Re.prototype.zb;Re.prototype.loaded=Re.prototype.Mk;Re.prototype.error=Re.prototype.Lk;wa.prototype.json=wa.prototype.json;wa.prototype.xml=wa.prototype.Sk;wa.prototype.sound=wa.prototype.sound;wa.prototype.image=wa.prototype.image;wa.prototype.script=wa.prototype.Gg;wa.prototype.css=wa.prototype.oj;wa.prototype.destroy=wa.prototype.destroy;ja.prototype.add=ja.prototype.add;ja.prototype.destroy=ja.prototype.destroy;
ka.prototype.create=ka.prototype.create;ka.prototype.add=ka.prototype.add;ka.prototype.update=ka.prototype.update;ka.prototype.destroy=ka.prototype.destroy;X.prototype.create=X.prototype.create;X.prototype.add=X.prototype.add;X.prototype.repeat=X.prototype.sl;X.prototype.loop=X.prototype.Ze;X.prototype.remove=X.prototype.remove;X.prototype.start=X.prototype.start;X.prototype.stop=X.prototype.stop;X.prototype.pause=X.prototype.pause;X.prototype.resume=X.prototype.resume;X.prototype.update=X.prototype.update;
X.prototype.destroy=X.prototype.destroy;We.prototype.execute=We.prototype.yb;xa.prototype.add=xa.prototype.add;xa.prototype.remove=xa.prototype.remove;xa.prototype.update=xa.prototype.update;xa.prototype.destroy=xa.prototype.destroy;Ab.prototype.to=Ab.prototype.$e;Ab.prototype.start=Ab.prototype.start;Ab.prototype.stop=Ab.prototype.stop;Ab.prototype.update=Ab.prototype.update;Ab.prototype.destroy=Ab.prototype.destroy;Me.prototype.set=Me.prototype.set;Me.prototype["delete"]=Me.prototype.Re;
Me.prototype.get=Me.prototype.get;Me.prototype.keys=Me.prototype.Vk;Me.prototype.values=Me.prototype.Wk;Me.prototype.entries=Me.prototype.Uk;Me.prototype.clear=Me.prototype.Tk;Me.prototype.has=Me.prototype.has;md.prototype.add=md.prototype.add;md.prototype.remove=md.prototype.remove;md.prototype.get=md.prototype.get;md.prototype.toArray=md.prototype.Be;window.FORGE.Math=G;G.degToRad=G.ca;G.radToDeg=G.$b;G.round10=G.od;G.clamp=G.X;G.wrap=G.Wa;G.mix=G.Un;G.smoothStep=G.ao;G.rotationMatrixToEuler=G.Cg;
G.eulerToRotationMatrix=G.be;window.FORGE.Quaternion=H;H.toEuler=H.Ce;H.fromEuler=H.lc;H.toRotationMatrix=H.yk;H.fromRotationMatrix=H.zn;H.cancelRoll=H.cancelRoll;H.diffBetweenQuaternions=H.un;H.angularDistance=H.ij;H.multiplyScalar=H.multiplyScalar;H.add=H.add;H.log=H.log;H.exp=H.exp;H.slerp=H.slerp;H.squad=H.co;H.nlerpNoInvert=H.jk;H.slerpNoInvert=H.Ae;H.squadNoInvert=H.wk;H.spline=H.Jg;bb.getUniqueName=ub;tb.parseIncludes=tb.eb;Qb.colorFrom3DObject=Rb;ge.isValid=function(a){return a?!0:!1};
De.mimeTypeFromURL=Ke;window.FORGE.Utils=B;B.parseSizeString=B.Ag;B.extendSimpleObject=B.kc;B.extendMultipleObjects=B.ab;B.clone=B.clone;B.isDisplayObject=B.On;B.isTypeOf=B.T;B.isTypeOfRecursive=B.Rn;B.isArrayOf=B.Ga;B.getObjectProperty=B.he;B.sortArrayByProperty=B.pd;B.randomize=B.nd;B.leftFill=B.qe;B.parseTime=B.mk;B.formatTime=B.xn;B.toTHREESpherical=B.De;B.fromTHREESpherical=B.An;B.arrayByDifference=B.jj;B.removeItemFromArrayAtIndex=B.Wn;B.endsWith=B.endsWith;window.FORGE.Dom=ha;
ha.getCssProperty=ha.ed;ha.getUnitWidth=ha.Oj;ha.getValueWidth=ha.Qj;ha.getUnitHeight=ha.Nj;ha.getValueHeight=ha.Pj;ha.has=ha.has;ha.isHtmlElement=ha.ng;ha.getMouseEventOffset=ha.Dn;Xe.parse=Da;
Xe.exists=function(a,b,d,g){var h=new XMLHttpRequest,k=null;h.onreadystatechange=function(){4===this.readyState&&200===this.status&&(clearTimeout(k),"function"===typeof b&&b.call(g))};h.onerror=function(a){console.log(a)};h.open("HEAD",a);h.send();k=window.setTimeout(function(){"function"===typeof d&&d.call(g)},500)};
Xe.isValid=function(a){return/((([A-Za-z]{3,9}:(?:\/\/)?)(?:[\-;:&=\+\$,\w]+@)?[A-Za-z0-9\.\-]+|(?:www\.|[\-;:&=\+\$,\w]+@)[A-Za-z0-9\.\-]+)((?:\/[\+~%\/\.\w\-]*)?\??(?:[\-\+=&;%@\.\w]*)#?(?:[\.\!\/\\\w]*))?)/.test(a)?!0:!1};window.FORGE.Color=Z;Z.rgbToHsl=Z.Yn;Z.hslToRgb=Z.Mn;Z.hueToRgb=Z.le;Z.rgbToHsv=Z.Zn;Z.hsvToRgb=Z.Nn;Z.componentToHex=Z.$d;Z.rgbToHex=Z.Xn;Z.fromRgbaString=Z.yn;Z.hexToRgb=Z.Kn;Z.rgbToYcbcr=Z.$n;Z.ycbcrToRgb=Z.no;Z.ycbcrRotate=Z.mo;Z.distance=Z.distance;N.canPlayAudio=N.sn;
N.canPlayVideo=N.tn;N.isLowBattery=N.Qn;N.os=N.cb;N.vita=N.Ng;N.xbox=N.Wg;N.kindle=N.qg;N.windowsPhone=N.Ge;N.osVersion=N.Zb;N.android=N.gj;N.chromeOS=N.Wf;N.iOS=N.Fc;N.linux=N.rg;N.macOS=N.ug;N.windows=N.Vg;N.ie=N.hd;N.edge=N.ae;N.firefox=N.dg;N.opera=N.opera;N.safari=N.Dg;N.chrome=N.chrome;N.browser=N.mb;N.browserVersion=N.$a;N.edgeVersion=N.uj;N.chromeVersion=N.Xf;N.firefoxVersion=N.yj;N.silk=N.Ig;N.ieVersion=N.mg;N.operaVersion=N.ue;N.safariVersion=N.tk;N.isAndroidStockBrowser=N.bk;
N.androidStockBrowserVersion=N.hj;N.webApp=N.Fk;N.quirksMode=N.qk;N.pixelRatio=N.nc;N.iPhone=N.Yj;N.iPod=N.Zj;N.iPad=N.lg;N.retina=N.sk;N.desktop=N.Dc;N.mobile=N.re;N.tablet=N.Kg;N.other=N.lk;N.oggVideo=N.zg;N.h264Video=N.hg;N.mp4Video=N.xg;N.webmVideo=N.Ug;N.vp9Video=N.Og;N.hlsVideo=N.kg;N.audioTag=N.Sf;N.webAudio=N.Qg;N.ogg=N.yg;N.mp3=N.vg;N.opus=N.ve;N.wav=N.Pg;N.aac=N.Qf;N.m4a=N.tg;N.mp4=N.wg;N.webm=N.Tg;N.weba=N.Sg;N.vibrate=N.Lg;N.battery=N.Vf;N.canvas=N.canvas;N.canvasText=N.lj;
N.canvasWinding=N.mj;N.localStorage=N.localStorage;N.mediaSource=N.ik;N.encryptedMedia=N.vj;N.applicationCache=N.applicationCache;N.addEventListener=N.addEventListener;N.raf=N.qo;N.webGL=N.Rg;N.webVR=N.Fe;N.geolocation=N.geolocation;N.history=N.history;N.svg=N.xk;N.contextMenu=N.contextMenu;N.isSecure=N.dk;N.isIframe=N.og;N.touch=N.zk;N.touchForce=N.Ak;N.gamepad=N.Ej;N.requestFullscreen=N.requestFullscreen;N.exitFullscreen=N.exitFullscreen;N.fullscreenKeyboard=N.Cj;N.fullscreenElement=N.fullscreenElement;
N.fullscreenEnabled=N.fullscreenEnabled;N.visibilityState=N.visibilityState;N.visibilityChange=N.Mg;N.orientation=N.orientation;N.screenOrientation=N.uk;N.lockOrientation=N.fk;N.unlockOrientation=N.Bk;N.file=N.file;N.fileSystem=N.xj;N.pointerLock=N.pk;N.cssPointerEvents=N.cd;N.cssRgba=N.rj;N.cssAnimation=N.qj;N.css3D=N.pj;N.deviceMotionRotationRate=N.$f;N.deviceMotionAcceleration=N.Zf;N.deviceOrientationMagnetometer=N.bg;N.deviceMotion=N.Yf;N.deviceOrientation=N.ag;N.dpi=N.tj;N.screenWidth=N.Fg;
N.screenHeight=N.Eg;N.ua=N.aa;N.language=N.language;N.gyroscope=N.Rj;N.ready=N.ready;p.generate=p.eg;p.validate=p.Ek;p.register=p.register;p.unregister=p.unregister;p.getUids=p.gg;p.filterType=p.ce;p.get=p.get;p.isTypeOf=p.T;p.exists=p.Va;ca.register=ca.register;ca.getUids=ca.gg;ca.get=ca.get;ca.hasTypeOf=ca.Jn;ca.exists=ca.Va;window.FORGE.VIEWERS=aa;window.FORGE.VERSION="0.9.0";window.FORGE.DEBUG=!1;window.FORGE.WARNING=!1;r.DEFAULT_CONFIG=fa;window.FORGE.Math=G;G.DEGREES=G.Na;G.RADIANS=G.nb;
G.DEG2RAD=G.bi;G.RAD2DEG=G.mi;G.TWOPI=G.si;window.FORGE.MediaType=Ja;Ja.IMAGE=Ja.IMAGE;Ja.VIDEO=Ja.VIDEO;window.FORGE.MediaFormat=Ka;Ka.EQUIRECTANGULAR=Ka.Pc;Ka.CUBE=Ka.wd;Ka.FLAT=Ka.di;Ka.HOTSPOT=Ka.Fl;window.FORGE.BackgroundType=Oa;Oa.UNDEFINED=Oa.Sc;Oa.SHADER=Oa.Gd;Oa.MESH=Oa.Cd;window.FORGE.EffectComposerType=cb;cb.MAIN=cb.gi;cb.RENDER=cb.Sb;cb.PICKING=cb.tf;window.FORGE.PassPosition=eb;eb.UNKNOWN=eb.Kd;eb.BACKGROUND=eb.td;eb.RENDER=eb.Sb;eb.GLOBAL=eb.ef;window.FORGE.ViewType=Na;
Na.UNDEFINED=Na.Sc;Na.RECTILINEAR=Na.ob;Na.GOPRO=Na.gc;window.FORGE.PickingManager.modes=Wa;Wa.POINTER=Wa.Za;Wa.GAZE=Wa.vc;window.FORGE.HotspotMaterial.types=bc;bc.IMAGE=bc.IMAGE;bc.PLUGIN=bc.li;bc.GRAPHICS=bc.Bd;window.FORGE.HotspotMaterial.presets=Zb;Zb.TRANSPARENT=Zb.ri;Zb.DEBUG=Zb.ai;window.FORGE.HotspotGeometryType=cc;cc.PLANE=cc.ki;cc.BOX=cc.Zh;cc.SPHERE=cc.ni;cc.CYLINDER=cc.$h;window.FORGE.HotspotType=Tb;Tb.THREE_DIMENSIONAL=Tb.Ff;L.RADIUS=50;L.DEFAULT_CONFIG=kc;
window.FORGE.ControllerType=Bc;Bc.POINTER=Bc.Za;Bc.KEYBOARD=Bc.kf;oa.DEFAULT_CONFIG=Cc;window.FORGE.SoundType=Ga;Ga.STEREO=Ga.Kl;Ga.SPATIAL=Ga.Jl;Ga.AMBISONIC=Ga.af;window.FORGE.Action.operation=ad;ad.SET=ad.Cf;ad.ADD=ad.Yh;ad.SUBSTRACT=ad.oi;ad.MULTIPLY=ad.hi;ad.DIVIDE=ad.ci;ad.TOGGLE=ad.pi;window.FORGE.Pointer.listenerTypes=V;V.NATIVE=V.Ra;V.HAMMER=V.ka;window.FORGE.Pointer.events=U.events;U.events.TAP=U.events.Ef;U.events.DOUBLE_TAP=U.events.Ad;U.events.PRESS_START=U.events.yf;
U.events.PRESS_END=U.events.xf;U.events.PAN_START=U.events.sf;U.events.PAN_MOVE=U.events.rf;U.events.PAN_END=U.events.qf;U.events.PINCH_START=U.events.wf;U.events.PINCH_MOVE=U.events.vf;U.events.PINCH_END=U.events.uf;U.events.ROTATE_START=U.events.Bf;U.events.ROTATE_MOVE=U.events.Af;U.events.ROTATE_END=U.events.zf;U.events.SWIPE=U.events.Df;U.events.ENTER=U.events.df;U.events.LEAVE=U.events.lf;U.events.OVER=U.events.pf;U.events.OUT=U.events.nf;U.events.MOVE=U.events.mf;U.events.WHEEL=U.events.Gf;
window.FORGE.Pointer.cursors=Ed;Ed.DEFAULT=Ed.DEFAULT;Ed.POINTER=Ed.Za;Ed.GRAB=Ed.Dl;Ed.GRABBING=Ed.El;window.FORGE.Image.renderModes=Qd;Qd.CSS=Qd.CSS;Qd.CANVAS=Qd.Jb;ge.EMPTY_STATE_IMAGE=ie;ge.EMPTY_STATE_LABEL=je;ge.EMPTY_STATE=ke;ge.DEFAULT_STATE_IMAGE=le;ge.DEFAULT_STATE_LABEL=me;ge.DEFAULT_STATE=he;window.FORGE.VideoDash.mediaType=Ee;Ee.VIDEO=Ee.VIDEO;Ee.AUDIO=Ee.AUDIO;window.FORGE.VideoQualityMode=ne;ne.AUTO=ne.Hb;ne.MANUAL=ne.MANUAL;window.FORGE.VideoFormat=Ma;Ma.DASH=Ma.bf;Ma.HTML5=Ma.Gl;
Ma.UNKNOWN=Ma.Kd;A.JSON=A.JSON;A.XML=A.Tb;A.IMAGE=A.IMAGE;A.SOUND=A.pb;window.FORGE.Cache.reserved=Ne;Ne.COMMON=Ne.Oc;Ne.JSON=Ne.JSON;Ne.XML=Ne.Tb;Ne.IMAGE=Ne.IMAGE;Ne.SOUND=Ne.pb;window.FORGE.EasingType=Y;Y.LINEAR=Y.LINEAR;Y.SINE_IN=Y.Hd;Y.SINE_IN_OUT=Y.Id;Y.SINE_OUT=Y.Jd;Y.QUAD_IN=Y.Dd;Y.QUAD_IN_OUT=Y.Ed;Y.QUAD_OUT=Y.Fd;Y.CUBIC_IN=Y.xd;Y.CUBIC_IN_OUT=Y.yd;Y.CUBIC_OUT=Y.zd;Y.BOUNCE_OUT=Y.Nc;Y.BOUNCE_IN=Y.ud;
  root.FORGE = window.FORGE;
}).call(this);

